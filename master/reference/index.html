
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/logo/edsnlp.svg">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.11">
    
    
      
        <title>`edsnlp` - EDS-NLP</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c5ef100.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.9647289d.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/extra.css">
    
      <link rel="stylesheet" href="../assets/termynal/termynal.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#edsnlp" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="EDS-NLP" class="md-header__button md-logo" aria-label="EDS-NLP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EDS-NLP
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              `edsnlp`
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aphp/edsnlp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aphp/edsnlp
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="EDS-NLP" class="md-nav__button md-logo" aria-label="EDS-NLP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    EDS-NLP
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aphp/edsnlp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    aphp/edsnlp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Getting started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://aphp.github.io/edsnlp/demo" target="_blank" class="md-nav__link">
        Demo
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../tutorials/">Tutorials</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/spacy101/" class="md-nav__link">
        spaCy 101
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/matching-a-terminology/" class="md-nav__link">
        Matching a terminology
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/qualifying-entities/" class="md-nav__link">
        Qualifying entities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/detecting-dates/" class="md-nav__link">
        Detecting dates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/multiple-texts/" class="md-nav__link">
        Processing multiple texts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/endlines/" class="md-nav__link">
        Detecting end-of-lines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/reason/" class="md-nav__link">
        Detecting Reason of Hospitalisation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../advanced-tutorials/">Advanced tutorials</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Advanced tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Advanced tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced-tutorials/word-vectors/" class="md-nav__link">
        Word embeddings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced-tutorials/fastapi/" class="md-nav__link">
        Deploying as an API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://spacy.io/usage/processing-pipelines#custom-components" target="_blank" class="md-nav__link">
        Creating a pipeline
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../pipelines/">Pipelines</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Pipelines" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Pipelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/architecture/" class="md-nav__link">
        Basic Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../pipelines/core/">Core Pipelines</a>
          
            <label for="__nav_5_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Core Pipelines" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Core Pipelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/core/matcher/" class="md-nav__link">
        Matcher
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/core/normalisation/" class="md-nav__link">
        Normalisation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/core/endlines/" class="md-nav__link">
        Endlines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/core/sentences/" class="md-nav__link">
        Sentences
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_4" type="checkbox" id="__nav_5_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../pipelines/qualifiers/">Qualifiers</a>
          
            <label for="__nav_5_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Qualifiers" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_4">
          <span class="md-nav__icon md-icon"></span>
          Qualifiers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/qualifiers/negation/" class="md-nav__link">
        Negation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/qualifiers/family/" class="md-nav__link">
        Family
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/qualifiers/hypothesis/" class="md-nav__link">
        Hypothesis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/qualifiers/reported-speech/" class="md-nav__link">
        Reported Speech
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/qualifiers/history/" class="md-nav__link">
        Medical History
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5" type="checkbox" id="__nav_5_5" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../pipelines/misc/">Miscellaneous</a>
          
            <label for="__nav_5_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Miscellaneous" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_5">
          <span class="md-nav__icon md-icon"></span>
          Miscellaneous
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/misc/dates/" class="md-nav__link">
        Dates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/misc/measures/" class="md-nav__link">
        Measures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/misc/consultation-dates/" class="md-nav__link">
        Consultation Dates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/misc/sections/" class="md-nav__link">
        Sections
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/misc/reason/" class="md-nav__link">
        Reason
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_6" type="checkbox" id="__nav_5_6" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../pipelines/ner/">Named Entity Recognition</a>
          
            <label for="__nav_5_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Named Entity Recognition" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_6">
          <span class="md-nav__icon md-icon"></span>
          Named Entity Recognition
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/ner/score/" class="md-nav__link">
        Score
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/ner/covid/" class="md-nav__link">
        COVID
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../languages/" class="md-nav__link">
        Languages
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../utilities/connectors/">Connectors</a>
          
            <label for="__nav_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Connectors" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Connectors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utilities/connectors/brat/" class="md-nav__link">
        BRAT Connector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utilities/connectors/omop/" class="md-nav__link">
        OMOP Connector
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../utilities/tests/">Utilities</a>
          
            <label for="__nav_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Utilities" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Utilities
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utilities/tests/blocs/" class="md-nav__link">
        Testing Code Blocs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utilities/tests/examples/" class="md-nav__link">
        Creating Examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utilities/matchers/" class="md-nav__link">
        Matchers
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" checked>
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_9">
          Code Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1" type="checkbox" id="__nav_9_1" checked>
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index md-nav__link--active">
          <a href="./">edsnlp</a>
          
            <label for="__nav_9_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="edsnlp" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_1">
          <span class="md-nav__icon md-icon"></span>
          edsnlp
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="components/" class="md-nav__link">
        components
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="conjugator/" class="md-nav__link">
        conjugator
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_4" type="checkbox" id="__nav_9_1_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="connectors/">connectors</a>
          
            <label for="__nav_9_1_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="connectors" data-md-level="3">
        <label class="md-nav__title" for="__nav_9_1_4">
          <span class="md-nav__icon md-icon"></span>
          connectors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="connectors/brat/" class="md-nav__link">
        brat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="connectors/labeltool/" class="md-nav__link">
        labeltool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="connectors/omop/" class="md-nav__link">
        omop
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="extensions/" class="md-nav__link">
        extensions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="language/" class="md-nav__link">
        language
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_7" type="checkbox" id="__nav_9_1_7" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="matchers/">matchers</a>
          
            <label for="__nav_9_1_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="matchers" data-md-level="3">
        <label class="md-nav__title" for="__nav_9_1_7">
          <span class="md-nav__icon md-icon"></span>
          matchers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="matchers/regex/" class="md-nav__link">
        regex
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_7_3" type="checkbox" id="__nav_9_1_7_3" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="matchers/utils/">utils</a>
          
            <label for="__nav_9_1_7_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="utils" data-md-level="4">
        <label class="md-nav__title" for="__nav_9_1_7_3">
          <span class="md-nav__icon md-icon"></span>
          utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="matchers/utils/offset/" class="md-nav__link">
        offset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="matchers/utils/text/" class="md-nav__link">
        text
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8" type="checkbox" id="__nav_9_1_8" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/">pipelines</a>
          
            <label for="__nav_9_1_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="pipelines" data-md-level="3">
        <label class="md-nav__title" for="__nav_9_1_8">
          <span class="md-nav__icon md-icon"></span>
          pipelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/base/" class="md-nav__link">
        base
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3" type="checkbox" id="__nav_9_1_8_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/">core</a>
          
            <label for="__nav_9_1_8_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="core" data-md-level="4">
        <label class="md-nav__title" for="__nav_9_1_8_3">
          <span class="md-nav__icon md-icon"></span>
          core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3_2" type="checkbox" id="__nav_9_1_8_3_2" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/advanced/">advanced</a>
          
            <label for="__nav_9_1_8_3_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="advanced" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_3_2">
          <span class="md-nav__icon md-icon"></span>
          advanced
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/advanced/advanced/" class="md-nav__link">
        advanced
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/advanced/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3_3" type="checkbox" id="__nav_9_1_8_3_3" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/context/">context</a>
          
            <label for="__nav_9_1_8_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="context" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_3_3">
          <span class="md-nav__icon md-icon"></span>
          context
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/context/context/" class="md-nav__link">
        context
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/context/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3_4" type="checkbox" id="__nav_9_1_8_3_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/endlines/">endlines</a>
          
            <label for="__nav_9_1_8_3_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="endlines" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_3_4">
          <span class="md-nav__icon md-icon"></span>
          endlines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/endlines/endlines/" class="md-nav__link">
        endlines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/endlines/endlinesmodel/" class="md-nav__link">
        endlinesmodel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/endlines/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/endlines/functional/" class="md-nav__link">
        functional
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3_5" type="checkbox" id="__nav_9_1_8_3_5" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/matcher/">matcher</a>
          
            <label for="__nav_9_1_8_3_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="matcher" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_3_5">
          <span class="md-nav__icon md-icon"></span>
          matcher
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/matcher/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/matcher/matcher/" class="md-nav__link">
        matcher
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3_6" type="checkbox" id="__nav_9_1_8_3_6" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/normalizer/">normalizer</a>
          
            <label for="__nav_9_1_8_3_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="normalizer" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_3_6">
          <span class="md-nav__icon md-icon"></span>
          normalizer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3_6_2" type="checkbox" id="__nav_9_1_8_3_6_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/normalizer/accents/">accents</a>
          
            <label for="__nav_9_1_8_3_6_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="accents" data-md-level="6">
        <label class="md-nav__title" for="__nav_9_1_8_3_6_2">
          <span class="md-nav__icon md-icon"></span>
          accents
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/accents/accents/" class="md-nav__link">
        accents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/accents/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/accents/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3_6_4" type="checkbox" id="__nav_9_1_8_3_6_4" >
      
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/normalizer/lowercase/">lowercase</a>
          
            <label for="__nav_9_1_8_3_6_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="lowercase" data-md-level="6">
        <label class="md-nav__title" for="__nav_9_1_8_3_6_4">
          <span class="md-nav__icon md-icon"></span>
          lowercase
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/lowercase/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/normalizer/" class="md-nav__link">
        normalizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3_6_6" type="checkbox" id="__nav_9_1_8_3_6_6" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/normalizer/pollution/">pollution</a>
          
            <label for="__nav_9_1_8_3_6_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="pollution" data-md-level="6">
        <label class="md-nav__title" for="__nav_9_1_8_3_6_6">
          <span class="md-nav__icon md-icon"></span>
          pollution
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/pollution/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/pollution/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/pollution/pollution/" class="md-nav__link">
        pollution
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3_6_7" type="checkbox" id="__nav_9_1_8_3_6_7" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/normalizer/quotes/">quotes</a>
          
            <label for="__nav_9_1_8_3_6_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="quotes" data-md-level="6">
        <label class="md-nav__title" for="__nav_9_1_8_3_6_7">
          <span class="md-nav__icon md-icon"></span>
          quotes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/quotes/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/quotes/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/normalizer/quotes/quotes/" class="md-nav__link">
        quotes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_3_7" type="checkbox" id="__nav_9_1_8_3_7" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/core/sentences/">sentences</a>
          
            <label for="__nav_9_1_8_3_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="sentences" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_3_7">
          <span class="md-nav__icon md-icon"></span>
          sentences
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/sentences/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/sentences/sentences/" class="md-nav__link">
        sentences
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/core/sentences/terms/" class="md-nav__link">
        terms
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/factories/" class="md-nav__link">
        factories
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_5" type="checkbox" id="__nav_9_1_8_5" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/misc/">misc</a>
          
            <label for="__nav_9_1_8_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="misc" data-md-level="4">
        <label class="md-nav__title" for="__nav_9_1_8_5">
          <span class="md-nav__icon md-icon"></span>
          misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_5_2" type="checkbox" id="__nav_9_1_8_5_2" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/misc/consultation_dates/">consultation_dates</a>
          
            <label for="__nav_9_1_8_5_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="consultation_dates" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_5_2">
          <span class="md-nav__icon md-icon"></span>
          consultation_dates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/consultation_dates/consultation_dates/" class="md-nav__link">
        consultation_dates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/consultation_dates/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/consultation_dates/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_5_3" type="checkbox" id="__nav_9_1_8_5_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/misc/dates/">dates</a>
          
            <label for="__nav_9_1_8_5_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="dates" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_5_3">
          <span class="md-nav__icon md-icon"></span>
          dates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/dates/" class="md-nav__link">
        dates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/models/" class="md-nav__link">
        models
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_5_3_5" type="checkbox" id="__nav_9_1_8_5_3_5" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/misc/dates/patterns/">patterns</a>
          
            <label for="__nav_9_1_8_5_3_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="patterns" data-md-level="6">
        <label class="md-nav__title" for="__nav_9_1_8_5_3_5">
          <span class="md-nav__icon md-icon"></span>
          patterns
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/absolute/" class="md-nav__link">
        absolute
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_5_3_5_3" type="checkbox" id="__nav_9_1_8_5_3_5_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/misc/dates/patterns/atomic/">atomic</a>
          
            <label for="__nav_9_1_8_5_3_5_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="atomic" data-md-level="7">
        <label class="md-nav__title" for="__nav_9_1_8_5_3_5_3">
          <span class="md-nav__icon md-icon"></span>
          atomic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/atomic/days/" class="md-nav__link">
        days
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/atomic/delimiters/" class="md-nav__link">
        delimiters
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/atomic/directions/" class="md-nav__link">
        directions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/atomic/modes/" class="md-nav__link">
        modes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/atomic/months/" class="md-nav__link">
        months
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/atomic/numbers/" class="md-nav__link">
        numbers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/atomic/time/" class="md-nav__link">
        time
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/atomic/units/" class="md-nav__link">
        units
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/atomic/years/" class="md-nav__link">
        years
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/current/" class="md-nav__link">
        current
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/duration/" class="md-nav__link">
        duration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/false_positive/" class="md-nav__link">
        false_positive
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/dates/patterns/relative/" class="md-nav__link">
        relative
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_5_4" type="checkbox" id="__nav_9_1_8_5_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/misc/measures/">measures</a>
          
            <label for="__nav_9_1_8_5_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="measures" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_5_4">
          <span class="md-nav__icon md-icon"></span>
          measures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/measures/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/measures/measures/" class="md-nav__link">
        measures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/measures/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_5_5" type="checkbox" id="__nav_9_1_8_5_5" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/misc/reason/">reason</a>
          
            <label for="__nav_9_1_8_5_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="reason" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_5_5">
          <span class="md-nav__icon md-icon"></span>
          reason
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/reason/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/reason/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/reason/reason/" class="md-nav__link">
        reason
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_5_6" type="checkbox" id="__nav_9_1_8_5_6" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/misc/sections/">sections</a>
          
            <label for="__nav_9_1_8_5_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="sections" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_5_6">
          <span class="md-nav__icon md-icon"></span>
          sections
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/sections/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/sections/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/misc/sections/sections/" class="md-nav__link">
        sections
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_6" type="checkbox" id="__nav_9_1_8_6" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/ner/">ner</a>
          
            <label for="__nav_9_1_8_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="ner" data-md-level="4">
        <label class="md-nav__title" for="__nav_9_1_8_6">
          <span class="md-nav__icon md-icon"></span>
          ner
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_6_2" type="checkbox" id="__nav_9_1_8_6_2" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/ner/covid/">covid</a>
          
            <label for="__nav_9_1_8_6_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="covid" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_6_2">
          <span class="md-nav__icon md-icon"></span>
          covid
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/covid/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/covid/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_6_3" type="checkbox" id="__nav_9_1_8_6_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/ner/scores/">scores</a>
          
            <label for="__nav_9_1_8_6_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="scores" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_6_3">
          <span class="md-nav__icon md-icon"></span>
          scores
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/base_score/" class="md-nav__link">
        base_score
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_6_3_3" type="checkbox" id="__nav_9_1_8_6_3_3" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/ner/scores/charlson/">charlson</a>
          
            <label for="__nav_9_1_8_6_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="charlson" data-md-level="6">
        <label class="md-nav__title" for="__nav_9_1_8_6_3_3">
          <span class="md-nav__icon md-icon"></span>
          charlson
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/charlson/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/charlson/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_6_3_4" type="checkbox" id="__nav_9_1_8_6_3_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/ner/scores/emergency/">emergency</a>
          
            <label for="__nav_9_1_8_6_3_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="emergency" data-md-level="6">
        <label class="md-nav__title" for="__nav_9_1_8_6_3_4">
          <span class="md-nav__icon md-icon"></span>
          emergency
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_6_3_4_2" type="checkbox" id="__nav_9_1_8_6_3_4_2" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/ner/scores/emergency/ccmu/">ccmu</a>
          
            <label for="__nav_9_1_8_6_3_4_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="ccmu" data-md-level="7">
        <label class="md-nav__title" for="__nav_9_1_8_6_3_4_2">
          <span class="md-nav__icon md-icon"></span>
          ccmu
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/emergency/ccmu/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/emergency/ccmu/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_6_3_4_3" type="checkbox" id="__nav_9_1_8_6_3_4_3" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/ner/scores/emergency/gemsa/">gemsa</a>
          
            <label for="__nav_9_1_8_6_3_4_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="gemsa" data-md-level="7">
        <label class="md-nav__title" for="__nav_9_1_8_6_3_4_3">
          <span class="md-nav__icon md-icon"></span>
          gemsa
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/emergency/gemsa/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/emergency/gemsa/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_6_3_4_4" type="checkbox" id="__nav_9_1_8_6_3_4_4" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/ner/scores/emergency/priority/">priority</a>
          
            <label for="__nav_9_1_8_6_3_4_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="priority" data-md-level="7">
        <label class="md-nav__title" for="__nav_9_1_8_6_3_4_4">
          <span class="md-nav__icon md-icon"></span>
          priority
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/emergency/priority/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/emergency/priority/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_6_3_6" type="checkbox" id="__nav_9_1_8_6_3_6" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/ner/scores/sofa/">sofa</a>
          
            <label for="__nav_9_1_8_6_3_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="sofa" data-md-level="6">
        <label class="md-nav__title" for="__nav_9_1_8_6_3_6">
          <span class="md-nav__icon md-icon"></span>
          sofa
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/sofa/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/sofa/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/ner/scores/sofa/sofa/" class="md-nav__link">
        sofa
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_7" type="checkbox" id="__nav_9_1_8_7" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/qualifiers/">qualifiers</a>
          
            <label for="__nav_9_1_8_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="qualifiers" data-md-level="4">
        <label class="md-nav__title" for="__nav_9_1_8_7">
          <span class="md-nav__icon md-icon"></span>
          qualifiers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/base/" class="md-nav__link">
        base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/factories/" class="md-nav__link">
        factories
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_7_4" type="checkbox" id="__nav_9_1_8_7_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/qualifiers/family/">family</a>
          
            <label for="__nav_9_1_8_7_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="family" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_7_4">
          <span class="md-nav__icon md-icon"></span>
          family
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/family/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/family/family/" class="md-nav__link">
        family
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/family/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_7_5" type="checkbox" id="__nav_9_1_8_7_5" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/qualifiers/history/">history</a>
          
            <label for="__nav_9_1_8_7_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="history" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_7_5">
          <span class="md-nav__icon md-icon"></span>
          history
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/history/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/history/history/" class="md-nav__link">
        history
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/history/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_7_6" type="checkbox" id="__nav_9_1_8_7_6" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/qualifiers/hypothesis/">hypothesis</a>
          
            <label for="__nav_9_1_8_7_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="hypothesis" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_7_6">
          <span class="md-nav__icon md-icon"></span>
          hypothesis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/hypothesis/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/hypothesis/hypothesis/" class="md-nav__link">
        hypothesis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/hypothesis/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_7_7" type="checkbox" id="__nav_9_1_8_7_7" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/qualifiers/negation/">negation</a>
          
            <label for="__nav_9_1_8_7_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="negation" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_7_7">
          <span class="md-nav__icon md-icon"></span>
          negation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/negation/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/negation/negation/" class="md-nav__link">
        negation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/negation/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_8_7_8" type="checkbox" id="__nav_9_1_8_7_8" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="pipelines/qualifiers/reported_speech/">reported_speech</a>
          
            <label for="__nav_9_1_8_7_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="reported_speech" data-md-level="5">
        <label class="md-nav__title" for="__nav_9_1_8_7_8">
          <span class="md-nav__icon md-icon"></span>
          reported_speech
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/reported_speech/factory/" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/reported_speech/patterns/" class="md-nav__link">
        patterns
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/qualifiers/reported_speech/reported_speech/" class="md-nav__link">
        reported_speech
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pipelines/terminations/" class="md-nav__link">
        terminations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_9" type="checkbox" id="__nav_9_1_9" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="processing/">processing</a>
          
            <label for="__nav_9_1_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="processing" data-md-level="3">
        <label class="md-nav__title" for="__nav_9_1_9">
          <span class="md-nav__icon md-icon"></span>
          processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="processing/distributed/" class="md-nav__link">
        distributed
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="processing/helpers/" class="md-nav__link">
        helpers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="processing/parallel/" class="md-nav__link">
        parallel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="processing/simple/" class="md-nav__link">
        simple
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="processing/wrapper/" class="md-nav__link">
        wrapper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_1_10" type="checkbox" id="__nav_9_1_10" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="utils/">utils</a>
          
            <label for="__nav_9_1_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="utils" data-md-level="3">
        <label class="md-nav__title" for="__nav_9_1_10">
          <span class="md-nav__icon md-icon"></span>
          utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/blocs/" class="md-nav__link">
        blocs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/colors/" class="md-nav__link">
        colors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/deprecation/" class="md-nav__link">
        deprecation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/examples/" class="md-nav__link">
        examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/filter/" class="md-nav__link">
        filter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/inclusion/" class="md-nav__link">
        inclusion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/regex/" class="md-nav__link">
        regex
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="utils/resources/" class="md-nav__link">
        resources
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        Contributing to EDS-NLP
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#edsnlp.__version__" class="md-nav__link">
    __version__
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edsnlp.BASE_DIR" class="md-nav__link">
    BASE_DIR
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edsnlp.conjugator" class="md-nav__link">
    conjugator
  </a>
  
    <nav class="md-nav" aria-label="conjugator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.conjugator.conjugate_verb" class="md-nav__link">
    conjugate_verb()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.conjugator.conjugate" class="md-nav__link">
    conjugate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.conjugator.get_conjugated_verbs" class="md-nav__link">
    get_conjugated_verbs()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edsnlp.language" class="md-nav__link">
    language
  </a>
  
    <nav class="md-nav" aria-label="language">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.__all__" class="md-nav__link">
    __all__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSDefaults" class="md-nav__link">
    EDSDefaults
  </a>
  
    <nav class="md-nav" aria-label="EDSDefaults">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSDefaults.tokenizer_exceptions" class="md-nav__link">
    tokenizer_exceptions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSDefaults.infixes" class="md-nav__link">
    infixes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSDefaults.lex_attr_getters" class="md-nav__link">
    lex_attr_getters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSDefaults.syntax_iterators" class="md-nav__link">
    syntax_iterators
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSDefaults.stop_words" class="md-nav__link">
    stop_words
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSDefaults.config" class="md-nav__link">
    config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSLanguage" class="md-nav__link">
    EDSLanguage
  </a>
  
    <nav class="md-nav" aria-label="EDSLanguage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSLanguage.lang" class="md-nav__link">
    lang
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSLanguage.Defaults" class="md-nav__link">
    Defaults
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSLanguage.default_config" class="md-nav__link">
    default_config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSTokenizer" class="md-nav__link">
    EDSTokenizer
  </a>
  
    <nav class="md-nav" aria-label="EDSTokenizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSTokenizer.vocab" class="md-nav__link">
    vocab
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSTokenizer.word_regex" class="md-nav__link">
    word_regex
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSTokenizer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.EDSTokenizer.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.language.create_eds_tokenizer" class="md-nav__link">
    create_eds_tokenizer()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edsnlp.extensions" class="md-nav__link">
    extensions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edsnlp.components" class="md-nav__link">
    components
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edsnlp.pipelines" class="md-nav__link">
    pipelines
  </a>
  
    <nav class="md-nav" aria-label="pipelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.base" class="md-nav__link">
    base
  </a>
  
    <nav class="md-nav" aria-label="base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.base.BaseComponent" class="md-nav__link">
    BaseComponent
  </a>
  
    <nav class="md-nav" aria-label="BaseComponent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.base.BaseComponent.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.base.BaseComponent.set_extensions" class="md-nav__link">
    set_extensions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.base.BaseComponent._boundaries" class="md-nav__link">
    _boundaries()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.terminations" class="md-nav__link">
    terminations
  </a>
  
    <nav class="md-nav" aria-label="terminations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.terminations.termination" class="md-nav__link">
    termination
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.factories" class="md-nav__link">
    factories
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.ner" class="md-nav__link">
    ner
  </a>
  
    <nav class="md-nav" aria-label="ner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.ner.scores" class="md-nav__link">
    scores
  </a>
  
    <nav class="md-nav" aria-label="scores">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.ner.scores.base_score" class="md-nav__link">
    base_score
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.ner.scores.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.ner.scores.emergency" class="md-nav__link">
    emergency
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.ner.scores.charlson" class="md-nav__link">
    charlson
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.ner.scores.sofa" class="md-nav__link">
    sofa
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.ner.covid" class="md-nav__link">
    covid
  </a>
  
    <nav class="md-nav" aria-label="covid">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.ner.covid.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.ner.covid.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core" class="md-nav__link">
    core
  </a>
  
    <nav class="md-nav" aria-label="core">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.endlines" class="md-nav__link">
    endlines
  </a>
  
    <nav class="md-nav" aria-label="endlines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.endlines.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.endlines.functional" class="md-nav__link">
    functional
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.endlines.endlinesmodel" class="md-nav__link">
    endlinesmodel
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.endlines.endlines" class="md-nav__link">
    endlines
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.normalizer" class="md-nav__link">
    normalizer
  </a>
  
    <nav class="md-nav" aria-label="normalizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.normalizer.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.normalizer.normalizer" class="md-nav__link">
    normalizer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.normalizer.lowercase" class="md-nav__link">
    lowercase
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.normalizer.pollution" class="md-nav__link">
    pollution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.normalizer.quotes" class="md-nav__link">
    quotes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.normalizer.accents" class="md-nav__link">
    accents
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.matcher" class="md-nav__link">
    matcher
  </a>
  
    <nav class="md-nav" aria-label="matcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.matcher.matcher" class="md-nav__link">
    matcher
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.matcher.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.context" class="md-nav__link">
    context
  </a>
  
    <nav class="md-nav" aria-label="context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.context.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.context.context" class="md-nav__link">
    context
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.sentences" class="md-nav__link">
    sentences
  </a>
  
    <nav class="md-nav" aria-label="sentences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.sentences.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.sentences.sentences" class="md-nav__link">
    sentences
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.sentences.sentences.SentenceSegmenter--arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.sentences.sentences.SentenceSegmenter.__call__--arguments" class="md-nav__link">
    Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.sentences.terms" class="md-nav__link">
    terms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.advanced" class="md-nav__link">
    advanced
  </a>
  
    <nav class="md-nav" aria-label="advanced">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.advanced.advanced" class="md-nav__link">
    advanced
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.core.advanced.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc" class="md-nav__link">
    misc
  </a>
  
    <nav class="md-nav" aria-label="misc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.reason" class="md-nav__link">
    reason
  </a>
  
    <nav class="md-nav" aria-label="reason">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.reason.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.reason.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.reason.reason" class="md-nav__link">
    reason
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.consultation_dates" class="md-nav__link">
    consultation_dates
  </a>
  
    <nav class="md-nav" aria-label="consultation_dates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.consultation_dates.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.consultation_dates.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.consultation_dates.consultation_dates" class="md-nav__link">
    consultation_dates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.sections" class="md-nav__link">
    sections
  </a>
  
    <nav class="md-nav" aria-label="sections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.sections.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.sections.sections" class="md-nav__link">
    sections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.sections.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.dates" class="md-nav__link">
    dates
  </a>
  
    <nav class="md-nav" aria-label="dates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.dates.dates" class="md-nav__link">
    dates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.dates.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.dates.models" class="md-nav__link">
    models
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.dates.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.measures" class="md-nav__link">
    measures
  </a>
  
    <nav class="md-nav" aria-label="measures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.measures.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.measures.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.misc.measures.measures" class="md-nav__link">
    measures
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers" class="md-nav__link">
    qualifiers
  </a>
  
    <nav class="md-nav" aria-label="qualifiers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.base" class="md-nav__link">
    base
  </a>
  
    <nav class="md-nav" aria-label="base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.base.Qualifier" class="md-nav__link">
    Qualifier
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.base.check_normalizer" class="md-nav__link">
    check_normalizer()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.factories" class="md-nav__link">
    factories
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.hypothesis" class="md-nav__link">
    hypothesis
  </a>
  
    <nav class="md-nav" aria-label="hypothesis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.hypothesis.hypothesis" class="md-nav__link">
    hypothesis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.hypothesis.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.hypothesis.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.family" class="md-nav__link">
    family
  </a>
  
    <nav class="md-nav" aria-label="family">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.family.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.family.family" class="md-nav__link">
    family
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.family.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.negation" class="md-nav__link">
    negation
  </a>
  
    <nav class="md-nav" aria-label="negation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.negation.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.negation.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.negation.negation" class="md-nav__link">
    negation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.history" class="md-nav__link">
    history
  </a>
  
    <nav class="md-nav" aria-label="history">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.history.history" class="md-nav__link">
    history
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.history.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.history.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.reported_speech" class="md-nav__link">
    reported_speech
  </a>
  
    <nav class="md-nav" aria-label="reported_speech">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.reported_speech.factory" class="md-nav__link">
    factory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.reported_speech.patterns" class="md-nav__link">
    patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.pipelines.qualifiers.reported_speech.reported_speech" class="md-nav__link">
    reported_speech
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edsnlp.matchers" class="md-nav__link">
    matchers
  </a>
  
    <nav class="md-nav" aria-label="matchers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex" class="md-nav__link">
    regex
  </a>
  
    <nav class="md-nav" aria-label="regex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher" class="md-nav__link">
    RegexMatcher
  </a>
  
    <nav class="md-nav" aria-label="RegexMatcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.alignment_mode" class="md-nav__link">
    alignment_mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.regex" class="md-nav__link">
    regex
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.default_attr" class="md-nav__link">
    default_attr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.ignore_excluded" class="md-nav__link">
    ignore_excluded
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.build_patterns" class="md-nav__link">
    build_patterns()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.add" class="md-nav__link">
    add()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.remove" class="md-nav__link">
    remove()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.match" class="md-nav__link">
    match()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.RegexMatcher.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.get_first_included" class="md-nav__link">
    get_first_included()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.regex.create_span" class="md-nav__link">
    create_span()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils.ListOrStr" class="md-nav__link">
    ListOrStr
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils.DictOrPattern" class="md-nav__link">
    DictOrPattern
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils.Patterns" class="md-nav__link">
    Patterns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils.ATTRIBUTES" class="md-nav__link">
    ATTRIBUTES
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils.offset" class="md-nav__link">
    offset
  </a>
  
    <nav class="md-nav" aria-label="offset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils.offset.token_length" class="md-nav__link">
    token_length()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils.offset.alignment" class="md-nav__link">
    alignment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils.offset.offset" class="md-nav__link">
    offset()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils.text" class="md-nav__link">
    text
  </a>
  
    <nav class="md-nav" aria-label="text">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.matchers.utils.text.get_text" class="md-nav__link">
    get_text()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edsnlp.connectors" class="md-nav__link">
    connectors
  </a>
  
    <nav class="md-nav" aria-label="connectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat" class="md-nav__link">
    brat
  </a>
  
    <nav class="md-nav" aria-label="brat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector" class="md-nav__link">
    BratConnector
  </a>
  
    <nav class="md-nav" aria-label="BratConnector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.directory" class="md-nav__link">
    directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.n_jobs" class="md-nav__link">
    n_jobs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.full_path" class="md-nav__link">
    full_path()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.read_file" class="md-nav__link">
    read_file()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.read_texts" class="md-nav__link">
    read_texts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.read_brat_annotation" class="md-nav__link">
    read_brat_annotation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.read_annotations" class="md-nav__link">
    read_annotations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.get_brat" class="md-nav__link">
    get_brat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.brat2docs" class="md-nav__link">
    brat2docs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.doc2brat" class="md-nav__link">
    doc2brat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.BratConnector.docs2brat" class="md-nav__link">
    docs2brat()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.brat.read_brat_annotation" class="md-nav__link">
    read_brat_annotation()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop" class="md-nav__link">
    omop
  </a>
  
    <nav class="md-nav" aria-label="omop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.OmopConnector" class="md-nav__link">
    OmopConnector
  </a>
  
    <nav class="md-nav" aria-label="OmopConnector">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.OmopConnector.start_char" class="md-nav__link">
    start_char
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.OmopConnector.end_char" class="md-nav__link">
    end_char
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.OmopConnector.nlp" class="md-nav__link">
    nlp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.OmopConnector.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.OmopConnector.preprocess" class="md-nav__link">
    preprocess()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.OmopConnector.postprocess" class="md-nav__link">
    postprocess()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.OmopConnector.omop2docs" class="md-nav__link">
    omop2docs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.OmopConnector.docs2omop" class="md-nav__link">
    docs2omop()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.omop2docs" class="md-nav__link">
    omop2docs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.omop.docs2omop" class="md-nav__link">
    docs2omop()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.labeltool" class="md-nav__link">
    labeltool
  </a>
  
    <nav class="md-nav" aria-label="labeltool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.connectors.labeltool.docs2labeltool" class="md-nav__link">
    docs2labeltool()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edsnlp.processing" class="md-nav__link">
    processing
  </a>
  
    <nav class="md-nav" aria-label="processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.distributed" class="md-nav__link">
    distributed
  </a>
  
    <nav class="md-nav" aria-label="distributed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.distributed.pyspark_type_finder" class="md-nav__link">
    pyspark_type_finder()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.distributed.module_checker" class="md-nav__link">
    module_checker()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.distributed.pipe" class="md-nav__link">
    pipe()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.wrapper" class="md-nav__link">
    wrapper
  </a>
  
    <nav class="md-nav" aria-label="wrapper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.wrapper.pipe" class="md-nav__link">
    pipe()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.parallel" class="md-nav__link">
    parallel
  </a>
  
    <nav class="md-nav" aria-label="parallel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.parallel.nlp" class="md-nav__link">
    nlp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.parallel._define_nlp" class="md-nav__link">
    _define_nlp()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.parallel._chunker" class="md-nav__link">
    _chunker()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.parallel._process_chunk" class="md-nav__link">
    _process_chunk()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.parallel.pipe" class="md-nav__link">
    pipe()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.simple" class="md-nav__link">
    simple
  </a>
  
    <nav class="md-nav" aria-label="simple">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.simple.nlp" class="md-nav__link">
    nlp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.simple.ExtensionSchema" class="md-nav__link">
    ExtensionSchema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.simple._df_to_spacy" class="md-nav__link">
    _df_to_spacy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.simple._flatten" class="md-nav__link">
    _flatten()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.simple._pipe_generator" class="md-nav__link">
    _pipe_generator()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.simple._single_schema" class="md-nav__link">
    _single_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.simple._full_schema" class="md-nav__link">
    _full_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.simple.pipe" class="md-nav__link">
    pipe()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers" class="md-nav__link">
    helpers
  </a>
  
    <nav class="md-nav" aria-label="helpers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers.DataFrames" class="md-nav__link">
    DataFrames
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers.spec" class="md-nav__link">
    spec
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers.DataFrameModules" class="md-nav__link">
    DataFrameModules
  </a>
  
    <nav class="md-nav" aria-label="DataFrameModules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers.DataFrameModules.PANDAS" class="md-nav__link">
    PANDAS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers.DataFrameModules.PYSPARK" class="md-nav__link">
    PYSPARK
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers.DataFrameModules.KOALAS" class="md-nav__link">
    KOALAS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers.get_module" class="md-nav__link">
    get_module()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers.check_spacy_version_for_context" class="md-nav__link">
    check_spacy_version_for_context()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers.rgetattr" class="md-nav__link">
    rgetattr()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.processing.helpers.slugify" class="md-nav__link">
    slugify()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#edsnlp.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples" class="md-nav__link">
    examples
  </a>
  
    <nav class="md-nav" aria-label="examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.entity_pattern" class="md-nav__link">
    entity_pattern
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.text_pattern" class="md-nav__link">
    text_pattern
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.modifiers_pattern" class="md-nav__link">
    modifiers_pattern
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Match" class="md-nav__link">
    Match
  </a>
  
    <nav class="md-nav" aria-label="Match">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Match.start_char" class="md-nav__link">
    start_char
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Match.end_char" class="md-nav__link">
    end_char
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Match.text" class="md-nav__link">
    text
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Match.modifiers" class="md-nav__link">
    modifiers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Modifier" class="md-nav__link">
    Modifier
  </a>
  
    <nav class="md-nav" aria-label="Modifier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Modifier.key" class="md-nav__link">
    key
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Modifier.value" class="md-nav__link">
    value
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Entity" class="md-nav__link">
    Entity
  </a>
  
    <nav class="md-nav" aria-label="Entity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Entity.start_char" class="md-nav__link">
    start_char
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Entity.end_char" class="md-nav__link">
    end_char
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.Entity.modifiers" class="md-nav__link">
    modifiers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.find_matches" class="md-nav__link">
    find_matches()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.parse_match" class="md-nav__link">
    parse_match()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.examples.parse_example" class="md-nav__link">
    parse_example()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs" class="md-nav__link">
    blocs
  </a>
  
    <nav class="md-nav" aria-label="blocs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs.BLOCK_PATTERN" class="md-nav__link">
    BLOCK_PATTERN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs.OUTPUT_PATTERN" class="md-nav__link">
    OUTPUT_PATTERN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs.check_outputs" class="md-nav__link">
    check_outputs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs.remove_indentation" class="md-nav__link">
    remove_indentation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs.grab_code_blocks" class="md-nav__link">
    grab_code_blocks()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs.printer" class="md-nav__link">
    printer()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs.check_docstring" class="md-nav__link">
    check_docstring()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs.check_raw_string" class="md-nav__link">
    check_raw_string()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs.check_raw_file_full" class="md-nav__link">
    check_raw_file_full()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.blocs.check_md_file" class="md-nav__link">
    check_md_file()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.colors" class="md-nav__link">
    colors
  </a>
  
    <nav class="md-nav" aria-label="colors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.colors.CATEGORY20" class="md-nav__link">
    CATEGORY20
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.colors.create_colors" class="md-nav__link">
    create_colors()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.filter" class="md-nav__link">
    filter
  </a>
  
    <nav class="md-nav" aria-label="filter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.filter.default_sort_key" class="md-nav__link">
    default_sort_key()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.filter.start_sort_key" class="md-nav__link">
    start_sort_key()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.filter.filter_spans" class="md-nav__link">
    filter_spans()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.filter.consume_spans" class="md-nav__link">
    consume_spans()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.filter.get_spans" class="md-nav__link">
    get_spans()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.regex" class="md-nav__link">
    regex
  </a>
  
    <nav class="md-nav" aria-label="regex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.regex.make_pattern" class="md-nav__link">
    make_pattern()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.regex.compile_regex" class="md-nav__link">
    compile_regex()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.inclusion" class="md-nav__link">
    inclusion
  </a>
  
    <nav class="md-nav" aria-label="inclusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.inclusion.check_inclusion" class="md-nav__link">
    check_inclusion()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.resources" class="md-nav__link">
    resources
  </a>
  
    <nav class="md-nav" aria-label="resources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.resources.get_verbs" class="md-nav__link">
    get_verbs()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.deprecation" class="md-nav__link">
    deprecation
  </a>
  
    <nav class="md-nav" aria-label="deprecation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.deprecation.deprecated_extension" class="md-nav__link">
    deprecated_extension()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.deprecation.deprecated_getter_factory" class="md-nav__link">
    deprecated_getter_factory()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.deprecation.deprecation" class="md-nav__link">
    deprecation()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edsnlp.utils.deprecation.deprecated_factory" class="md-nav__link">
    deprecated_factory()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/aphp/edit/master/docs/edsnlp/__init__.py" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="edsnlp"><code>edsnlp</code></h1>


  <div class="doc doc-object doc-module">


    <div class="doc doc-contents first">

      <p>EDS-NLP</p>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="edsnlp.__version__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;0.5.1&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="edsnlp.BASE_DIR" class="doc doc-heading">
<code class="highlight language-python"><span class="n">BASE_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

    </div>

  </div>






  <div class="doc doc-object doc-module">



<h3 id="edsnlp.conjugator" class="doc doc-heading">
        <code>conjugator</code>



</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h4 id="edsnlp.conjugator.conjugate_verb" class="doc doc-heading">
<code class="highlight language-python"><span class="n">conjugate_verb</span><span class="p">(</span><span class="n">verb</span><span class="p">,</span> <span class="n">conjugator</span><span class="p">)</span></code>


</h4>


    <div class="doc doc-contents ">

      <p>Conjugates the verb using an instance of mlconjug3,
and formats the results in a pandas <code>DataFrame</code>.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>verb</code></td>
          <td class="doc-param-details">
            <p>Verb to conjugate.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>conjugator</code></td>
          <td class="doc-param-details">
            <p>mlconjug3 instance for conjugating.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>mlconjug3.Conjugator</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Normalized dataframe containing all conjugated forms
for the verb.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/conjugator.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">conjugate_verb</span><span class="p">(</span>
    <span class="n">verb</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">conjugator</span><span class="p">:</span> <span class="n">mlconjug3</span><span class="o">.</span><span class="n">Conjugator</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conjugates the verb using an instance of mlconjug3,</span>
<span class="sd">    and formats the results in a pandas `DataFrame`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    verb : str</span>
<span class="sd">        Verb to conjugate.</span>
<span class="sd">    conjugator : mlconjug3.Conjugator</span>
<span class="sd">        mlconjug3 instance for conjugating.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        Normalized dataframe containing all conjugated forms</span>
<span class="sd">        for the verb.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">conjugator</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">verb</span><span class="p">)</span><span class="o">.</span><span class="n">iterate</span><span class="p">(),</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="s2">&quot;tense&quot;</span><span class="p">,</span> <span class="s2">&quot;person&quot;</span><span class="p">,</span> <span class="s2">&quot;term&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">df</span><span class="o">.</span><span class="n">term</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">person</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">person</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">term</span><span class="p">,</span> <span class="s2">&quot;person&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">df</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;verb&quot;</span><span class="p">,</span> <span class="n">verb</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="edsnlp.conjugator.conjugate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">conjugate</span><span class="p">(</span><span class="n">verbs</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;fr&#39;</span><span class="p">)</span></code>


</h4>


    <div class="doc doc-contents ">

      <p>Conjugate a list of verbs.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>verbs</code></td>
          <td class="doc-param-details">
            <p>List of verbs to conjugate</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[str, List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>language</code></td>
          <td class="doc-param-details">
            <p>Language to conjugate. Defaults to French (<code>fr</code>).</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;fr&#39;</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Dataframe containing the conjugations for the provided verbs.
Columns: <code>verb</code>, <code>mode</code>, <code>tense</code>, <code>person</code>, <code>term</code></p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/conjugator.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">conjugate</span><span class="p">(</span>
    <span class="n">verbs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fr&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conjugate a list of verbs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    verbs : Union[str, List[str]]</span>
<span class="sd">        List of verbs to conjugate</span>
<span class="sd">    language: str</span>
<span class="sd">        Language to conjugate. Defaults to French (`fr`).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        Dataframe containing the conjugations for the provided verbs.</span>
<span class="sd">        Columns: `verb`, `mode`, `tense`, `person`, `term`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">verbs</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">verbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">verbs</span><span class="p">]</span>

    <span class="n">conjugator</span> <span class="o">=</span> <span class="n">mlconjug3</span><span class="o">.</span><span class="n">Conjugator</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">conjugate_verb</span><span class="p">(</span><span class="n">verb</span><span class="p">,</span> <span class="n">conjugator</span><span class="o">=</span><span class="n">conjugator</span><span class="p">)</span> <span class="k">for</span> <span class="n">verb</span> <span class="ow">in</span> <span class="n">verbs</span><span class="p">])</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h4 id="edsnlp.conjugator.get_conjugated_verbs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_conjugated_verbs</span><span class="p">(</span><span class="n">verbs</span><span class="p">,</span> <span class="n">matches</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;fr&#39;</span><span class="p">)</span></code>


</h4>


    <div class="doc doc-contents ">

      <p>Get a list of conjugated verbs.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>verbs</code></td>
          <td class="doc-param-details">
            <p>List of verbs to conjugate.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[str, List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>matches</code></td>
          <td class="doc-param-details">
            <p>List of dictionary describing the mode/tense/persons to keep.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[List[Dict[str, str]], Dict[str, str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>language</code></td>
          <td class="doc-param-details">
            <p>[description], by default "fr" (French)</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;fr&#39;</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List[str]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of terms to look for.</p>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_conjugated_verbs</span><span class="p">(</span>
<span class="go">        &quot;aimer&quot;,</span>
<span class="go">        dict(mode=&quot;Indicatif&quot;, tense=&quot;Présent&quot;, person=&quot;1p&quot;),</span>
<span class="go">    )</span>
<span class="go">[&#39;aimons&#39;]</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>edsnlp/conjugator.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_conjugated_verbs</span><span class="p">(</span>
    <span class="n">verbs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">matches</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">language</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fr&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a list of conjugated verbs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    verbs : Union[str, List[str]]</span>
<span class="sd">        List of verbs to conjugate.</span>
<span class="sd">    matches : Union[List[Dict[str, str]], Dict[str, str]]</span>
<span class="sd">        List of dictionary describing the mode/tense/persons to keep.</span>
<span class="sd">    language : str, optional</span>
<span class="sd">        [description], by default &quot;fr&quot; (French)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List[str]</span>
<span class="sd">        List of terms to look for.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; get_conjugated_verbs(</span>
<span class="sd">            &quot;aimer&quot;,</span>
<span class="sd">            dict(mode=&quot;Indicatif&quot;, tense=&quot;Présent&quot;, person=&quot;1p&quot;),</span>
<span class="sd">        )</span>
<span class="sd">    [&#39;aimons&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">matches</span><span class="p">]</span>

    <span class="n">terms</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">conjugate</span><span class="p">(</span>
        <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span>
        <span class="n">language</span><span class="o">=</span><span class="n">language</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="s2">&quot; &amp; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1"> == &quot;</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">match</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="n">terms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">terms</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="edsnlp.language" class="doc doc-heading">
        <code>language</code>



</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h4 id="edsnlp.language.__all__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;EDSLanguage&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h4 id="edsnlp.language.EDSDefaults" class="doc doc-heading">
          <code>EDSDefaults</code>



</h4>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="spacy.lang.fr.FrenchDefaults">FrenchDefaults</span></code></p>


      <p>Defaults for the EDSLanguage class
Mostly identical to the FrenchDefaults, but
without tokenization info</p>


          <details class="quote">
            <summary>Source code in <code>edsnlp/language.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">EDSDefaults</span><span class="p">(</span><span class="n">FrenchDefaults</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defaults for the EDSLanguage class</span>
<span class="sd">    Mostly identical to the FrenchDefaults, but</span>
<span class="sd">    without tokenization info</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tokenizer_exceptions</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">infixes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lex_attr_getters</span> <span class="o">=</span> <span class="n">LEX_ATTRS</span>
    <span class="n">syntax_iterators</span> <span class="o">=</span> <span class="n">SYNTAX_ITERATORS</span>
    <span class="n">stop_words</span> <span class="o">=</span> <span class="n">STOP_WORDS</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">FrenchDefaults</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;nlp&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;tokenizer&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;@tokenizers&quot;</span><span class="p">:</span> <span class="s2">&quot;eds.tokenizer&quot;</span><span class="p">}},</span>
        <span class="p">}</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSDefaults.tokenizer_exceptions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">tokenizer_exceptions</span> <span class="o">=</span> <span class="p">{}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSDefaults.infixes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">infixes</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSDefaults.lex_attr_getters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lex_attr_getters</span> <span class="o">=</span> <span class="n">LEX_ATTRS</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSDefaults.syntax_iterators" class="doc doc-heading">
<code class="highlight language-python"><span class="n">syntax_iterators</span> <span class="o">=</span> <span class="n">SYNTAX_ITERATORS</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSDefaults.stop_words" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stop_words</span> <span class="o">=</span> <span class="n">STOP_WORDS</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSDefaults.config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">config</span> <span class="o">=</span> <span class="n">FrenchDefaults</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">merge</span><span class="p">({</span><span class="s1">&#39;nlp&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;tokenizer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;@tokenizers&#39;</span><span class="p">:</span> <span class="s1">&#39;eds.tokenizer&#39;</span><span class="p">}}})</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="edsnlp.language.EDSLanguage" class="doc doc-heading">
          <code>EDSLanguage</code>



</h4>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="spacy.lang.fr.French">French</span></code></p>


      <p>French clinical language.
It is shipped with the <code>EDSTokenizer</code> tokenizer that better handles
tokenization for French clinical documents</p>


          <details class="quote">
            <summary>Source code in <code>edsnlp/language.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">languages</span><span class="p">(</span><span class="s2">&quot;eds&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">EDSLanguage</span><span class="p">(</span><span class="n">French</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    French clinical language.</span>
<span class="sd">    It is shipped with the `EDSTokenizer` tokenizer that better handles</span>
<span class="sd">    tokenization for French clinical documents</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lang</span> <span class="o">=</span> <span class="s2">&quot;eds&quot;</span>
    <span class="n">Defaults</span> <span class="o">=</span> <span class="n">EDSDefaults</span>
    <span class="n">default_config</span> <span class="o">=</span> <span class="n">Defaults</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSLanguage.lang" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lang</span> <span class="o">=</span> <span class="s1">&#39;eds&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSLanguage.Defaults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Defaults</span> <span class="o">=</span> <span class="n">EDSDefaults</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSLanguage.default_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">default_config</span> <span class="o">=</span> <span class="n">Defaults</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h4 id="edsnlp.language.EDSTokenizer" class="doc doc-heading">
          <code>EDSTokenizer</code>



</h4>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="spacy.util.DummyTokenizer">DummyTokenizer</span></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/language.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">EDSTokenizer</span><span class="p">(</span><span class="n">DummyTokenizer</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vocab</span><span class="p">:</span> <span class="n">Vocab</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tokenizer class for French clinical documents.</span>
<span class="sd">        It better handles tokenization around:</span>
<span class="sd">        - numbers: &quot;ACR5&quot; -&gt; [&quot;ACR&quot;, &quot;5&quot;] instead of [&quot;ACR5&quot;]</span>
<span class="sd">        - newlines: &quot;\n \n \n&quot; -&gt; [&quot;\n&quot;, &quot;\n&quot;, &quot;\n&quot;] instead of [&quot;\n \n \n&quot;]</span>
<span class="sd">        and should be around 5-6 times faster than its standard French counterpart.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vocab: Vocab</span>
<span class="sd">            The spacy vocabulary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span> <span class="o">=</span> <span class="n">vocab</span>
        <span class="n">punct</span> <span class="o">=</span> <span class="s2">&quot;[:punct:]&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&#39;ˊ＂〃ײ᳓″״‶˶ʺ“”˝&quot;</span>
        <span class="n">num_like</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[\d]+&quot;</span>
        <span class="n">default</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;[^\d</span><span class="si">{</span><span class="n">punct</span><span class="si">}</span><span class="s2">&#39;\n ]+(?:[&#39;ˊ](?=[[:alpha:]]))?&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">word_regex</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
            <span class="sa">rf</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">num_like</span><span class="si">}</span><span class="s2">|[</span><span class="si">{</span><span class="n">punct</span><span class="si">}</span><span class="s2">]|\n|[ ]+|</span><span class="si">{</span><span class="n">default</span><span class="si">}</span><span class="s2">)([ ])?&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tokenizes the text using the EDSTokenizer</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text: str</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Doc</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">last</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">whitespaces</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">word_regex</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
            <span class="n">begin</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">last</span> <span class="o">!=</span> <span class="n">begin</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Missed some characters during&quot;</span>
                    <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; tokenization between </span><span class="si">{</span><span class="n">last</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">begin</span><span class="si">}</span><span class="s2">: &quot;</span>
                    <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">last</span> <span class="o">-</span> <span class="mi">10</span> <span class="p">:</span> <span class="n">last</span><span class="p">]</span>
                    <span class="o">+</span> <span class="s2">&quot;|&quot;</span>
                    <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">last</span><span class="p">:</span><span class="n">begin</span><span class="p">]</span>
                    <span class="o">+</span> <span class="s2">&quot;|&quot;</span>
                    <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">begin</span> <span class="p">:</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">10</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="n">last</span> <span class="o">=</span> <span class="n">end</span>
            <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">whitespaces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">Doc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="n">words</span><span class="o">=</span><span class="n">words</span><span class="p">,</span> <span class="n">spaces</span><span class="o">=</span><span class="n">whitespaces</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSTokenizer.vocab" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vocab</span> <span class="o">=</span> <span class="n">vocab</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.language.EDSTokenizer.word_regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">word_regex</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{num_like}</span><span class="s1">|[</span><span class="si">{punct}</span><span class="s1">]|</span><span class="se">\\</span><span class="s1">n|[ ]+|</span><span class="si">{default}</span><span class="s1">)([ ])?&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h5 id="edsnlp.language.EDSTokenizer.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <div class="highlight"><pre><span></span><code>    Tokenizer class for French clinical documents.
    It better handles tokenization around:
    - numbers: &quot;ACR5&quot; -&gt; [&quot;ACR&quot;, &quot;5&quot;] instead of [&quot;ACR5&quot;]
    - newlines: &quot;
</code></pre></div>
<p>" -&gt; ["
", "
", "
"] instead of ["</p>
<p>"]
        and should be around 5-6 times faster than its standard French counterpart.</p>
<div class="highlight"><pre><span></span><code>    Parameters
    ----------
    vocab: Vocab
        The spacy vocabulary
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>edsnlp/language.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vocab</span><span class="p">:</span> <span class="n">Vocab</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tokenizer class for French clinical documents.</span>
<span class="sd">    It better handles tokenization around:</span>
<span class="sd">    - numbers: &quot;ACR5&quot; -&gt; [&quot;ACR&quot;, &quot;5&quot;] instead of [&quot;ACR5&quot;]</span>
<span class="sd">    - newlines: &quot;\n \n \n&quot; -&gt; [&quot;\n&quot;, &quot;\n&quot;, &quot;\n&quot;] instead of [&quot;\n \n \n&quot;]</span>
<span class="sd">    and should be around 5-6 times faster than its standard French counterpart.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vocab: Vocab</span>
<span class="sd">        The spacy vocabulary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span> <span class="o">=</span> <span class="n">vocab</span>
    <span class="n">punct</span> <span class="o">=</span> <span class="s2">&quot;[:punct:]&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&#39;ˊ＂〃ײ᳓″״‶˶ʺ“”˝&quot;</span>
    <span class="n">num_like</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[\d]+&quot;</span>
    <span class="n">default</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;[^\d</span><span class="si">{</span><span class="n">punct</span><span class="si">}</span><span class="s2">&#39;\n ]+(?:[&#39;ˊ](?=[[:alpha:]]))?&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">word_regex</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="sa">rf</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">num_like</span><span class="si">}</span><span class="s2">|[</span><span class="si">{</span><span class="n">punct</span><span class="si">}</span><span class="s2">]|\n|[ ]+|</span><span class="si">{</span><span class="n">default</span><span class="si">}</span><span class="s2">)([ ])?&quot;</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.language.EDSTokenizer.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Tokenizes the text using the EDSTokenizer</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>text</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/language.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tokenizes the text using the EDSTokenizer</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    text: str</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Doc</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">last</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">whitespaces</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">word_regex</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
        <span class="n">begin</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">last</span> <span class="o">!=</span> <span class="n">begin</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Missed some characters during&quot;</span>
                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; tokenization between </span><span class="si">{</span><span class="n">last</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">begin</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">last</span> <span class="o">-</span> <span class="mi">10</span> <span class="p">:</span> <span class="n">last</span><span class="p">]</span>
                <span class="o">+</span> <span class="s2">&quot;|&quot;</span>
                <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">last</span><span class="p">:</span><span class="n">begin</span><span class="p">]</span>
                <span class="o">+</span> <span class="s2">&quot;|&quot;</span>
                <span class="o">+</span> <span class="n">text</span><span class="p">[</span><span class="n">begin</span> <span class="p">:</span> <span class="n">begin</span> <span class="o">+</span> <span class="mi">10</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="n">last</span> <span class="o">=</span> <span class="n">end</span>
        <span class="n">words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">whitespaces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">bool</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">Doc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="n">words</span><span class="o">=</span><span class="n">words</span><span class="p">,</span> <span class="n">spaces</span><span class="o">=</span><span class="n">whitespaces</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h4 id="edsnlp.language.create_eds_tokenizer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_eds_tokenizer</span><span class="p">()</span></code>


</h4>


    <div class="doc doc-contents ">

      <p>Creates a factory that returns new EDSTokenizer instances</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>EDSTokenizer</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/language.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">tokenizers</span><span class="p">(</span><span class="s2">&quot;eds.tokenizer&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_eds_tokenizer</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a factory that returns new EDSTokenizer instances</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    EDSTokenizer</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">eds_tokenizer_factory</span><span class="p">(</span><span class="n">nlp</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">EDSTokenizer</span><span class="p">(</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">eds_tokenizer_factory</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="edsnlp.extensions" class="doc doc-heading">
        <code>extensions</code>



</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">










  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="edsnlp.components" class="doc doc-heading">
        <code>components</code>



</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">










  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="edsnlp.pipelines" class="doc doc-heading">
        <code>pipelines</code>



</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h4 id="edsnlp.pipelines.base" class="doc doc-heading">
        <code>base</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="edsnlp.pipelines.base.BaseComponent" class="doc doc-heading">
          <code>BaseComponent</code>



</h5>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code>object</code></p>


      <p>The <code>BaseComponent</code> adds a <code>set_extensions</code> method,
called at the creation of the object.</p>
<p>It helps decouple the initialisation of the pipeline from
the creation of extensions, and is particularly usefull when
distributing EDSNLP on a cluster, since the serialisation mechanism
imposes that the extensions be reset.</p>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/base.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">BaseComponent</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `BaseComponent` adds a `set_extensions` method,</span>
<span class="sd">    called at the creation of the object.</span>

<span class="sd">    It helps decouple the initialisation of the pipeline from</span>
<span class="sd">    the creation of extensions, and is particularly usefull when</span>
<span class="sd">    distributing EDSNLP on a cluster, since the serialisation mechanism</span>
<span class="sd">    imposes that the extensions be reset.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set `Doc`, `Span` and `Token` extensions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_boundaries</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">terminations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create sub sentences based sentences and terminations found in text.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object</span>
<span class="sd">        terminations:</span>
<span class="sd">            List of tuples with (match_id, start, end)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        boundaries:</span>
<span class="sd">            List of tuples with (start, end) of spans</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">terminations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">terminations</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">sent_starts</span> <span class="o">=</span> <span class="p">[</span><span class="n">sent</span><span class="o">.</span><span class="n">start</span> <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">]</span>
        <span class="n">termination_starts</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">start</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terminations</span><span class="p">]</span>

        <span class="n">starts</span> <span class="o">=</span> <span class="n">sent_starts</span> <span class="o">+</span> <span class="n">termination_starts</span> <span class="o">+</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)]</span>

        <span class="c1"># Remove duplicates</span>
        <span class="n">starts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">starts</span><span class="p">))</span>

        <span class="c1"># Sort starts</span>
        <span class="n">starts</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">boundaries</span> <span class="o">=</span> <span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">starts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">starts</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

        <span class="k">return</span> <span class="n">boundaries</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h6 id="edsnlp.pipelines.base.BaseComponent.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/base.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.pipelines.base.BaseComponent.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Set <code>Doc</code>, <code>Span</code> and <code>Token</code> extensions.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/base.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set `Doc`, `Span` and `Token` extensions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.pipelines.base.BaseComponent._boundaries" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">terminations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Create sub sentences based sentences and terminations found in text.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>terminations</code></td>
          <td class="doc-param-details">
            <p>List of tuples with (match_id, start, end)</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="spacy.tokens.Span">Span</span>]]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>boundaries</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of tuples with (start, end) of spans</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/base.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_boundaries</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">terminations</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create sub sentences based sentences and terminations found in text.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object</span>
<span class="sd">    terminations:</span>
<span class="sd">        List of tuples with (match_id, start, end)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    boundaries:</span>
<span class="sd">        List of tuples with (start, end) of spans</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">terminations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">terminations</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">sent_starts</span> <span class="o">=</span> <span class="p">[</span><span class="n">sent</span><span class="o">.</span><span class="n">start</span> <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">]</span>
    <span class="n">termination_starts</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">start</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terminations</span><span class="p">]</span>

    <span class="n">starts</span> <span class="o">=</span> <span class="n">sent_starts</span> <span class="o">+</span> <span class="n">termination_starts</span> <span class="o">+</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)]</span>

    <span class="c1"># Remove duplicates</span>
    <span class="n">starts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">starts</span><span class="p">))</span>

    <span class="c1"># Sort starts</span>
    <span class="n">starts</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="n">boundaries</span> <span class="o">=</span> <span class="p">[(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">starts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">starts</span><span class="p">[</span><span class="mi">1</span><span class="p">:])]</span>

    <span class="k">return</span> <span class="n">boundaries</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.pipelines.terminations" class="doc doc-heading">
        <code>terminations</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.pipelines.terminations.termination" class="doc doc-heading">
<code class="highlight language-python"><span class="n">termination</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;et&#39;</span><span class="p">,</span> <span class="s1">&#39;bien que&#39;</span><span class="p">,</span> <span class="s1">&#39;même si&#39;</span><span class="p">,</span> <span class="s1">&#39;mais&#39;</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="s1">&#39;alors que&#39;</span><span class="p">,</span> <span class="s1">&#39;sauf&#39;</span><span class="p">,</span> <span class="s1">&#39;cependant&#39;</span><span class="p">,</span> <span class="s1">&#39;pourtant&#39;</span><span class="p">,</span> <span class="s1">&#39;cause de&#39;</span><span class="p">,</span> <span class="s1">&#39;source de&#39;</span><span class="p">,</span> <span class="s1">&#39;hormis&#39;</span><span class="p">,</span> <span class="s1">&#39;car&#39;</span><span class="p">,</span> <span class="s1">&#39;parce que&#39;</span><span class="p">,</span> <span class="s1">&#39;pourtant&#39;</span><span class="p">,</span> <span class="s1">&#39;puisque&#39;</span><span class="p">,</span> <span class="s1">&#39;ni&#39;</span><span class="p">,</span> <span class="s1">&#39;en raison de&#39;</span><span class="p">,</span> <span class="s1">&#39;qui&#39;</span><span class="p">,</span> <span class="s1">&#39;que&#39;</span><span class="p">,</span> <span class="s1">&#39;ainsi que&#39;</span><span class="p">,</span> <span class="s1">&#39;avec&#39;</span><span class="p">,</span> <span class="s1">&#39;toutefois&#39;</span><span class="p">,</span> <span class="s1">&#39;en dehors&#39;</span><span class="p">,</span> <span class="s1">&#39;dans le cadre&#39;</span><span class="p">,</span> <span class="s1">&#39;du fait&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span> <span class="s1">&#39;…&#39;</span><span class="p">,</span> <span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.pipelines.factories" class="doc doc-heading">
        <code>factories</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">










  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.pipelines.ner" class="doc doc-heading">
        <code>ner</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.ner.scores" class="doc doc-heading">
        <code>scores</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.ner.scores.base_score" class="doc doc-heading">
        <code>base_score</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.ner.scores.base_score.Score" class="doc doc-heading">
          <code>Score</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.core.advanced.AdvancedRegex" href="pipelines/core/advanced/advanced/#edsnlp.pipelines.core.advanced.advanced.AdvancedRegex">AdvancedRegex</a></code></p>


      <p>Matcher component to extract a numeric score</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>The spaCy object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>score_name</code></td>
          <td class="doc-param-details">
            <p>The name of the extracted score</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>regex</code></td>
          <td class="doc-param-details">
            <p>A list of regexes to identify the score</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>Wether to match on the text ('TEXT') or on the normalized text ('NORM')</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>after_extract</code></td>
          <td class="doc-param-details">
            <p>Regex with capturing group to get the score value</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>score_normalization</code></td>
          <td class="doc-param-details">
            <p>Function that takes the "raw" value extracted from the <code>after_extract</code> regex,
and should return
- None if no score could be extracted
- The desired score value else</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Callable[[Union[str,None]], Any]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>window</code></td>
          <td class="doc-param-details">
            <p>Number of token to include after the score's mention to find the
score's value</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/ner/scores/base_score.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Score</span><span class="p">(</span><span class="n">AdvancedRegex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Matcher component to extract a numeric score</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        The spaCy object.</span>
<span class="sd">    score_name : str</span>
<span class="sd">        The name of the extracted score</span>
<span class="sd">    regex : List[str]</span>
<span class="sd">        A list of regexes to identify the score</span>
<span class="sd">    attr : str</span>
<span class="sd">        Wether to match on the text (&#39;TEXT&#39;) or on the normalized text (&#39;NORM&#39;)</span>
<span class="sd">    after_extract : str</span>
<span class="sd">        Regex with capturing group to get the score value</span>
<span class="sd">    score_normalization : Callable[[Union[str,None]], Any]</span>
<span class="sd">        Function that takes the &quot;raw&quot; value extracted from the `after_extract` regex,</span>
<span class="sd">        and should return</span>
<span class="sd">        - None if no score could be extracted</span>
<span class="sd">        - The desired score value else</span>
<span class="sd">    window : int</span>
<span class="sd">        Number of token to include after the score&#39;s mention to find the</span>
<span class="sd">        score&#39;s value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">score_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">regex</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">after_extract</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">score_normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="n">regex_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">score_name</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">after_extract</span><span class="o">=</span><span class="n">after_extract</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
            <span class="n">regex_config</span><span class="o">=</span><span class="n">regex_config</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">score_name</span> <span class="o">=</span> <span class="n">score_name</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">score_normalization</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score_normalization</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;misc&quot;</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score_normalization</span> <span class="o">=</span> <span class="n">score_normalization</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Score</span><span class="p">,</span> <span class="n">Score</span><span class="p">)</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;score_name&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;score_name&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;score_value&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;score_value&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds spans to document.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object, annotated for extracted terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ents</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Score</span><span class="p">,</span> <span class="n">Score</span><span class="p">)</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_filtering</span><span class="p">(</span><span class="n">ents</span><span class="p">)</span>

        <span class="n">ents</span><span class="p">,</span> <span class="n">discarded</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="n">ents</span><span class="p">,</span> <span class="n">return_discarded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span>

        <span class="k">if</span> <span class="s2">&quot;discarded&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">discarded</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span>

    <span class="k">def</span> <span class="nf">score_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extracts, if available, the value of the score.</span>
<span class="sd">        Normalizes the score via the provided `self.score_normalization` method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ents: List[Span]</span>
<span class="sd">            List of spaCy&#39;s spans extracted by the score matcher</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ents: List[Span]</span>
<span class="sd">            List of spaCy&#39;s spans, with, if found, an added `score_value` extension</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">to_keep_ents</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_extract</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">normalized_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_normalization</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">normalized_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">score_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_name</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">score_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="n">to_keep_ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">to_keep_ents</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.base_score.Score.score_name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_name</span> <span class="o">=</span> <span class="n">score_name</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.base_score.Score.score_normalization" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;misc&#39;</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.ner.scores.base_score.Score.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">score_name</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">after_extract</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/base_score.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">score_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">after_extract</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">score_normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">regex_config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">score_name</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">after_extract</span><span class="o">=</span><span class="n">after_extract</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">regex_config</span><span class="o">=</span><span class="n">regex_config</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">score_name</span> <span class="o">=</span> <span class="n">score_name</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">score_normalization</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score_normalization</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;misc&quot;</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score_normalization</span> <span class="o">=</span> <span class="n">score_normalization</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.ner.scores.base_score.Score.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/base_score.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Score</span><span class="p">,</span> <span class="n">Score</span><span class="p">)</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;score_name&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;score_name&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;score_value&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;score_value&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.ner.scores.base_score.Score.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Adds spans to document.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>spaCy Doc object, annotated for extracted terms.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/base_score.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds spans to document.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object, annotated for extracted terms.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ents</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Score</span><span class="p">,</span> <span class="n">Score</span><span class="p">)</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_filtering</span><span class="p">(</span><span class="n">ents</span><span class="p">)</span>

    <span class="n">ents</span><span class="p">,</span> <span class="n">discarded</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="n">ents</span><span class="p">,</span> <span class="n">return_discarded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span>

    <span class="k">if</span> <span class="s2">&quot;discarded&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">discarded</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.ner.scores.base_score.Score.score_filtering" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_filtering</span><span class="p">(</span><span class="n">ents</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Extracts, if available, the value of the score.
Normalizes the score via the provided <code>self.score_normalization</code> method.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ents</code></td>
          <td class="doc-param-details">
            <p>List of spaCy's spans extracted by the score matcher</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.List">List</span>[<span title="spacy.tokens.Span">Span</span>]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>ents</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of spaCy's spans, with, if found, an added <code>score_value</code> extension</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/base_score.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts, if available, the value of the score.</span>
<span class="sd">    Normalizes the score via the provided `self.score_normalization` method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ents: List[Span]</span>
<span class="sd">        List of spaCy&#39;s spans extracted by the score matcher</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ents: List[Span]</span>
<span class="sd">        List of spaCy&#39;s spans, with, if found, an added `score_value` extension</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">to_keep_ents</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_extract</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">normalized_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_normalization</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">normalized_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">score_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_name</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">score_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">to_keep_ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">to_keep_ents</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.ner.scores.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.ner.scores.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.ner.scores.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">score_name</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">after_extract</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.score&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.score&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">score_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">after_extract</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">score_normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Score</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">score_name</span><span class="o">=</span><span class="n">score_name</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
        <span class="n">after_extract</span><span class="o">=</span><span class="n">after_extract</span><span class="p">,</span>
        <span class="n">score_normalization</span><span class="o">=</span><span class="n">score_normalization</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.ner.scores.emergency" class="doc doc-heading">
        <code>emergency</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.ner.scores.emergency.gemsa" class="doc doc-heading">
        <code>gemsa</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.ner.scores.emergency.gemsa.factory" class="doc doc-heading">
        <code>factory</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.gemsa.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">regex</span><span class="p">,</span> <span class="n">after_extract</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">after_extract</span><span class="p">,</span> <span class="n">score_normalization</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">score_normalization_str</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.ner.scores.emergency.gemsa.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">after_extract</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/emergency/gemsa/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span>
    <span class="s2">&quot;emergency.gemsa&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.emergency.gemsa&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span>
<span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.emergency.gemsa&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">after_extract</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">score_normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Score</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">score_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
        <span class="n">after_extract</span><span class="o">=</span><span class="n">after_extract</span><span class="p">,</span>
        <span class="n">score_normalization</span><span class="o">=</span><span class="n">score_normalization</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.ner.scores.emergency.gemsa.patterns" class="doc doc-heading">
        <code>patterns</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.gemsa.patterns.regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">bgemsa</span><span class="se">\\</span><span class="s1">b&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.gemsa.patterns.after_extract" class="doc doc-heading">
<code class="highlight language-python"><span class="n">after_extract</span> <span class="o">=</span> <span class="s1">&#39;gemsa.*?[</span><span class="se">\\</span><span class="s1">n</span><span class="se">\\</span><span class="s1">W]*?(</span><span class="se">\\</span><span class="s1">d+)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.gemsa.patterns.score_normalization_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization_str</span> <span class="o">=</span> <span class="s1">&#39;score_normalization.gemsa&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.ner.scores.emergency.gemsa.patterns.score_normalization" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">

      <p>GEMSA score normalization.
If available, returns the integer value of the GEMSA score.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/emergency/gemsa/patterns.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">misc</span><span class="p">(</span><span class="n">score_normalization_str</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">score_normalization</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    GEMSA score normalization.</span>
<span class="sd">    If available, returns the integer value of the GEMSA score.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">score_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">extracted_score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span> <span class="ow">in</span> <span class="n">score_range</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.ner.scores.emergency.ccmu" class="doc doc-heading">
        <code>ccmu</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.ner.scores.emergency.ccmu.factory" class="doc doc-heading">
        <code>factory</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.ccmu.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">regex</span><span class="p">,</span> <span class="n">after_extract</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">after_extract</span><span class="p">,</span> <span class="n">score_normalization</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">score_normalization_str</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.ner.scores.emergency.ccmu.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">after_extract</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/emergency/ccmu/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span>
    <span class="s2">&quot;emergency.ccmu&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.emergency.ccmu&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span>
<span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.emergency.ccmu&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">after_extract</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">score_normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Score</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">score_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
        <span class="n">after_extract</span><span class="o">=</span><span class="n">after_extract</span><span class="p">,</span>
        <span class="n">score_normalization</span><span class="o">=</span><span class="n">score_normalization</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.ner.scores.emergency.ccmu.patterns" class="doc doc-heading">
        <code>patterns</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.ccmu.patterns.regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">bccmu</span><span class="se">\\</span><span class="s1">b&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.ccmu.patterns.after_extract" class="doc doc-heading">
<code class="highlight language-python"><span class="n">after_extract</span> <span class="o">=</span> <span class="s1">&#39;ccmu.*?[</span><span class="se">\\</span><span class="s1">n</span><span class="se">\\</span><span class="s1">W]*?(</span><span class="se">\\</span><span class="s1">d+)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.ccmu.patterns.score_normalization_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization_str</span> <span class="o">=</span> <span class="s1">&#39;score_normalization.ccmu&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.ner.scores.emergency.ccmu.patterns.score_normalization" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">

      <p>CCMU score normalization.
If available, returns the integer value of the CCMU score.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/emergency/ccmu/patterns.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">misc</span><span class="p">(</span><span class="n">score_normalization_str</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">score_normalization</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CCMU score normalization.</span>
<span class="sd">    If available, returns the integer value of the CCMU score.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">score_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">extracted_score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span> <span class="ow">in</span> <span class="n">score_range</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.ner.scores.emergency.priority" class="doc doc-heading">
        <code>priority</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.ner.scores.emergency.priority.factory" class="doc doc-heading">
        <code>factory</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.priority.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">regex</span><span class="p">,</span> <span class="n">after_extract</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">after_extract</span><span class="p">,</span> <span class="n">score_normalization</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">score_normalization_str</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.ner.scores.emergency.priority.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">after_extract</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/emergency/priority/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span>
    <span class="s2">&quot;emergency.priority&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.emergency.priority&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span>
<span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.emergency.priority&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">after_extract</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">score_normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Score</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">score_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
        <span class="n">after_extract</span><span class="o">=</span><span class="n">after_extract</span><span class="p">,</span>
        <span class="n">score_normalization</span><span class="o">=</span><span class="n">score_normalization</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.ner.scores.emergency.priority.patterns" class="doc doc-heading">
        <code>patterns</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.priority.patterns.regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">bpriorite</span><span class="se">\\</span><span class="s1">b&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.priority.patterns.after_extract" class="doc doc-heading">
<code class="highlight language-python"><span class="n">after_extract</span> <span class="o">=</span> <span class="s1">&#39;priorite.*?[</span><span class="se">\\</span><span class="s1">n</span><span class="se">\\</span><span class="s1">W]*?(</span><span class="se">\\</span><span class="s1">d+)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.emergency.priority.patterns.score_normalization_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization_str</span> <span class="o">=</span> <span class="s1">&#39;score_normalization.priority&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.ner.scores.emergency.priority.patterns.score_normalization" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">

      <p>Priority score normalization.
If available, returns the integer value of the priority score.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/emergency/priority/patterns.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">misc</span><span class="p">(</span><span class="n">score_normalization_str</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">score_normalization</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Priority score normalization.</span>
<span class="sd">    If available, returns the integer value of the priority score.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">score_range</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">extracted_score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span> <span class="ow">in</span> <span class="n">score_range</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.ner.scores.charlson" class="doc doc-heading">
        <code>charlson</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.ner.scores.charlson.factory" class="doc doc-heading">
        <code>factory</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.charlson.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">regex</span><span class="p">,</span> <span class="n">after_extract</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">after_extract</span><span class="p">,</span> <span class="n">score_normalization</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">score_normalization_str</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.ner.scores.charlson.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">after_extract</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/charlson/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;charlson&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.charlson&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.charlson&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">after_extract</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">score_normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Score</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">score_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
        <span class="n">after_extract</span><span class="o">=</span><span class="n">after_extract</span><span class="p">,</span>
        <span class="n">score_normalization</span><span class="o">=</span><span class="n">score_normalization</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.ner.scores.charlson.patterns" class="doc doc-heading">
        <code>patterns</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.charlson.patterns.regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;charlson&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.charlson.patterns.after_extract" class="doc doc-heading">
<code class="highlight language-python"><span class="n">after_extract</span> <span class="o">=</span> <span class="s1">&#39;charlson.*?[</span><span class="se">\\</span><span class="s1">n</span><span class="se">\\</span><span class="s1">W]*?(</span><span class="se">\\</span><span class="s1">d+)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.charlson.patterns.score_normalization_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization_str</span> <span class="o">=</span> <span class="s1">&#39;score_normalization.charlson&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.ner.scores.charlson.patterns.score_normalization" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Charlson score normalization.
If available, returns the integer value of the Charlson score.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/charlson/patterns.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">misc</span><span class="p">(</span><span class="n">score_normalization_str</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">score_normalization</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Charlson score normalization.</span>
<span class="sd">    If available, returns the integer value of the Charlson score.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">score_range</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">extracted_score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span> <span class="ow">in</span> <span class="n">score_range</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.ner.scores.sofa" class="doc doc-heading">
        <code>sofa</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.ner.scores.sofa.factory" class="doc doc-heading">
        <code>factory</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.sofa.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">regex</span><span class="p">,</span> <span class="n">method_regex</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">method_regex</span><span class="p">,</span> <span class="n">value_regex</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">value_regex</span><span class="p">,</span> <span class="n">score_normalization</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">score_normalization_str</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.ner.scores.sofa.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">method_regex</span><span class="p">,</span> <span class="n">value_regex</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/sofa/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;SOFA&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.SOFA&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.SOFA&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">method_regex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">value_regex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">score_normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Sofa</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">score_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
        <span class="n">method_regex</span><span class="o">=</span><span class="n">method_regex</span><span class="p">,</span>
        <span class="n">value_regex</span><span class="o">=</span><span class="n">value_regex</span><span class="p">,</span>
        <span class="n">score_normalization</span><span class="o">=</span><span class="n">score_normalization</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.ner.scores.sofa.patterns" class="doc doc-heading">
        <code>patterns</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.sofa.patterns.regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">bsofa</span><span class="se">\\</span><span class="s1">b&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.sofa.patterns.method_regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">method_regex</span> <span class="o">=</span> <span class="s1">&#39;sofa.*?((?P&lt;max&gt;max</span><span class="se">\\</span><span class="s1">w*)|(?P&lt;vqheures&gt;24h</span><span class="se">\\</span><span class="s1">w*)|(?P&lt;admission&gt;admission</span><span class="se">\\</span><span class="s1">w*))(?P&lt;after_value&gt;(.|</span><span class="se">\\</span><span class="s1">n)*)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.sofa.patterns.value_regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">value_regex</span> <span class="o">=</span> <span class="s1">&#39;.*?.[</span><span class="se">\\</span><span class="s1">n</span><span class="se">\\</span><span class="s1">W]*?(</span><span class="se">\\</span><span class="s1">d+)[^h</span><span class="se">\\</span><span class="s1">d]&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.ner.scores.sofa.patterns.score_normalization_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization_str</span> <span class="o">=</span> <span class="s1">&#39;score_normalization.sofa&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.ner.scores.sofa.patterns.score_normalization" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_normalization</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Sofa score normalization.
If available, returns the integer value of the SOFA score.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/sofa/patterns.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">misc</span><span class="p">(</span><span class="n">score_normalization_str</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">score_normalization</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sofa score normalization.</span>
<span class="sd">    If available, returns the integer value of the SOFA score.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">score_range</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">extracted_score</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span> <span class="ow">in</span> <span class="n">score_range</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">extracted_score</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.ner.scores.sofa.sofa" class="doc doc-heading">
        <code>sofa</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h8 id="edsnlp.pipelines.ner.scores.sofa.sofa.Sofa" class="doc doc-heading">
          <code>Sofa</code>



</h8>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.ner.scores.Score" href="pipelines/ner/scores/base_score/#edsnlp.pipelines.ner.scores.base_score.Score">Score</a></code></p>


      <p>Matcher component to extract the SOFA score</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>The spaCy object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>score_name</code></td>
          <td class="doc-param-details">
            <p>The name of the extracted score</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>regex</code></td>
          <td class="doc-param-details">
            <p>A list of regexes to identify the SOFA score</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>Wether to match on the text ('TEXT') or on the normalized text ('CUSTOM_NORM')</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>method_regex</code></td>
          <td class="doc-param-details">
            <p>Regex with capturing group to get the score extraction method
(e.g. "à l'admission", "à 24H", "Maximum")</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>value_regex</code></td>
          <td class="doc-param-details">
            <p>Regex to extract the score value</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>score_normalization</code></td>
          <td class="doc-param-details">
            <p>Function that takes the "raw" value extracted from the <code>after_extract</code> regex,
and should return
- None if no score could be extracted
- The desired score value else</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Callable[[Union[str,None]], Any]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>window</code></td>
          <td class="doc-param-details">
            <p>Number of token to include after the score's mention to find the
score's value</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/ner/scores/sofa/sofa.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Sofa</span><span class="p">(</span><span class="n">Score</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Matcher component to extract the SOFA score</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        The spaCy object.</span>
<span class="sd">    score_name : str</span>
<span class="sd">        The name of the extracted score</span>
<span class="sd">    regex : List[str]</span>
<span class="sd">        A list of regexes to identify the SOFA score</span>
<span class="sd">    attr : str</span>
<span class="sd">        Wether to match on the text (&#39;TEXT&#39;) or on the normalized text (&#39;CUSTOM_NORM&#39;)</span>
<span class="sd">    method_regex : str</span>
<span class="sd">        Regex with capturing group to get the score extraction method</span>
<span class="sd">        (e.g. &quot;à l&#39;admission&quot;, &quot;à 24H&quot;, &quot;Maximum&quot;)</span>
<span class="sd">    value_regex : str</span>
<span class="sd">        Regex to extract the score value</span>
<span class="sd">    score_normalization : Callable[[Union[str,None]], Any]</span>
<span class="sd">        Function that takes the &quot;raw&quot; value extracted from the `after_extract` regex,</span>
<span class="sd">        and should return</span>
<span class="sd">        - None if no score could be extracted</span>
<span class="sd">        - The desired score value else</span>
<span class="sd">    window : int</span>
<span class="sd">        Number of token to include after the score&#39;s mention to find the</span>
<span class="sd">        score&#39;s value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">score_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">regex</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">method_regex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">value_regex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">score_normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="p">,</span>
            <span class="n">score_name</span><span class="o">=</span><span class="n">score_name</span><span class="p">,</span>
            <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
            <span class="n">after_extract</span><span class="o">=</span><span class="p">[],</span>
            <span class="n">score_normalization</span><span class="o">=</span><span class="n">score_normalization</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">method_regex</span> <span class="o">=</span> <span class="n">method_regex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value_regex</span> <span class="o">=</span> <span class="n">value_regex</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Sofa</span><span class="p">,</span> <span class="n">Sofa</span><span class="p">)</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;score_method&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;score_method&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">score_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extracts, if available, the value of the score.</span>
<span class="sd">        Normalizes the score via the provided `self.score_normalization` method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ents: List[Span]</span>
<span class="sd">            List of spaCy&#39;s spans extracted by the score matcher</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ents: List[Span]</span>
<span class="sd">            List of spaCy&#39;s spans, with, if found, an added `score_value` extension</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">to_keep_ents</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
            <span class="n">after_snippet</span> <span class="o">=</span> <span class="n">get_text</span><span class="p">(</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_snippet</span><span class="p">,</span>
                <span class="n">attr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attr</span><span class="p">,</span>
                <span class="n">ignore_excluded</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_excluded</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method_regex</span><span class="p">,</span> <span class="n">after_snippet</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">matches</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;Non précisée&quot;</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">after_snippet</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">groups</span> <span class="o">=</span> <span class="n">matches</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="s2">&quot;after_value&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">groups</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;Maximum&quot;</span>
                <span class="k">elif</span> <span class="n">groups</span><span class="p">[</span><span class="s2">&quot;vqheures&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;24H&quot;</span>
                <span class="k">elif</span> <span class="n">groups</span><span class="p">[</span><span class="s2">&quot;admission&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;A l&#39;admission&quot;</span>

            <span class="n">digit_value</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value_regex</span><span class="p">,</span> <span class="n">value</span>
            <span class="p">)</span>  <span class="c1"># Use match instead of search to only look at the beginning</span>
            <span class="n">digit_value</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">digit_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">digit_value</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">normalized_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_normalization</span><span class="p">(</span><span class="n">digit_value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">normalized_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">score_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_name</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">score_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">normalized_value</span><span class="p">)</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">score_method</span> <span class="o">=</span> <span class="n">method</span>
                <span class="n">to_keep_ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">to_keep_ents</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.sofa.sofa.Sofa.method_regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">method_regex</span> <span class="o">=</span> <span class="n">method_regex</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.ner.scores.sofa.sofa.Sofa.value_regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">value_regex</span> <span class="o">=</span> <span class="n">value_regex</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.ner.scores.sofa.sofa.Sofa.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">score_name</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">method_regex</span><span class="p">,</span> <span class="n">value_regex</span><span class="p">,</span> <span class="n">score_normalization</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/sofa/sofa.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">score_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">method_regex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">value_regex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">score_normalization</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">score_name</span><span class="o">=</span><span class="n">score_name</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
        <span class="n">after_extract</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">score_normalization</span><span class="o">=</span><span class="n">score_normalization</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">method_regex</span> <span class="o">=</span> <span class="n">method_regex</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">value_regex</span> <span class="o">=</span> <span class="n">value_regex</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.ner.scores.sofa.sofa.Sofa.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h9>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/sofa/sofa.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Sofa</span><span class="p">,</span> <span class="n">Sofa</span><span class="p">)</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;score_method&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;score_method&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.ner.scores.sofa.sofa.Sofa.score_filtering" class="doc doc-heading">
<code class="highlight language-python"><span class="n">score_filtering</span><span class="p">(</span><span class="n">ents</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">

      <p>Extracts, if available, the value of the score.
Normalizes the score via the provided <code>self.score_normalization</code> method.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ents</code></td>
          <td class="doc-param-details">
            <p>List of spaCy's spans extracted by the score matcher</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.List">List</span>[<span title="spacy.tokens.Span">Span</span>]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>ents</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of spaCy's spans, with, if found, an added <code>score_value</code> extension</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/scores/sofa/sofa.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">score_filtering</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts, if available, the value of the score.</span>
<span class="sd">    Normalizes the score via the provided `self.score_normalization` method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ents: List[Span]</span>
<span class="sd">        List of spaCy&#39;s spans extracted by the score matcher</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ents: List[Span]</span>
<span class="sd">        List of spaCy&#39;s spans, with, if found, an added `score_value` extension</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">to_keep_ents</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
        <span class="n">after_snippet</span> <span class="o">=</span> <span class="n">get_text</span><span class="p">(</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_snippet</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method_regex</span><span class="p">,</span> <span class="n">after_snippet</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">matches</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;Non précisée&quot;</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">after_snippet</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="n">matches</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="s2">&quot;after_value&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">groups</span><span class="p">[</span><span class="s2">&quot;max&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;Maximum&quot;</span>
            <span class="k">elif</span> <span class="n">groups</span><span class="p">[</span><span class="s2">&quot;vqheures&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;24H&quot;</span>
            <span class="k">elif</span> <span class="n">groups</span><span class="p">[</span><span class="s2">&quot;admission&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;A l&#39;admission&quot;</span>

        <span class="n">digit_value</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value_regex</span><span class="p">,</span> <span class="n">value</span>
        <span class="p">)</span>  <span class="c1"># Use match instead of search to only look at the beginning</span>
        <span class="n">digit_value</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">digit_value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">digit_value</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">normalized_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_normalization</span><span class="p">(</span><span class="n">digit_value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">normalized_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">score_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_name</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">score_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">normalized_value</span><span class="p">)</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">score_method</span> <span class="o">=</span> <span class="n">method</span>
            <span class="n">to_keep_ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">to_keep_ents</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.ner.covid" class="doc doc-heading">
        <code>covid</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.ner.covid.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.ner.covid.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="s1">&#39;LOWER&#39;</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.ner.covid.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/ner/covid/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.covid&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="k">return</span> <span class="n">GenericMatcher</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">terms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">covid</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">pattern</span><span class="p">),</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.ner.covid.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.ner.covid.patterns.covid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">covid</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;covid([-</span><span class="se">\\</span><span class="s1">s]?19)?&#39;</span><span class="p">,</span> <span class="s1">&#39;sars[-</span><span class="se">\\</span><span class="s1">s]?cov[-</span><span class="se">\\</span><span class="s1">s]?2&#39;</span><span class="p">,</span> <span class="s1">&#39;corona[-</span><span class="se">\\</span><span class="s1">s]?virus&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.ner.covid.patterns.diseases" class="doc doc-heading">
<code class="highlight language-python"><span class="n">diseases</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pneumopathies?&#39;</span><span class="p">,</span> <span class="s1">&#39;infections?&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.ner.covid.patterns.pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pattern</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">diseases</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">s[àa]u?</span><span class="se">\\</span><span class="s1">s)?&#39;</span> <span class="o">+</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">covid</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.pipelines.core" class="doc doc-heading">
        <code>core</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.core.endlines" class="doc doc-heading">
        <code>endlines</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.endlines.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.endlines.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">model_path</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;endlines&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.endlines&quot;</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.endlines&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">model_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">EndLines</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">end_lines_model</span><span class="o">=</span><span class="n">model_path</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.endlines.functional" class="doc doc-heading">
        <code>functional</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.endlines.functional._get_label" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_get_label</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">

      <p>Returns the label for the prediction <code>PREDICTED_END_LINE</code></p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>prediction</code></td>
          <td class="doc-param-details">
            <p>value of <code>PREDICTED_END_LINE</code></p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>str</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Label for <code>PREDICTED_END_LINE</code></p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/functional.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_get_label</span><span class="p">(</span><span class="n">prediction</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the label for the prediction `PREDICTED_END_LINE`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    prediction : bool</span>
<span class="sd">        value of `PREDICTED_END_LINE`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Label for `PREDICTED_END_LINE`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">prediction</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;end_line&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;space&quot;</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.endlines.functional.get_dir_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_dir_path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/functional.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_dir_path</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="n">path_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">path_file</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.endlines.functional.build_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">build_path</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">relative_path</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">

      <p>Function to build an absolut path.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file</code></td>
          <td class="doc-param-details">
            
            <p>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>relative_path</code></td>
          <td class="doc-param-details">
            <p>relative path from the main file to the desired output</p>
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>path</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/functional.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">build_path</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">relative_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to build an absolut path.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file: main file from where we are calling. It could be __file__</span>
<span class="sd">    relative_path: str,</span>
<span class="sd">        relative path from the main file to the desired output</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    path: absolute path</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dir_path</span> <span class="o">=</span> <span class="n">get_dir_path</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">relative_path</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">path</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.endlines.functional._convert_series_to_array" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_convert_series_to_array</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">

      <p>Converts pandas series of n elements to an array of shape (n,1).</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>s</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>np.ndarray</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/functional.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_convert_series_to_array</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Converts pandas series of n elements to an array of shape (n,1).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    s : pd.Series</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>  <span class="c1"># .astype(np.int64)</span>
    <span class="k">return</span> <span class="n">X</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.endlines.endlinesmodel" class="doc doc-heading">
        <code>endlinesmodel</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel" class="doc doc-heading">
          <code>EndLinesModel</code>



</h7>


    <div class="doc doc-contents ">


      <p>Model to classify if an end line is a real one or it should be a space.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy nlp pipeline to use for matching.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">EndLinesModel</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Model to classify if an end line is a real one or it should be a space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy nlp pipeline to use for matching.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>

    <span class="k">def</span> <span class="nf">_preprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corpus</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Doc</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        corpus : Iterable[Doc]</span>
<span class="sd">            Corpus of documents</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">            Preprocessed data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extract the vocabulary</span>
        <span class="n">string_store</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span>

        <span class="c1"># Iterate in the corpus and construct a dataframe</span>
        <span class="n">train_data_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
            <span class="n">train_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_attributes</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">train_data_list</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ORTH&quot;</span><span class="p">:</span> <span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;original_token_index&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Retrieve string representation of token_id and shape</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;TEXT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">A1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">,</span> <span class="n">string_store</span><span class="o">=</span><span class="n">string_store</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;SHAPE_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">SHAPE</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">,</span> <span class="n">string_store</span><span class="o">=</span><span class="n">string_store</span><span class="p">)</span>

        <span class="c1"># Convert new lines as an attribute instead of a row</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_line_to_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;END_LINE&quot;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_line_to_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;BLANK_LINE&quot;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span> <span class="o">|</span> <span class="n">df</span><span class="o">.</span><span class="n">BLANK_LINE</span><span class="p">)]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;END_LINE&quot;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;BLANK_LINE&quot;</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;TEMP_END_LINE&quot;</span><span class="p">:</span> <span class="s2">&quot;END_LINE&quot;</span><span class="p">,</span> <span class="s2">&quot;TEMP_BLANK_LINE&quot;</span><span class="p">:</span> <span class="s2">&quot;BLANK_LINE&quot;</span><span class="p">},</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Construct A2 by shifting</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_col</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>

        <span class="c1"># Compute A3 and A4</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_a3</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_col</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>

        <span class="c1"># SPACE is the class to predict. Set 1 if not an END_LINE</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;SPACE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;END_LINE&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>

        <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;END_LINE&quot;</span><span class="p">,</span> <span class="s2">&quot;BLANK_LINE&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;END_LINE&quot;</span><span class="p">,</span> <span class="s2">&quot;BLANK_LINE&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="c1"># Assign a sentence id to each token</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_retrieve_lines</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>

        <span class="c1"># Compute B1 and B2</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_B</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="c1"># Drop Tokens without info (last token of doc)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Export the vocabularies to be able to use the model with another corpus</span>
        <span class="n">voc_a3a4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_vocabulary</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">A3_</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
        <span class="n">voc_B2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_vocabulary</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">cv_bin</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
        <span class="n">voc_B1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_vocabulary</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">l_norm_bin</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>

        <span class="n">vocabulary</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A3A4&quot;</span><span class="p">:</span> <span class="n">voc_a3a4</span><span class="p">,</span> <span class="s2">&quot;B1&quot;</span><span class="p">:</span> <span class="n">voc_B1</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">:</span> <span class="n">voc_B2</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span> <span class="o">=</span> <span class="n">vocabulary</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">fit_and_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corpus</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Doc</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fit the model and predict for the training data</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        corpus : Iterable[Doc]</span>
<span class="sd">            An iterable of Documents</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">            one line by end_line prediction</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Preprocess data to have a pd DF</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess_data</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>

        <span class="c1"># Train and predict M1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_M1</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">A2</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">A3</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">A4</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">SPACE</span><span class="p">)</span>
        <span class="n">outputs_M1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_M1</span><span class="p">(</span>
            <span class="n">df</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span>
            <span class="n">df</span><span class="o">.</span><span class="n">A2</span><span class="p">,</span>
            <span class="n">df</span><span class="o">.</span><span class="n">A3</span><span class="p">,</span>
            <span class="n">df</span><span class="o">.</span><span class="n">A4</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M1</span><span class="p">[</span><span class="s2">&quot;predictions&quot;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M1</span><span class="p">[</span><span class="s2">&quot;predictions_proba&quot;</span><span class="p">]</span>

        <span class="c1"># Force Blank lines to 0</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">BLANK_LINE</span><span class="p">,</span> <span class="s2">&quot;M1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Train and predict M2</span>
        <span class="n">df_endlines</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_M2</span><span class="p">(</span><span class="n">B1</span><span class="o">=</span><span class="n">df_endlines</span><span class="o">.</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="o">=</span><span class="n">df_endlines</span><span class="o">.</span><span class="n">B2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">df_endlines</span><span class="o">.</span><span class="n">M1</span><span class="p">)</span>
        <span class="n">outputs_M2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_M2</span><span class="p">(</span><span class="n">B1</span><span class="o">=</span><span class="n">df_endlines</span><span class="o">.</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="o">=</span><span class="n">df_endlines</span><span class="o">.</span><span class="n">B2</span><span class="p">)</span>

        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">,</span> <span class="s2">&quot;M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M2</span><span class="p">[</span><span class="s2">&quot;predictions&quot;</span><span class="p">]</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">,</span> <span class="s2">&quot;M2_proba&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M2</span><span class="p">[</span><span class="s2">&quot;predictions_proba&quot;</span><span class="p">]</span>

        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">Int64Dtype</span><span class="p">()</span>
        <span class="p">)</span>  <span class="c1"># cast to pd.Int64Dtype cause there are None values</span>

        <span class="c1"># M1M2</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2_lr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2_proba&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2_proba&quot;</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2_lr&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>

        <span class="c1"># Force Blank lines to 0</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">BLANK_LINE</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">,</span> <span class="s2">&quot;M1M2&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Make binary col</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PREDICTED_END_LINE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Use the model for inference</span>

<span class="sd">        The df should have the following columns:</span>
<span class="sd">        `[&quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,&quot;A4&quot;,&quot;B1&quot;,&quot;B2&quot;,&quot;BLANK_LINE&quot;]`</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame</span>
<span class="sd">            The df should have the following columns:</span>
<span class="sd">            `[&quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,&quot;A4&quot;,&quot;B1&quot;,&quot;B2&quot;,&quot;BLANK_LINE&quot;]`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">            The result is added to the column `PREDICTED_END_LINE`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_raw_data_to_codes</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="n">outputs_M1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_M1</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">A2</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">_A3</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">_A4</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M1</span><span class="p">[</span><span class="s2">&quot;predictions&quot;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M1</span><span class="p">[</span><span class="s2">&quot;predictions_proba&quot;</span><span class="p">]</span>

        <span class="n">outputs_M2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_M2</span><span class="p">(</span><span class="n">B1</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">_B1</span><span class="p">,</span> <span class="n">B2</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">_B2</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M2</span><span class="p">[</span><span class="s2">&quot;predictions&quot;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2_proba&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M2</span><span class="p">[</span><span class="s2">&quot;predictions_proba&quot;</span><span class="p">]</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">Int64Dtype</span><span class="p">()</span>
        <span class="p">)</span>  <span class="c1"># cast to pd.Int64Dtype cause there are None values</span>

        <span class="c1"># M1M2</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2_lr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2_proba&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2_proba&quot;</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2_lr&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>

        <span class="c1"># Force Blank lines to 0</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">df</span><span class="o">.</span><span class="n">BLANK_LINE</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="s2">&quot;M1M2&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Make binary col</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PREDICTED_END_LINE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;base_model.pkl&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save a pickle of the model. It could be read by the pipeline later.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str, optional</span>
<span class="sd">            path to file .pkl, by default `base_model.pkl`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outp</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outp</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_convert_A</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame</span>
<span class="sd">        col : str</span>
<span class="sd">            column to translate</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cat_type_A</span> <span class="o">=</span> <span class="n">CategoricalDtype</span><span class="p">(</span>
            <span class="n">categories</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="s2">&quot;A3A4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">new_col</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">col</span>
        <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">cat_type_A</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>
        <span class="c1"># Ensure that not known values are coded as OTHER</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="s2">&quot;A3A4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">new_col</span>
        <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="s2">&quot;A3A4&quot;</span><span class="p">][</span><span class="s2">&quot;OTHER&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">_convert_B</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame</span>
<span class="sd">            [description]</span>
<span class="sd">        col : str</span>
<span class="sd">            column to translate</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">            [description]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Translate B1</span>
        <span class="n">index_B</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IntervalIndex</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">new_col</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">col</span>
        <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">index_B</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">index_B</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">index_B</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">_convert_raw_data_to_codes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to translate data as extracted from spacy to the model codes.</span>
<span class="sd">        `A1` and `A2` are not translated cause are supposed to be already</span>
<span class="sd">        in good encoding.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame</span>
<span class="sd">            It should have columns `[&#39;A3&#39;,&#39;A4&#39;,&#39;B1&#39;,&#39;B2&#39;]`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_A</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_A</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_B</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;B1&quot;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_B</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">_convert_line_to_attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to convert a line into an attribute (column) of the</span>
<span class="sd">        previous row. Particularly we use it to identify &quot;\\n&quot; and &quot;\\n\\n&quot;</span>
<span class="sd">        that are considered tokens, express this information as an attribute</span>
<span class="sd">        of the previous token.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame</span>
<span class="sd">        expr : str</span>
<span class="sd">            pattern to search in the text. Ex.: &quot;\\n&quot;</span>
<span class="sd">        col : str</span>
<span class="sd">            name of the new column</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_col</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;TEMP_&quot;</span> <span class="o">+</span> <span class="n">col</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">_compute_a3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A3 (A4 respectively): typographic form  of left word (or right) :</span>

<span class="sd">        - All in capital letter</span>
<span class="sd">        - It starts with a capital letter</span>
<span class="sd">        - Starts by lowercase</span>
<span class="sd">        - It&#39;s a number</span>
<span class="sd">        - Strong punctuation</span>
<span class="sd">        - Soft punctuation</span>
<span class="sd">        - A number followed or preced by a punctuation (it&#39;s the case of enumerations)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df: pd.DataFrame</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df: pd.DataFrame with the columns `A3` and `A3_`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_col</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span> <span class="s2">&quot;IS_PUNCT&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_PUNCT_+1&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_col</span><span class="p">(</span>
            <span class="n">df</span><span class="p">,</span> <span class="s2">&quot;IS_PUNCT&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_PUNCT_-1&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="n">CONDITION1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">IS_UPPER</span>
        <span class="n">CONDITION2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">SHAPE_</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Xx&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">CONDITION3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">SHAPE_</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">CONDITION4</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">IS_DIGIT</span>
        <span class="n">STRONG_PUNCT</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;...&quot;</span><span class="p">]</span>
        <span class="n">CONDITION5</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">IS_PUNCT</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">STRONG_PUNCT</span><span class="p">))</span>
        <span class="n">CONDITION6</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">IS_PUNCT</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">STRONG_PUNCT</span><span class="p">))</span>
        <span class="n">CONDITION7</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">IS_DIGIT</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;IS_PUNCT_+1&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;IS_PUNCT_-1&quot;</span><span class="p">])</span>  <span class="c1"># discuss</span>

        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION1</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;UPPER&quot;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION2</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;S_UPPER&quot;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION3</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LOWER&quot;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION4</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DIGIT&quot;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION5</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;STRONG_PUNCT&quot;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION6</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;SOFT_PUNCT&quot;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION7</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ENUMERATION&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;IS_PUNCT_+1&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_PUNCT_-1&quot;</span><span class="p">])</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>

        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s2">&quot;OTHER&quot;</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;OTHER&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">_fit_M1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">A1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">A2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">A3</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">A4</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function to train M1 classifier (Naive Bayes)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        A1 : pd.Series</span>
<span class="sd">            [description]</span>
<span class="sd">        A2 : pd.Series</span>
<span class="sd">            [description]</span>
<span class="sd">        A3 : pd.Series</span>
<span class="sd">            [description]</span>
<span class="sd">        A4 : pd.Series</span>
<span class="sd">            [description]</span>
<span class="sd">        label : pd.Series</span>
<span class="sd">            [description]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Encode classes to OneHotEncoder representation</span>
        <span class="n">encoder_A1_A2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_encoder_2S</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder_A1_A2</span> <span class="o">=</span> <span class="n">encoder_A1_A2</span>

        <span class="n">encoder_A3_A4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_encoder_2S</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder_A3_A4</span> <span class="o">=</span> <span class="n">encoder_A3_A4</span>

        <span class="c1"># M1</span>
        <span class="n">m1</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_X_for_M1</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">)</span>
        <span class="n">m1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m1</span> <span class="o">=</span> <span class="n">m1</span>

    <span class="k">def</span> <span class="nf">_fit_M2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">B2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function to train M2 classifier (Naive Bayes)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        B1 : pd.Series</span>
<span class="sd">        B2 : pd.Series</span>
<span class="sd">        label : pd.Series</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Encode classes to OneHotEncoder representation</span>
        <span class="n">encoder_B1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_encoder_1S</span><span class="p">(</span><span class="n">B1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder_B1</span> <span class="o">=</span> <span class="n">encoder_B1</span>
        <span class="n">encoder_B2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_encoder_1S</span><span class="p">(</span><span class="n">B2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder_B2</span> <span class="o">=</span> <span class="n">encoder_B2</span>

        <span class="c1"># Multinomial Naive Bayes</span>
        <span class="n">m2</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_X_for_M2</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span>
        <span class="n">m2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m2</span> <span class="o">=</span> <span class="n">m2</span>

    <span class="k">def</span> <span class="nf">_get_X_for_M1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">A1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A3</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A4</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get X matrix for classifier</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        A1 : pd.Series</span>
<span class="sd">        A2 : pd.Series</span>
<span class="sd">        A3 : pd.Series</span>
<span class="sd">        A4 : pd.Series</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">A1_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_A1_A2</span><span class="p">,</span> <span class="n">A1</span><span class="p">)</span>
        <span class="n">A2_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_A1_A2</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span>
        <span class="n">A3_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_A3_A4</span><span class="p">,</span> <span class="n">A3</span><span class="p">)</span>
        <span class="n">A4_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_A3_A4</span><span class="p">,</span> <span class="n">A4</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">([</span><span class="n">A1_enc</span><span class="p">,</span> <span class="n">A2_enc</span><span class="p">,</span> <span class="n">A3_enc</span><span class="p">,</span> <span class="n">A4_enc</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">X</span>

    <span class="k">def</span> <span class="nf">_get_X_for_M2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">B2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get X matrix for classifier</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        B1 : pd.Series</span>
<span class="sd">        B2 : pd.Series</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">B1_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_B1</span><span class="p">,</span> <span class="n">B1</span><span class="p">)</span>
        <span class="n">B2_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_B2</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">([</span><span class="n">B1_enc</span><span class="p">,</span> <span class="n">B2_enc</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">X</span>

    <span class="k">def</span> <span class="nf">_predict_M1</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">A1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A3</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A4</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Use M1 for prediction</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        A1 : pd.Series</span>
<span class="sd">        A2 : pd.Series</span>
<span class="sd">        A3 : pd.Series</span>
<span class="sd">        A4 : pd.Series</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict[str, Any]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_X_for_M1</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">predictions_proba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span> <span class="s2">&quot;predictions_proba&quot;</span><span class="p">:</span> <span class="n">predictions_proba</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">outputs</span>

    <span class="k">def</span> <span class="nf">_predict_M2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">B2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Use M2 for prediction</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        B1 : pd.Series</span>
<span class="sd">        B2 : pd.Series</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict[str, Any]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_X_for_M2</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">predictions_proba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span> <span class="s2">&quot;predictions_proba&quot;</span><span class="p">:</span> <span class="n">predictions_proba</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">outputs</span>

    <span class="k">def</span> <span class="nf">_fit_encoder_2S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">S2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OneHotEncoder</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fit a one hot encoder with 2 Series. It concatenates the series and after it fits.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        S1 : pd.Series</span>
<span class="sd">        S2 : pd.Series</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        OneHotEncoder</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_S1</span> <span class="o">=</span> <span class="n">_convert_series_to_array</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
        <span class="n">_S2</span> <span class="o">=</span> <span class="n">_convert_series_to_array</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">_S1</span><span class="p">,</span> <span class="n">_S2</span><span class="p">])</span>
        <span class="n">encoder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_one_hot_encoder</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">encoder</span>

    <span class="k">def</span> <span class="nf">_fit_encoder_1S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OneHotEncoder</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fit a one hot encoder with 1 Series.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        S1 : pd.Series</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        OneHotEncoder</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_S1</span> <span class="o">=</span> <span class="n">_convert_series_to_array</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
        <span class="n">encoder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_one_hot_encoder</span><span class="p">(</span><span class="n">_S1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">encoder</span>

    <span class="k">def</span> <span class="nf">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">S</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Use the one hot encoder to transform a series.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        encoder : OneHotEncoder</span>
<span class="sd">        S : pd.Series</span>
<span class="sd">            a series to encode (transform)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_S</span> <span class="o">=</span> <span class="n">_convert_series_to_array</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
        <span class="n">S_enc</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">_S</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">S_enc</span>

    <span class="k">def</span> <span class="nf">set_spans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corpus</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Doc</span><span class="p">],</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to set the results of the algorithm (pd.DataFrame)</span>
<span class="sd">        as spans of the spaCy document.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        corpus : Iterable[Doc]</span>
<span class="sd">            Iterable of spaCy Documents</span>
<span class="sd">        df : pd.DataFrame</span>
<span class="sd">            It should have the columns:</span>
<span class="sd">            [&quot;DOC_ID&quot;,&quot;original_token_index&quot;,&quot;PREDICTED_END_LINE&quot;]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">doc_id</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
            <span class="n">spans</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">token_i</span><span class="p">,</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="n">df</span><span class="o">.</span><span class="n">DOC_ID</span> <span class="o">==</span> <span class="n">doc_id</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;original_token_index&quot;</span><span class="p">,</span> <span class="s2">&quot;PREDICTED_END_LINE&quot;</span><span class="p">]</span>
            <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">token_i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">token_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">_get_label</span><span class="p">(</span><span class="n">pred</span><span class="p">))</span>

                <span class="n">spans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

            <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;new_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spans</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_retrieve_lines</span><span class="p">(</span><span class="n">dfg</span><span class="p">:</span> <span class="n">DataFrameGroupBy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrameGroupBy</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Function to give a sentence_id to each token.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dfg : DataFrameGroupBy</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        DataFrameGroupBy</span>
<span class="sd">            Same DataFrameGroupBy with the column `SENTENCE_ID`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sentences_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dfg</span><span class="o">.</span><span class="n">END_LINE</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
        <span class="n">dfg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfg</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">,</span> <span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sentences_ids</span>
        <span class="n">dfg</span><span class="p">[</span><span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfg</span><span class="p">[</span><span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;bfill&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dfg</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_create_vocabulary</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Function to create a vocabulary for attributes in the training set.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : iterable</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">v</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_compute_B</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Function to compute B1 and B2</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;LENGTH&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">))</span>
        <span class="n">df_t</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">],</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
        <span class="p">)</span>

        <span class="n">stats_doc</span> <span class="o">=</span> <span class="n">df_t</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">))</span>
        <span class="n">stats_doc</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
            <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>  <span class="c1"># Replace the 0 std by unit std, otherwise it breaks the code.</span>
        <span class="n">stats_doc</span><span class="p">[</span><span class="s2">&quot;cv&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats_doc</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">stats_doc</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span>

        <span class="n">df_t</span> <span class="o">=</span> <span class="n">df_t</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">])</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_t</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

        <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stats_doc</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;l_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span>

        <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;cv_bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;cv&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;B2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;cv_bin&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>

        <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;l_norm_bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;l_norm&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;B1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;l_norm_bin&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>

        <span class="k">return</span> <span class="n">df2</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_shift_col</span><span class="p">(</span>
        <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Shifts a column one position into backward / forward direction.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        df : pd.DataFrame</span>
<span class="sd">        col : str</span>
<span class="sd">            column to shift</span>
<span class="sd">        new_col : str</span>
<span class="sd">            column name to save the results</span>
<span class="sd">        direction : str, optional</span>
<span class="sd">            one of {&quot;backward&quot;, &quot;forward&quot;}, by default &quot;backward&quot;</span>
<span class="sd">        fill : [type], optional</span>
<span class="sd">            , by default None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">            same df with `new_col` added.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">fill</span>

        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;backward&quot;</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

            <span class="n">different_doc_id</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">different_doc_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">different_doc_id</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">different_doc_id</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">different_doc_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">different_doc_id</span><span class="p">)</span>

        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">different_doc_id</span><span class="p">,</span> <span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">fill</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_attributes</span><span class="p">(</span><span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function to get the attributes of tokens of a spacy doc in a pd.DataFrame format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc : Doc</span>
<span class="sd">            spacy Doc</span>
<span class="sd">        i : int, optional</span>
<span class="sd">            document id, by default 0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">            Returns a dataframe with one line per token. It has the following columns :</span>
<span class="sd">            `[</span>
<span class="sd">            &quot;ORTH&quot;,</span>
<span class="sd">            &quot;LOWER&quot;,</span>
<span class="sd">            &quot;SHAPE&quot;,</span>
<span class="sd">            &quot;IS_DIGIT&quot;,</span>
<span class="sd">            &quot;IS_SPACE&quot;,</span>
<span class="sd">            &quot;IS_UPPER&quot;,</span>
<span class="sd">            &quot;IS_PUNCT&quot;,</span>
<span class="sd">            &quot;LENGTH&quot;,</span>
<span class="sd">            ]`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;ORTH&quot;</span><span class="p">,</span>
            <span class="s2">&quot;LOWER&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SHAPE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;IS_DIGIT&quot;</span><span class="p">,</span>
            <span class="s2">&quot;IS_SPACE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;IS_UPPER&quot;</span><span class="p">,</span>
            <span class="s2">&quot;IS_PUNCT&quot;</span><span class="p">,</span>
            <span class="s2">&quot;LENGTH&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">attributes_array</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="n">attributes</span><span class="p">)</span>
        <span class="n">attributes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">attributes_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">attributes</span><span class="p">)</span>
        <span class="n">attributes_df</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">boolean_attr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;IS_&quot;</span><span class="p">:</span>
                <span class="n">boolean_attr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">attributes_df</span><span class="p">[</span><span class="n">boolean_attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">attributes_df</span><span class="p">[</span><span class="n">boolean_attr</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;boolean&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attributes_df</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_string</span><span class="p">(</span><span class="n">_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">string_store</span><span class="p">:</span> <span class="n">StringStore</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns the string corresponding to the token_id</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        _id : int</span>
<span class="sd">            token id</span>
<span class="sd">        string_store : StringStore</span>
<span class="sd">            spaCy Language String Store</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            string representation of the token.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">string_store</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_fit_one_hot_encoder</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OneHotEncoder</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Fit a one hot encoder.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : np.ndarray</span>
<span class="sd">            of shape (n,1)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        OneHotEncoder</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">encoder</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel.nlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._preprocess_data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_preprocess_data</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>corpus</code></td>
          <td class="doc-param-details">
            <p>Corpus of documents</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Iterable[Doc]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Preprocessed data</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_preprocess_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corpus</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Doc</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    corpus : Iterable[Doc]</span>
<span class="sd">        Corpus of documents</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        Preprocessed data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Extract the vocabulary</span>
    <span class="n">string_store</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span>

    <span class="c1"># Iterate in the corpus and construct a dataframe</span>
    <span class="n">train_data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
        <span class="n">train_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_attributes</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">train_data_list</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;ORTH&quot;</span><span class="p">:</span> <span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;original_token_index&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Retrieve string representation of token_id and shape</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;TEXT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">A1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">,</span> <span class="n">string_store</span><span class="o">=</span><span class="n">string_store</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;SHAPE_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">SHAPE</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_string</span><span class="p">,</span> <span class="n">string_store</span><span class="o">=</span><span class="n">string_store</span><span class="p">)</span>

    <span class="c1"># Convert new lines as an attribute instead of a row</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_line_to_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;END_LINE&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_line_to_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">expr</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;BLANK_LINE&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span> <span class="o">|</span> <span class="n">df</span><span class="o">.</span><span class="n">BLANK_LINE</span><span class="p">)]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;END_LINE&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;BLANK_LINE&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;TEMP_END_LINE&quot;</span><span class="p">:</span> <span class="s2">&quot;END_LINE&quot;</span><span class="p">,</span> <span class="s2">&quot;TEMP_BLANK_LINE&quot;</span><span class="p">:</span> <span class="s2">&quot;BLANK_LINE&quot;</span><span class="p">},</span>
        <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Construct A2 by shifting</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_col</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>

    <span class="c1"># Compute A3 and A4</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_a3</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_col</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>

    <span class="c1"># SPACE is the class to predict. Set 1 if not an END_LINE</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;SPACE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;END_LINE&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>

    <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;END_LINE&quot;</span><span class="p">,</span> <span class="s2">&quot;BLANK_LINE&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;END_LINE&quot;</span><span class="p">,</span> <span class="s2">&quot;BLANK_LINE&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="c1"># Assign a sentence id to each token</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_retrieve_lines</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>

    <span class="c1"># Compute B1 and B2</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_B</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="c1"># Drop Tokens without info (last token of doc)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Export the vocabularies to be able to use the model with another corpus</span>
    <span class="n">voc_a3a4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_vocabulary</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">A3_</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
    <span class="n">voc_B2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_vocabulary</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">cv_bin</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>
    <span class="n">voc_B1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_vocabulary</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">l_norm_bin</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">)</span>

    <span class="n">vocabulary</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A3A4&quot;</span><span class="p">:</span> <span class="n">voc_a3a4</span><span class="p">,</span> <span class="s2">&quot;B1&quot;</span><span class="p">:</span> <span class="n">voc_B1</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">:</span> <span class="n">voc_B2</span><span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span> <span class="o">=</span> <span class="n">vocabulary</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel.fit_and_predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fit_and_predict</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Fit the model and predict for the training data</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>corpus</code></td>
          <td class="doc-param-details">
            <p>An iterable of Documents</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Iterable[Doc]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>one line by end_line prediction</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">fit_and_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corpus</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Doc</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Fit the model and predict for the training data</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    corpus : Iterable[Doc]</span>
<span class="sd">        An iterable of Documents</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        one line by end_line prediction</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Preprocess data to have a pd DF</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess_data</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>

    <span class="c1"># Train and predict M1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fit_M1</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">A2</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">A3</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">A4</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">SPACE</span><span class="p">)</span>
    <span class="n">outputs_M1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_M1</span><span class="p">(</span>
        <span class="n">df</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span>
        <span class="n">df</span><span class="o">.</span><span class="n">A2</span><span class="p">,</span>
        <span class="n">df</span><span class="o">.</span><span class="n">A3</span><span class="p">,</span>
        <span class="n">df</span><span class="o">.</span><span class="n">A4</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M1</span><span class="p">[</span><span class="s2">&quot;predictions&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M1</span><span class="p">[</span><span class="s2">&quot;predictions_proba&quot;</span><span class="p">]</span>

    <span class="c1"># Force Blank lines to 0</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">BLANK_LINE</span><span class="p">,</span> <span class="s2">&quot;M1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Train and predict M2</span>
    <span class="n">df_endlines</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fit_M2</span><span class="p">(</span><span class="n">B1</span><span class="o">=</span><span class="n">df_endlines</span><span class="o">.</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="o">=</span><span class="n">df_endlines</span><span class="o">.</span><span class="n">B2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">df_endlines</span><span class="o">.</span><span class="n">M1</span><span class="p">)</span>
    <span class="n">outputs_M2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_M2</span><span class="p">(</span><span class="n">B1</span><span class="o">=</span><span class="n">df_endlines</span><span class="o">.</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="o">=</span><span class="n">df_endlines</span><span class="o">.</span><span class="n">B2</span><span class="p">)</span>

    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">,</span> <span class="s2">&quot;M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M2</span><span class="p">[</span><span class="s2">&quot;predictions&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">,</span> <span class="s2">&quot;M2_proba&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M2</span><span class="p">[</span><span class="s2">&quot;predictions_proba&quot;</span><span class="p">]</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Int64Dtype</span><span class="p">()</span>
    <span class="p">)</span>  <span class="c1"># cast to pd.Int64Dtype cause there are None values</span>

    <span class="c1"># M1M2</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2_lr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2_proba&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2_proba&quot;</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2_lr&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>

    <span class="c1"># Force Blank lines to 0</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">BLANK_LINE</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">,</span> <span class="s2">&quot;M1M2&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Make binary col</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PREDICTED_END_LINE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel.predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Use the model for inference</p>
<p>The df should have the following columns:
<code>["A1","A2","A3","A4","B1","B2","BLANK_LINE"]</code></p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td class="doc-param-details">
            <p>The df should have the following columns:
<code>["A1","A2","A3","A4","B1","B2","BLANK_LINE"]</code></p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The result is added to the column <code>PREDICTED_END_LINE</code></p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Use the model for inference</span>

<span class="sd">    The df should have the following columns:</span>
<span class="sd">    `[&quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,&quot;A4&quot;,&quot;B1&quot;,&quot;B2&quot;,&quot;BLANK_LINE&quot;]`</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        The df should have the following columns:</span>
<span class="sd">        `[&quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,&quot;A4&quot;,&quot;B1&quot;,&quot;B2&quot;,&quot;BLANK_LINE&quot;]`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        The result is added to the column `PREDICTED_END_LINE`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_raw_data_to_codes</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

    <span class="n">outputs_M1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_M1</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">A2</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">_A3</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">_A4</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M1</span><span class="p">[</span><span class="s2">&quot;predictions&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M1</span><span class="p">[</span><span class="s2">&quot;predictions_proba&quot;</span><span class="p">]</span>

    <span class="n">outputs_M2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_M2</span><span class="p">(</span><span class="n">B1</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">_B1</span><span class="p">,</span> <span class="n">B2</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">_B2</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M2</span><span class="p">[</span><span class="s2">&quot;predictions&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2_proba&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outputs_M2</span><span class="p">[</span><span class="s2">&quot;predictions_proba&quot;</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Int64Dtype</span><span class="p">()</span>
    <span class="p">)</span>  <span class="c1"># cast to pd.Int64Dtype cause there are None values</span>

    <span class="c1"># M1M2</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2_lr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2_proba&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M2_proba&quot;</span><span class="p">]))</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1_proba&quot;</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2_lr&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>

    <span class="c1"># Force Blank lines to 0</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="n">df</span><span class="o">.</span><span class="n">BLANK_LINE</span><span class="p">,</span>
        <span class="p">[</span>
            <span class="s2">&quot;M1M2&quot;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Make binary col</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;PREDICTED_END_LINE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;M1M2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel.save" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;base_model.pkl&#39;</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Save a pickle of the model. It could be read by the pipeline later.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td class="doc-param-details">
            <p>path to file .pkl, by default <code>base_model.pkl</code></p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;base_model.pkl&#39;</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;base_model.pkl&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Save a pickle of the model. It could be read by the pipeline later.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str, optional</span>
<span class="sd">        path to file .pkl, by default `base_model.pkl`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outp</span><span class="p">:</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outp</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._convert_A" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_convert_A</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>col</code></td>
          <td class="doc-param-details">
            <p>column to translate</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_convert_A</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">    col : str</span>
<span class="sd">        column to translate</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cat_type_A</span> <span class="o">=</span> <span class="n">CategoricalDtype</span><span class="p">(</span>
        <span class="n">categories</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="s2">&quot;A3A4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">new_col</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">col</span>
    <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">cat_type_A</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>
    <span class="c1"># Ensure that not known values are coded as OTHER</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="s2">&quot;A3A4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="n">new_col</span>
    <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="s2">&quot;A3A4&quot;</span><span class="p">][</span><span class="s2">&quot;OTHER&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._convert_B" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_convert_B</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td class="doc-param-details">
            <p>[description]</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>col</code></td>
          <td class="doc-param-details">
            <p>column to translate</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>[description]</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_convert_B</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        [description]</span>
<span class="sd">    col : str</span>
<span class="sd">        column to translate</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        [description]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Translate B1</span>
    <span class="n">index_B</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IntervalIndex</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">new_col</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">col</span>
    <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">index_B</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">index_B</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">index_B</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._convert_raw_data_to_codes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_convert_raw_data_to_codes</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Function to translate data as extracted from spacy to the model codes.
<code>A1</code> and <code>A2</code> are not translated cause are supposed to be already
in good encoding.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td class="doc-param-details">
            <p>It should have columns <code>['A3','A4','B1','B2']</code></p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_convert_raw_data_to_codes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to translate data as extracted from spacy to the model codes.</span>
<span class="sd">    `A1` and `A2` are not translated cause are supposed to be already</span>
<span class="sd">    in good encoding.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        It should have columns `[&#39;A3&#39;,&#39;A4&#39;,&#39;B1&#39;,&#39;B2&#39;]`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_A</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;A3&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_A</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;A4&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_B</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;B1&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_B</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._convert_line_to_attribute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_convert_line_to_attribute</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">expr</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Function to convert a line into an attribute (column) of the
previous row. Particularly we use it to identify "\n" and "\n\n"
that are considered tokens, express this information as an attribute
of the previous token.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>expr</code></td>
          <td class="doc-param-details">
            <p>pattern to search in the text. Ex.: "\n"</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>col</code></td>
          <td class="doc-param-details">
            <p>name of the new column</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_convert_line_to_attribute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to convert a line into an attribute (column) of the</span>
<span class="sd">    previous row. Particularly we use it to identify &quot;\\n&quot; and &quot;\\n\\n&quot;</span>
<span class="sd">    that are considered tokens, express this information as an attribute</span>
<span class="sd">    of the previous token.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">    expr : str</span>
<span class="sd">        pattern to search in the text. Ex.: &quot;\\n&quot;</span>
<span class="sd">    col : str</span>
<span class="sd">        name of the new column</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_col</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&quot;TEMP_&quot;</span> <span class="o">+</span> <span class="n">col</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._compute_a3" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_compute_a3</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>A3 (A4 respectively): typographic form  of left word (or right) :</p>
<ul>
<li>All in capital letter</li>
<li>It starts with a capital letter</li>
<li>Starts by lowercase</li>
<li>It's a number</li>
<li>Strong punctuation</li>
<li>Soft punctuation</li>
<li>A number followed or preced by a punctuation (it's the case of enumerations)</li>
</ul>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>df</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_compute_a3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A3 (A4 respectively): typographic form  of left word (or right) :</span>

<span class="sd">    - All in capital letter</span>
<span class="sd">    - It starts with a capital letter</span>
<span class="sd">    - Starts by lowercase</span>
<span class="sd">    - It&#39;s a number</span>
<span class="sd">    - Strong punctuation</span>
<span class="sd">    - Soft punctuation</span>
<span class="sd">    - A number followed or preced by a punctuation (it&#39;s the case of enumerations)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df: pd.DataFrame</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df: pd.DataFrame with the columns `A3` and `A3_`</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_col</span><span class="p">(</span>
        <span class="n">df</span><span class="p">,</span> <span class="s2">&quot;IS_PUNCT&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_PUNCT_+1&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_col</span><span class="p">(</span>
        <span class="n">df</span><span class="p">,</span> <span class="s2">&quot;IS_PUNCT&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_PUNCT_-1&quot;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;forward&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="n">CONDITION1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">IS_UPPER</span>
    <span class="n">CONDITION2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">SHAPE_</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Xx&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">CONDITION3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">SHAPE_</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">CONDITION4</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">IS_DIGIT</span>
    <span class="n">STRONG_PUNCT</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;...&quot;</span><span class="p">]</span>
    <span class="n">CONDITION5</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">IS_PUNCT</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">STRONG_PUNCT</span><span class="p">))</span>
    <span class="n">CONDITION6</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">IS_PUNCT</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">TEXT</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">STRONG_PUNCT</span><span class="p">))</span>
    <span class="n">CONDITION7</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">IS_DIGIT</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;IS_PUNCT_+1&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;IS_PUNCT_-1&quot;</span><span class="p">])</span>  <span class="c1"># discuss</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION1</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;UPPER&quot;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION2</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;S_UPPER&quot;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION3</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LOWER&quot;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION4</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DIGIT&quot;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION5</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;STRONG_PUNCT&quot;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION6</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;SOFT_PUNCT&quot;</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">CONDITION7</span><span class="p">,</span> <span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ENUMERATION&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;IS_PUNCT_+1&quot;</span><span class="p">,</span> <span class="s2">&quot;IS_PUNCT_-1&quot;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;category&quot;</span><span class="p">)</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">add_categories</span><span class="p">(</span><span class="s2">&quot;OTHER&quot;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;OTHER&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A3_&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._fit_M1" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_fit_M1</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Function to train M1 classifier (Naive Bayes)</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>A1</code></td>
          <td class="doc-param-details">
            <p>[description]</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>A2</code></td>
          <td class="doc-param-details">
            <p>[description]</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>A3</code></td>
          <td class="doc-param-details">
            <p>[description]</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>A4</code></td>
          <td class="doc-param-details">
            <p>[description]</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>label</code></td>
          <td class="doc-param-details">
            <p>[description]</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_fit_M1</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">A1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">A2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">A3</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">A4</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to train M1 classifier (Naive Bayes)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    A1 : pd.Series</span>
<span class="sd">        [description]</span>
<span class="sd">    A2 : pd.Series</span>
<span class="sd">        [description]</span>
<span class="sd">    A3 : pd.Series</span>
<span class="sd">        [description]</span>
<span class="sd">    A4 : pd.Series</span>
<span class="sd">        [description]</span>
<span class="sd">    label : pd.Series</span>
<span class="sd">        [description]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Encode classes to OneHotEncoder representation</span>
    <span class="n">encoder_A1_A2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_encoder_2S</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoder_A1_A2</span> <span class="o">=</span> <span class="n">encoder_A1_A2</span>

    <span class="n">encoder_A3_A4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_encoder_2S</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoder_A3_A4</span> <span class="o">=</span> <span class="n">encoder_A3_A4</span>

    <span class="c1"># M1</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_X_for_M1</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">)</span>
    <span class="n">m1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">m1</span> <span class="o">=</span> <span class="n">m1</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._fit_M2" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_fit_M2</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Function to train M2 classifier (Naive Bayes)</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>B1</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>B2</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>label</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_fit_M2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">B2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to train M2 classifier (Naive Bayes)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    B1 : pd.Series</span>
<span class="sd">    B2 : pd.Series</span>
<span class="sd">    label : pd.Series</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Encode classes to OneHotEncoder representation</span>
    <span class="n">encoder_B1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_encoder_1S</span><span class="p">(</span><span class="n">B1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoder_B1</span> <span class="o">=</span> <span class="n">encoder_B1</span>
    <span class="n">encoder_B2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_encoder_1S</span><span class="p">(</span><span class="n">B2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoder_B2</span> <span class="o">=</span> <span class="n">encoder_B2</span>

    <span class="c1"># Multinomial Naive Bayes</span>
    <span class="n">m2</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_X_for_M2</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span>
    <span class="n">m2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">m2</span> <span class="o">=</span> <span class="n">m2</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._get_X_for_M1" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_get_X_for_M1</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Get X matrix for classifier</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>A1</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>A2</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>A3</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>A4</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>np.ndarray</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_get_X_for_M1</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">A1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A3</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A4</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get X matrix for classifier</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    A1 : pd.Series</span>
<span class="sd">    A2 : pd.Series</span>
<span class="sd">    A3 : pd.Series</span>
<span class="sd">    A4 : pd.Series</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A1_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_A1_A2</span><span class="p">,</span> <span class="n">A1</span><span class="p">)</span>
    <span class="n">A2_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_A1_A2</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span>
    <span class="n">A3_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_A3_A4</span><span class="p">,</span> <span class="n">A3</span><span class="p">)</span>
    <span class="n">A4_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_A3_A4</span><span class="p">,</span> <span class="n">A4</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">([</span><span class="n">A1_enc</span><span class="p">,</span> <span class="n">A2_enc</span><span class="p">,</span> <span class="n">A3_enc</span><span class="p">,</span> <span class="n">A4_enc</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">X</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._get_X_for_M2" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_get_X_for_M2</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Get X matrix for classifier</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>B1</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>B2</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>np.ndarray</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_get_X_for_M2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">B2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get X matrix for classifier</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    B1 : pd.Series</span>
<span class="sd">    B2 : pd.Series</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">B1_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_B1</span><span class="p">,</span> <span class="n">B1</span><span class="p">)</span>
    <span class="n">B2_enc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder_B2</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">([</span><span class="n">B1_enc</span><span class="p">,</span> <span class="n">B2_enc</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">X</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._predict_M1" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_predict_M1</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Use M1 for prediction</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>A1</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>A2</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>A3</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>A4</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Dict[str, Any]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_predict_M1</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">A1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A3</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">A4</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Use M1 for prediction</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    A1 : pd.Series</span>
<span class="sd">    A2 : pd.Series</span>
<span class="sd">    A3 : pd.Series</span>
<span class="sd">    A4 : pd.Series</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Dict[str, Any]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_X_for_M1</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">A3</span><span class="p">,</span> <span class="n">A4</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">predictions_proba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span> <span class="s2">&quot;predictions_proba&quot;</span><span class="p">:</span> <span class="n">predictions_proba</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">outputs</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._predict_M2" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_predict_M2</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Use M2 for prediction</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>B1</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>B2</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Dict[str, Any]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_predict_M2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">B2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Use M2 for prediction</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    B1 : pd.Series</span>
<span class="sd">    B2 : pd.Series</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Dict[str, Any]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_X_for_M2</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">predictions_proba</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="n">predictions</span><span class="p">,</span> <span class="s2">&quot;predictions_proba&quot;</span><span class="p">:</span> <span class="n">predictions_proba</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">outputs</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._fit_encoder_2S" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_fit_encoder_2S</span><span class="p">(</span><span class="n">S1</span><span class="p">,</span> <span class="n">S2</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Fit a one hot encoder with 2 Series. It concatenates the series and after it fits.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>S1</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>S2</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>OneHotEncoder</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_fit_encoder_2S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">S2</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OneHotEncoder</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Fit a one hot encoder with 2 Series. It concatenates the series and after it fits.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    S1 : pd.Series</span>
<span class="sd">    S2 : pd.Series</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    OneHotEncoder</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_S1</span> <span class="o">=</span> <span class="n">_convert_series_to_array</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
    <span class="n">_S2</span> <span class="o">=</span> <span class="n">_convert_series_to_array</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">_S1</span><span class="p">,</span> <span class="n">_S2</span><span class="p">])</span>
    <span class="n">encoder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_one_hot_encoder</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">encoder</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._fit_encoder_1S" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_fit_encoder_1S</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Fit a one hot encoder with 1 Series.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>S1</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>OneHotEncoder</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_fit_encoder_1S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S1</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OneHotEncoder</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Fit a one hot encoder with 1 Series.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    S1 : pd.Series</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    OneHotEncoder</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_S1</span> <span class="o">=</span> <span class="n">_convert_series_to_array</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
    <span class="n">encoder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_one_hot_encoder</span><span class="p">(</span><span class="n">_S1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">encoder</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._encode_series" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_encode_series</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Use the one hot encoder to transform a series.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>encoder</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>OneHotEncoder</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>S</code></td>
          <td class="doc-param-details">
            <p>a series to encode (transform)</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.Series</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>np.ndarray</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_encode_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoder</span><span class="p">:</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">S</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Use the one hot encoder to transform a series.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    encoder : OneHotEncoder</span>
<span class="sd">    S : pd.Series</span>
<span class="sd">        a series to encode (transform)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_S</span> <span class="o">=</span> <span class="n">_convert_series_to_array</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="n">S_enc</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">_S</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">S_enc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel.set_spans" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_spans</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Function to set the results of the algorithm (pd.DataFrame)
as spans of the spaCy document.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>corpus</code></td>
          <td class="doc-param-details">
            <p>Iterable of spaCy Documents</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Iterable[Doc]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>df</code></td>
          <td class="doc-param-details">
            <p>It should have the columns:
["DOC_ID","original_token_index","PREDICTED_END_LINE"]</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">set_spans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corpus</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Doc</span><span class="p">],</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to set the results of the algorithm (pd.DataFrame)</span>
<span class="sd">    as spans of the spaCy document.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    corpus : Iterable[Doc]</span>
<span class="sd">        Iterable of spaCy Documents</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        It should have the columns:</span>
<span class="sd">        [&quot;DOC_ID&quot;,&quot;original_token_index&quot;,&quot;PREDICTED_END_LINE&quot;]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">doc_id</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
        <span class="n">spans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">token_i</span><span class="p">,</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">df</span><span class="o">.</span><span class="n">DOC_ID</span> <span class="o">==</span> <span class="n">doc_id</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;original_token_index&quot;</span><span class="p">,</span> <span class="s2">&quot;PREDICTED_END_LINE&quot;</span><span class="p">]</span>
        <span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">token_i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">token_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">_get_label</span><span class="p">(</span><span class="n">pred</span><span class="p">))</span>

            <span class="n">spans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;new_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spans</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._retrieve_lines" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_retrieve_lines</span><span class="p">(</span><span class="n">dfg</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Function to give a sentence_id to each token.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dfg</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>DataFrameGroupBy</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>DataFrameGroupBy</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Same DataFrameGroupBy with the column <code>SENTENCE_ID</code></p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">_retrieve_lines</span><span class="p">(</span><span class="n">dfg</span><span class="p">:</span> <span class="n">DataFrameGroupBy</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrameGroupBy</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Function to give a sentence_id to each token.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dfg : DataFrameGroupBy</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataFrameGroupBy</span>
<span class="sd">        Same DataFrameGroupBy with the column `SENTENCE_ID`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sentences_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dfg</span><span class="o">.</span><span class="n">END_LINE</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">dfg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dfg</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">,</span> <span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sentences_ids</span>
    <span class="n">dfg</span><span class="p">[</span><span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfg</span><span class="p">[</span><span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;bfill&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dfg</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._create_vocabulary" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_create_vocabulary</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Function to create a vocabulary for attributes in the training set.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>iterable</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>dict</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">_create_vocabulary</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Function to create a vocabulary for attributes in the training set.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : iterable</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

    <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._compute_B" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_compute_B</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Function to compute B1 and B2</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">_compute_B</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Function to compute B1 and B2</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;LENGTH&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">))</span>
    <span class="n">df_t</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">END_LINE</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">],</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
    <span class="p">)</span>

    <span class="n">stats_doc</span> <span class="o">=</span> <span class="n">df_t</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;mean&quot;</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">))</span>
    <span class="n">stats_doc</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>  <span class="c1"># Replace the 0 std by unit std, otherwise it breaks the code.</span>
    <span class="n">stats_doc</span><span class="p">[</span><span class="s2">&quot;cv&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats_doc</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">stats_doc</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">]</span>

    <span class="n">df_t</span> <span class="o">=</span> <span class="n">df_t</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">,</span> <span class="s2">&quot;SENTENCE_ID&quot;</span><span class="p">])</span>
    <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_t</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

    <span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stats_doc</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
    <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;l_norm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span>

    <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;cv_bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;cv&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;B2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;cv_bin&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>

    <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;l_norm_bin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s2">&quot;l_norm&quot;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;B1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;l_norm_bin&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>

    <span class="k">return</span> <span class="n">df2</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._shift_col" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_shift_col</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">new_col</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;backward&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Shifts a column one position into backward / forward direction.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>df</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>col</code></td>
          <td class="doc-param-details">
            <p>column to shift</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>new_col</code></td>
          <td class="doc-param-details">
            <p>column name to save the results</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>direction</code></td>
          <td class="doc-param-details">
            <p>one of {"backward", "forward"}, by default "backward"</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;backward&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>fill</code></td>
          <td class="doc-param-details">
            <p>, by default None</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>[type], optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>same df with <code>new_col</code> added.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">_shift_col</span><span class="p">(</span>
    <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Shifts a column one position into backward / forward direction.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">    col : str</span>
<span class="sd">        column to shift</span>
<span class="sd">    new_col : str</span>
<span class="sd">        column name to save the results</span>
<span class="sd">    direction : str, optional</span>
<span class="sd">        one of {&quot;backward&quot;, &quot;forward&quot;}, by default &quot;backward&quot;</span>
<span class="sd">    fill : [type], optional</span>
<span class="sd">        , by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        same df with `new_col` added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">fill</span>

    <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;backward&quot;</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="n">different_doc_id</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">different_doc_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">different_doc_id</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">different_doc_id</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">different_doc_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">different_doc_id</span><span class="p">)</span>

    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">different_doc_id</span><span class="p">,</span> <span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">fill</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._get_attributes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_get_attributes</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Function to get the attributes of tokens of a spacy doc in a pd.DataFrame format.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spacy Doc</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>i</code></td>
          <td class="doc-param-details">
            <p>document id, by default 0</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>0</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Returns a dataframe with one line per token. It has the following columns :
<code>[
"ORTH",
"LOWER",
"SHAPE",
"IS_DIGIT",
"IS_SPACE",
"IS_UPPER",
"IS_PUNCT",
"LENGTH",
]</code></p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">_get_attributes</span><span class="p">(</span><span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to get the attributes of tokens of a spacy doc in a pd.DataFrame format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        spacy Doc</span>
<span class="sd">    i : int, optional</span>
<span class="sd">        document id, by default 0</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        Returns a dataframe with one line per token. It has the following columns :</span>
<span class="sd">        `[</span>
<span class="sd">        &quot;ORTH&quot;,</span>
<span class="sd">        &quot;LOWER&quot;,</span>
<span class="sd">        &quot;SHAPE&quot;,</span>
<span class="sd">        &quot;IS_DIGIT&quot;,</span>
<span class="sd">        &quot;IS_SPACE&quot;,</span>
<span class="sd">        &quot;IS_UPPER&quot;,</span>
<span class="sd">        &quot;IS_PUNCT&quot;,</span>
<span class="sd">        &quot;LENGTH&quot;,</span>
<span class="sd">        ]`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ORTH&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LOWER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SHAPE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;IS_DIGIT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;IS_SPACE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;IS_UPPER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;IS_PUNCT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LENGTH&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">attributes_array</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="n">attributes</span><span class="p">)</span>
    <span class="n">attributes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">attributes_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">attributes</span><span class="p">)</span>
    <span class="n">attributes_df</span><span class="p">[</span><span class="s2">&quot;DOC_ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">boolean_attr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">a</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;IS_&quot;</span><span class="p">:</span>
            <span class="n">boolean_attr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">attributes_df</span><span class="p">[</span><span class="n">boolean_attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">attributes_df</span><span class="p">[</span><span class="n">boolean_attr</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;boolean&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">attributes_df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._get_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_get_string</span><span class="p">(</span><span class="n">_id</span><span class="p">,</span> <span class="n">string_store</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Returns the string corresponding to the token_id</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>_id</code></td>
          <td class="doc-param-details">
            <p>token id</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>string_store</code></td>
          <td class="doc-param-details">
            <p>spaCy Language String Store</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>StringStore</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>str</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>string representation of the token.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">_get_string</span><span class="p">(</span><span class="n">_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">string_store</span><span class="p">:</span> <span class="n">StringStore</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns the string corresponding to the token_id</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    _id : int</span>
<span class="sd">        token id</span>
<span class="sd">    string_store : StringStore</span>
<span class="sd">        spaCy Language String Store</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        string representation of the token.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">string_store</span><span class="p">[</span><span class="n">_id</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlinesmodel.EndLinesModel._fit_one_hot_encoder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_fit_one_hot_encoder</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Fit a one hot encoder.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>X</code></td>
          <td class="doc-param-details">
            <p>of shape (n,1)</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>np.ndarray</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>OneHotEncoder</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlinesmodel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">_fit_one_hot_encoder</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OneHotEncoder</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Fit a one hot encoder.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : np.ndarray</span>
<span class="sd">        of shape (n,1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    OneHotEncoder</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="n">encoder</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">encoder</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.endlines.endlines" class="doc doc-heading">
        <code>endlines</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.core.endlines.endlines.EndLines" class="doc doc-heading">
          <code>EndLines</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.core.matcher.GenericMatcher" href="pipelines/core/matcher/matcher/#edsnlp.pipelines.core.matcher.matcher.GenericMatcher">GenericMatcher</a></code></p>


      <p>spaCy Pipeline to detect whether a newline character should
be considered a space (ie introduced by the PDF).</p>
<p>The pipeline will add the extension <code>end_line</code> to spans
and tokens. The <code>end_line</code> attribute is a boolean or <code>None</code>,
set to <code>True</code> if the pipeline predicts that the new line
is an end line character. Otherwise, it is  set to <code>False</code>
if the new line is classified as a space. If no classification
has been done over that token, it will remain <code>None</code>.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy nlp pipeline to use for matching.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>
      <p>end_lines_model : Optional[Union[str, EndLinesModel]], by default None
    path to trained model. If None, it will use a default model</p>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlines.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">EndLines</span><span class="p">(</span><span class="n">GenericMatcher</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    spaCy Pipeline to detect whether a newline character should</span>
<span class="sd">    be considered a space (ie introduced by the PDF).</span>

<span class="sd">    The pipeline will add the extension `end_line` to spans</span>
<span class="sd">    and tokens. The `end_line` attribute is a boolean or `None`,</span>
<span class="sd">    set to `True` if the pipeline predicts that the new line</span>
<span class="sd">    is an end line character. Otherwise, it is  set to `False`</span>
<span class="sd">    if the new line is classified as a space. If no classification</span>
<span class="sd">    has been done over that token, it will remain `None`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy nlp pipeline to use for matching.</span>

<span class="sd">    end_lines_model : Optional[Union[str, EndLinesModel]], by default None</span>
<span class="sd">        path to trained model. If None, it will use a default model</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">end_lines_model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EndLinesModel</span><span class="p">]],</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="p">,</span>
            <span class="n">terms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="s2">&quot;TEXT&quot;</span><span class="p">,</span>
            <span class="n">regex</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">new_line</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\n+&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;end_line&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;end_line&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;end_line&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;end_line&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_read_model</span><span class="p">(</span><span class="n">end_lines_model</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">end_lines_model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EndLinesModel</span><span class="p">]]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        end_lines_model : Optional[Union[str, EndLinesModel]]</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">end_lines_model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">build_path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="s2">&quot;base_model.pkl&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inp</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">end_lines_model</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">end_lines_model</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inp</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">end_lines_model</span><span class="p">)</span> <span class="o">==</span> <span class="n">EndLinesModel</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">end_lines_model</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;type(`end_lines_model`) should be one of {None, str, EndLinesModel}&quot;</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_spacy_compute_a3a4</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="n">Token</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Function to compute A3 and A4</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        token : Token</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_upper</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;UPPER&quot;</span>

        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">shape_</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Xx&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;S_UPPER&quot;</span>

        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">shape_</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;LOWER&quot;</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">is_digit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">doc</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">is_punct</span><span class="p">)</span>
            <span class="o">|</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">doc</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">is_punct</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;ENUMERATION&quot;</span>

        <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_digit</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;DIGIT&quot;</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">is_punct</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;...&quot;</span><span class="p">]):</span>
            <span class="k">return</span> <span class="s2">&quot;STRONG_PUNCT&quot;</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">is_punct</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;...&quot;</span><span class="p">]):</span>
            <span class="k">return</span> <span class="s2">&quot;SOFT_PUNCT&quot;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;OTHER&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_compute_length</span><span class="p">(</span><span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Compute length without spaces</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc : Doc</span>
<span class="sd">        start : int</span>
<span class="sd">        end : int</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
            <span class="n">length</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">length</span>

    <span class="k">def</span> <span class="nf">_get_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">new_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get a pandas DataFrame to call the classifier</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc : Doc</span>
<span class="sd">        new_lines : List[Span]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pd.DataFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">span</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_lines</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span>

            <span class="n">max_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">a1_token</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">start</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
            <span class="n">a2_token</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_index</span><span class="p">)]</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="n">a1_token</span><span class="o">.</span><span class="n">orth</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="n">a2_token</span><span class="o">.</span><span class="n">orth</span>
            <span class="n">a3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spacy_compute_a3a4</span><span class="p">(</span><span class="n">a1_token</span><span class="p">)</span>
            <span class="n">a4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spacy_compute_a3a4</span><span class="p">(</span><span class="n">a2_token</span><span class="p">)</span>
            <span class="n">blank_line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">span</span><span class="o">.</span><span class="n">text</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">start_previous</span> <span class="o">=</span> <span class="n">new_lines</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">start_previous</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_length</span><span class="p">(</span>
                <span class="n">doc</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start_previous</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">start</span>
            <span class="p">)</span>  <span class="c1"># It&#39;s ok cause i count the total length from the previous up to this one</span>

            <span class="n">data_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">span_start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span>
                <span class="n">span_end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span>
                <span class="n">A1</span><span class="o">=</span><span class="n">a1</span><span class="p">,</span>
                <span class="n">A2</span><span class="o">=</span><span class="n">a2</span><span class="p">,</span>
                <span class="n">A3</span><span class="o">=</span><span class="n">a3</span><span class="p">,</span>
                <span class="n">A4</span><span class="o">=</span><span class="n">a4</span><span class="p">,</span>
                <span class="n">BLANK_LINE</span><span class="o">=</span><span class="n">blank_line</span><span class="p">,</span>
                <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">mu</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sigma</span><span class="p">):</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">cv</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">mu</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cv</span>

        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict for each new line if it&#39;s an end of line or a space.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc: spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc: spaCy Doc object, with each new line annotated</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="n">new_lines</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;new_line&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_df</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">,</span> <span class="n">new_lines</span><span class="o">=</span><span class="n">new_lines</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

            <span class="n">spans</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">span</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_lines</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">PREDICTED_END_LINE</span><span class="p">):</span>

                <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="o">=</span> <span class="n">_get_label</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
                <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">end_line</span> <span class="o">=</span> <span class="n">prediction</span>

                <span class="n">spans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">span</span><span class="p">:</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">end_line</span> <span class="o">=</span> <span class="n">prediction</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">prediction</span><span class="p">:</span>
                        <span class="n">t</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">excluded</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;new_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spans</span>
        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlines.EndLines.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">end_lines_model</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlines.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">end_lines_model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EndLinesModel</span><span class="p">]],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">terms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="s2">&quot;TEXT&quot;</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">new_line</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;\n+&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;end_line&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;end_line&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;end_line&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;end_line&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_read_model</span><span class="p">(</span><span class="n">end_lines_model</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlines.EndLines._read_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_read_model</span><span class="p">(</span><span class="n">end_lines_model</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>end_lines_model</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Union[str, EndLinesModel]]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code>TypeError</code>
            </span>
          </td>
          <td class="doc-raises-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlines.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_read_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">end_lines_model</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">EndLinesModel</span><span class="p">]]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    end_lines_model : Optional[Union[str, EndLinesModel]]</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    TypeError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">end_lines_model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">build_path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="s2">&quot;base_model.pkl&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">end_lines_model</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">end_lines_model</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">inp</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">end_lines_model</span><span class="p">)</span> <span class="o">==</span> <span class="n">EndLinesModel</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">end_lines_model</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;type(`end_lines_model`) should be one of {None, str, EndLinesModel}&quot;</span>
        <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlines.EndLines._spacy_compute_a3a4" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_spacy_compute_a3a4</span><span class="p">(</span><span class="n">token</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Function to compute A3 and A4</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>token</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Token</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>str</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlines.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">_spacy_compute_a3a4</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="n">Token</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Function to compute A3 and A4</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    token : Token</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_upper</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;UPPER&quot;</span>

    <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">shape_</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Xx&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;S_UPPER&quot;</span>

    <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">shape_</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;LOWER&quot;</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">is_digit</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">doc</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">is_punct</span><span class="p">)</span>
        <span class="o">|</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">doc</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">is_punct</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;ENUMERATION&quot;</span>

    <span class="k">elif</span> <span class="n">token</span><span class="o">.</span><span class="n">is_digit</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;DIGIT&quot;</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">is_punct</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;...&quot;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="s2">&quot;STRONG_PUNCT&quot;</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">is_punct</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;...&quot;</span><span class="p">]):</span>
        <span class="k">return</span> <span class="s2">&quot;SOFT_PUNCT&quot;</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;OTHER&quot;</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlines.EndLines._compute_length" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_compute_length</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Compute length without spaces</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>start</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>end</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>int</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlines.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">_compute_length</span><span class="p">(</span><span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Compute length without spaces</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">    start : int</span>
<span class="sd">    end : int</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
        <span class="n">length</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">length</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlines.EndLines._get_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_get_df</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">new_lines</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Get a pandas DataFrame to call the classifier</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>new_lines</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Span]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlines.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_get_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span> <span class="n">new_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Get a pandas DataFrame to call the classifier</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">    new_lines : List[Span]</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">span</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_lines</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span>

        <span class="n">max_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">a1_token</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">start</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
        <span class="n">a2_token</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_index</span><span class="p">)]</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="n">a1_token</span><span class="o">.</span><span class="n">orth</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">a2_token</span><span class="o">.</span><span class="n">orth</span>
        <span class="n">a3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spacy_compute_a3a4</span><span class="p">(</span><span class="n">a1_token</span><span class="p">)</span>
        <span class="n">a4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spacy_compute_a3a4</span><span class="p">(</span><span class="n">a2_token</span><span class="p">)</span>
        <span class="n">blank_line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">span</span><span class="o">.</span><span class="n">text</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">start_previous</span> <span class="o">=</span> <span class="n">new_lines</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">start_previous</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_length</span><span class="p">(</span>
            <span class="n">doc</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start_previous</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">start</span>
        <span class="p">)</span>  <span class="c1"># It&#39;s ok cause i count the total length from the previous up to this one</span>

        <span class="n">data_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">span_start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span>
            <span class="n">span_end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span>
            <span class="n">A1</span><span class="o">=</span><span class="n">a1</span><span class="p">,</span>
            <span class="n">A2</span><span class="o">=</span><span class="n">a2</span><span class="p">,</span>
            <span class="n">A3</span><span class="o">=</span><span class="n">a3</span><span class="p">,</span>
            <span class="n">A4</span><span class="o">=</span><span class="n">a4</span><span class="p">,</span>
            <span class="n">BLANK_LINE</span><span class="o">=</span><span class="n">blank_line</span><span class="p">,</span>
            <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">mu</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sigma</span><span class="p">):</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">cv</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">/</span> <span class="n">mu</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cv</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.endlines.endlines.EndLines.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Predict for each new line if it's an end of line or a space.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/endlines/endlines.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict for each new line if it&#39;s an end of line or a space.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc: spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc: spaCy Doc object, with each new line annotated</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="n">new_lines</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;new_line&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_df</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">,</span> <span class="n">new_lines</span><span class="o">=</span><span class="n">new_lines</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="n">spans</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">span</span><span class="p">,</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_lines</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">PREDICTED_END_LINE</span><span class="p">):</span>

            <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="o">=</span> <span class="n">_get_label</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
            <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">end_line</span> <span class="o">=</span> <span class="n">prediction</span>

            <span class="n">spans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">span</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">end_line</span> <span class="o">=</span> <span class="n">prediction</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">prediction</span><span class="p">:</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">excluded</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;new_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spans</span>
    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.core.normalizer" class="doc doc-heading">
        <code>normalizer</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.normalizer.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.core.normalizer.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">accents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lowercase</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quotes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pollution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.normalizer.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">accents</span><span class="p">,</span> <span class="n">lowercase</span><span class="p">,</span> <span class="n">quotes</span><span class="p">,</span> <span class="n">pollution</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;normalizer&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.normalizer&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.normalizer&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">accents</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">lowercase</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">quotes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">pollution</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
<span class="p">):</span>

    <span class="k">if</span> <span class="n">accents</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">accents_config</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">accents</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">accents</span><span class="p">)</span>
        <span class="n">accents</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;factories&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.accents&quot;</span><span class="p">)(</span><span class="n">nlp</span><span class="p">,</span> <span class="s2">&quot;eds.accents&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">quotes</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">quotes_config</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">quotes</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">quotes</span><span class="p">)</span>
        <span class="n">quotes</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;factories&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.quotes&quot;</span><span class="p">)(</span><span class="n">nlp</span><span class="p">,</span> <span class="s2">&quot;eds.quotes&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pollution</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">pollution_config</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pollution</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">pollution</span><span class="p">)</span>
        <span class="n">pollution</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;factories&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.pollution&quot;</span><span class="p">)(</span>
            <span class="n">nlp</span><span class="p">,</span> <span class="s2">&quot;eds.pollution&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span>
        <span class="p">)</span>

    <span class="n">normalizer</span> <span class="o">=</span> <span class="n">Normalizer</span><span class="p">(</span>
        <span class="n">lowercase</span><span class="o">=</span><span class="n">lowercase</span><span class="p">,</span>
        <span class="n">accents</span><span class="o">=</span><span class="n">accents</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">quotes</span><span class="o">=</span><span class="n">quotes</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pollution</span><span class="o">=</span><span class="n">pollution</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">normalizer</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.normalizer.normalizer" class="doc doc-heading">
        <code>normalizer</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.core.normalizer.normalizer.Normalizer" class="doc doc-heading">
          <code>Normalizer</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code>object</code></p>


      <p>Normalisation pipeline. Modifies the <code>NORM</code> attribute,
acting on four dimensions :</p>
<ul>
<li><code>lowercase</code>: using the default <code>NORM</code></li>
<li><code>accents</code>: deterministic and fixed-length normalisation of accents.</li>
<li><code>quotes</code>: deterministic and fixed-length normalisation of quotation marks.</li>
<li><code>pollution</code>: removal of pollutions.</li>
</ul>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lowercase</code></td>
          <td class="doc-param-details">
            <p>Whether to remove case.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>accents</code></td>
          <td class="doc-param-details">
            <p>Optional <code>Accents</code> object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Accents]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>quotes</code></td>
          <td class="doc-param-details">
            <p>Optional <code>Quotes</code> object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Quotes]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>pollution</code></td>
          <td class="doc-param-details">
            <p>Optional <code>Pollution</code> object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Pollution]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/core/normalizer/normalizer.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Normalizer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalisation pipeline. Modifies the `NORM` attribute,</span>
<span class="sd">    acting on four dimensions :</span>

<span class="sd">    - `lowercase`: using the default `NORM`</span>
<span class="sd">    - `accents`: deterministic and fixed-length normalisation of accents.</span>
<span class="sd">    - `quotes`: deterministic and fixed-length normalisation of quotation marks.</span>
<span class="sd">    - `pollution`: removal of pollutions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lowercase : bool</span>
<span class="sd">        Whether to remove case.</span>
<span class="sd">    accents : Optional[Accents]</span>
<span class="sd">        Optional `Accents` object.</span>
<span class="sd">    quotes : Optional[Quotes]</span>
<span class="sd">        Optional `Quotes` object.</span>
<span class="sd">    pollution : Optional[Pollution]</span>
<span class="sd">        Optional `Pollution` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">lowercase</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">accents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Accents</span><span class="p">],</span>
        <span class="n">quotes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Quotes</span><span class="p">],</span>
        <span class="n">pollution</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Pollution</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lowercase</span> <span class="o">=</span> <span class="n">lowercase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accents</span> <span class="o">=</span> <span class="n">accents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quotes</span> <span class="o">=</span> <span class="n">quotes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span> <span class="o">=</span> <span class="n">pollution</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the normalisation pipeline, one component at a time.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc : Doc</span>
<span class="sd">            spaCy `Doc` object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Doc</span>
<span class="sd">            Doc object with `NORM` attribute modified</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lowercase</span><span class="p">:</span>
            <span class="n">remove_lowercase</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">accents</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">accents</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quotes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quotes</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.normalizer.Normalizer.lowercase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lowercase</span> <span class="o">=</span> <span class="n">lowercase</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.normalizer.Normalizer.accents" class="doc doc-heading">
<code class="highlight language-python"><span class="n">accents</span> <span class="o">=</span> <span class="n">accents</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.normalizer.Normalizer.quotes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">quotes</span> <span class="o">=</span> <span class="n">quotes</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.normalizer.Normalizer.pollution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pollution</span> <span class="o">=</span> <span class="n">pollution</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.normalizer.normalizer.Normalizer.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">lowercase</span><span class="p">,</span> <span class="n">accents</span><span class="p">,</span> <span class="n">quotes</span><span class="p">,</span> <span class="n">pollution</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/normalizer.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">lowercase</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">accents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Accents</span><span class="p">],</span>
    <span class="n">quotes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Quotes</span><span class="p">],</span>
    <span class="n">pollution</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Pollution</span><span class="p">],</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lowercase</span> <span class="o">=</span> <span class="n">lowercase</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">accents</span> <span class="o">=</span> <span class="n">accents</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">quotes</span> <span class="o">=</span> <span class="n">quotes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span> <span class="o">=</span> <span class="n">pollution</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.normalizer.normalizer.Normalizer.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Apply the normalisation pipeline, one component at a time.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy <code>Doc</code> object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Doc object with <code>NORM</code> attribute modified</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/normalizer.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply the normalisation pipeline, one component at a time.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        spaCy `Doc` object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Doc</span>
<span class="sd">        Doc object with `NORM` attribute modified</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">lowercase</span><span class="p">:</span>
        <span class="n">remove_lowercase</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">accents</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accents</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quotes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quotes</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.normalizer.lowercase" class="doc doc-heading">
        <code>lowercase</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.core.normalizer.lowercase.factory" class="doc doc-heading">
        <code>factory</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.normalizer.lowercase.factory.remove_lowercase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_lowercase</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Add case on the <code>NORM</code> custom attribute. Should always be applied first.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>The spaCy <code>Doc</code> object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The document, with case put back in <code>NORM</code>.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/lowercase/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@Language</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="s2">&quot;remove-lowercase&quot;</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">component</span><span class="p">(</span><span class="s2">&quot;eds.remove-lowercase&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">remove_lowercase</span><span class="p">(</span><span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add case on the `NORM` custom attribute. Should always be applied first.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        The spaCy `Doc` object.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Doc</span>
<span class="sd">        The document, with case put back in `NORM`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
        <span class="n">token</span><span class="o">.</span><span class="n">norm_</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">text</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.normalizer.pollution" class="doc doc-heading">
        <code>pollution</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.core.normalizer.pollution.factory" class="doc doc-heading">
        <code>factory</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.pollution.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">pollution</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.normalizer.pollution.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pollution</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/pollution/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;pollution&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.pollution&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.pollution&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pollution</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]],</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Pollution</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">pollution</span><span class="o">=</span><span class="n">pollution</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.core.normalizer.pollution.pollution" class="doc doc-heading">
        <code>pollution</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h8 id="edsnlp.pipelines.core.normalizer.pollution.pollution.Pollution" class="doc doc-heading">
          <code>Pollution</code>



</h8>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.base.BaseComponent" href="pipelines/base/#edsnlp.pipelines.base.BaseComponent">BaseComponent</a></code></p>


      <p>Tags pollution tokens.</p>
<p>Populates a number of spaCy extensions :</p>
<ul>
<li><code>Token._.pollution</code> : indicates whether the token is a pollution</li>
<li><code>Doc._.clean</code> : lists non-pollution tokens</li>
<li><code>Doc._.clean_</code> : original text with pollutions removed.</li>
<li><code>Doc._.char_clean_span</code> : method to create a Span using character
  indices extracted using the cleaned text.</li>
</ul>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>Language pipeline object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>pollution</code></td>
          <td class="doc-param-details">
            <p>Dictionary containing regular expressions of pollution.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Dict[str, Union[str, List[str]]]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/core/normalizer/pollution/pollution.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Pollution</span><span class="p">(</span><span class="n">BaseComponent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tags pollution tokens.</span>

<span class="sd">    Populates a number of spaCy extensions :</span>

<span class="sd">    - `Token._.pollution` : indicates whether the token is a pollution</span>
<span class="sd">    - `Doc._.clean` : lists non-pollution tokens</span>
<span class="sd">    - `Doc._.clean_` : original text with pollutions removed.</span>
<span class="sd">    - `Doc._.char_clean_span` : method to create a Span using character</span>
<span class="sd">      indices extracted using the cleaned text.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        Language pipeline object</span>
<span class="sd">    pollution : Dict[str, Union[str, List[str]]]</span>
<span class="sd">        Dictionary containing regular expressions of pollution.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># noinspection PyProtectedMember</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">pollution</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]],</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;EXCLUDED&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pollution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pollution</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">pollution</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span> <span class="o">=</span> <span class="n">pollution</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">build_patterns</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">build_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds the patterns for phrase matching.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># efficiently build spaCy matcher patterns</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find pollutions in doc and clean candidate negations to remove pseudo negations</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pollution:</span>
<span class="sd">            list of pollution spans</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pollutions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pollutions</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">pollutions</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pollutions</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tags pollutions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object, annotated for pollutions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">excluded_hash</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span><span class="s2">&quot;EXCLUDED&quot;</span><span class="p">]</span>
        <span class="n">pollutions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">pollution</span> <span class="ow">in</span> <span class="n">pollutions</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">pollution</span><span class="p">:</span>
                <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">excluded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">token</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="n">excluded_hash</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;pollutions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pollutions</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.core.normalizer.pollution.pollution.Pollution.nlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.core.normalizer.pollution.pollution.Pollution.pollution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pollution</span> <span class="o">=</span> <span class="n">pollution</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.core.normalizer.pollution.pollution.Pollution.regex_matcher" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">()</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.core.normalizer.pollution.pollution.Pollution.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">pollution</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/pollution/pollution.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">pollution</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]],</span>
<span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;EXCLUDED&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pollution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pollution</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">pollution</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span> <span class="o">=</span> <span class="n">pollution</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">build_patterns</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.core.normalizer.pollution.pollution.Pollution.build_patterns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">build_patterns</span><span class="p">()</span></code>


</h9>


    <div class="doc doc-contents ">

      <p>Builds the patterns for phrase matching.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/pollution/pollution.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">build_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds the patterns for phrase matching.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># efficiently build spaCy matcher patterns</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pollution</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.core.normalizer.pollution.pollution.Pollution.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">

      <p>Find pollutions in doc and clean candidate negations to remove pseudo negations</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pollution</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>list of pollution spans</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/pollution/pollution.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find pollutions in doc and clean candidate negations to remove pseudo negations</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pollution:</span>
<span class="sd">        list of pollution spans</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pollutions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pollutions</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">pollutions</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pollutions</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.core.normalizer.pollution.pollution.Pollution.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">

      <p>Tags pollutions.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>spaCy Doc object, annotated for pollutions.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/pollution/pollution.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tags pollutions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object, annotated for pollutions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">excluded_hash</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">strings</span><span class="p">[</span><span class="s2">&quot;EXCLUDED&quot;</span><span class="p">]</span>
    <span class="n">pollutions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">pollution</span> <span class="ow">in</span> <span class="n">pollutions</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">pollution</span><span class="p">:</span>
            <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">excluded</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">token</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="n">excluded_hash</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;pollutions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pollutions</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.core.normalizer.pollution.patterns" class="doc doc-heading">
        <code>patterns</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.pollution.patterns.information" class="doc doc-heading">
<code class="highlight language-python"><span class="n">information</span> <span class="o">=</span> <span class="s2">&quot;(?s)(=====+</span><span class="se">\\</span><span class="s2">s*)?(L</span><span class="se">\\</span><span class="s2">s*e</span><span class="se">\\</span><span class="s2">s*s</span><span class="se">\\</span><span class="s2">sdonnées</span><span class="se">\\</span><span class="s2">s*administratives,</span><span class="se">\\</span><span class="s2">s*sociales</span><span class="se">\\</span><span class="s2">s*|I?nfo</span><span class="se">\\</span><span class="s2">s*rmation</span><span class="se">\\</span><span class="s2">s*aux?</span><span class="se">\\</span><span class="s2">s*patients?|L[’&#39;]AP-HP</span><span class="se">\\</span><span class="s2">s*collecte</span><span class="se">\\</span><span class="s2">s*vos</span><span class="se">\\</span><span class="s2">s*données</span><span class="se">\\</span><span class="s2">s*administratives|L[’&#39;]Assistance</span><span class="se">\\</span><span class="s2">s*Publique</span><span class="se">\\</span><span class="s2">s*-</span><span class="se">\\</span><span class="s2">s*Hôpitaux</span><span class="se">\\</span><span class="s2">s*de</span><span class="se">\\</span><span class="s2">s*Paris</span><span class="se">\\</span><span class="s2">s*</span><span class="se">\\</span><span class="s2">(?AP-HP</span><span class="se">\\</span><span class="s2">)?</span><span class="se">\\</span><span class="s2">s*a</span><span class="se">\\</span><span class="s2">s*créé</span><span class="se">\\</span><span class="s2">s*une</span><span class="se">\\</span><span class="s2">s*base</span><span class="se">\\</span><span class="s2">s*de</span><span class="se">\\</span><span class="s2">s*données).{,2000}https?:</span><span class="se">\\</span><span class="s2">/</span><span class="se">\\</span><span class="s2">/recherche</span><span class="se">\\</span><span class="s2">.aphp</span><span class="se">\\</span><span class="s2">.fr</span><span class="se">\\</span><span class="s2">/eds</span><span class="se">\\</span><span class="s2">/droit-opposition[</span><span class="se">\\</span><span class="s2">s</span><span class="se">\\</span><span class="s2">.]*&quot;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.pollution.patterns.bars" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bars</span> <span class="o">=</span> <span class="s1">&#39;(?i)([nbw]|_|-|=){5,}&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.pollution.patterns.pollution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pollution</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">information</span><span class="o">=</span><span class="n">information</span><span class="p">,</span> <span class="n">bars</span><span class="o">=</span><span class="n">bars</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.normalizer.quotes" class="doc doc-heading">
        <code>quotes</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.core.normalizer.quotes.factory" class="doc doc-heading">
        <code>factory</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.quotes.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">quotes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.normalizer.quotes.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">quotes</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/quotes/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;quotes&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.quotes&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.quotes&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">quotes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]],</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Quotes</span><span class="p">(</span>
        <span class="n">quotes</span><span class="o">=</span><span class="n">quotes</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.core.normalizer.quotes.quotes" class="doc doc-heading">
        <code>quotes</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h8 id="edsnlp.pipelines.core.normalizer.quotes.quotes.Quotes" class="doc doc-heading">
          <code>Quotes</code>



</h8>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code>object</code></p>


      <p>We normalise quotes, following this
<code>source &lt;https://www.cl.cam.ac.uk/~mgk25/ucs/quotes.html&gt;</code>_.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>quotes</code></td>
          <td class="doc-param-details">
            <p>List of quotation characters and their transcription.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Tuple[str, str]]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/core/normalizer/quotes/quotes.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Quotes</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    We normalise quotes, following this</span>
<span class="sd">    `source &lt;https://www.cl.cam.ac.uk/~mgk25/ucs/quotes.html&gt;`_.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    quotes : List[Tuple[str, str]]</span>
<span class="sd">        List of quotation characters and their transcription.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quotes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">quotes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">quotes</span> <span class="o">=</span> <span class="n">quotes_and_apostrophes</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span>
            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quote_group</span> <span class="k">for</span> <span class="n">quote_group</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">),</span>
            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rep</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">quote_group</span><span class="p">)</span> <span class="k">for</span> <span class="n">quote_group</span><span class="p">,</span> <span class="n">rep</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalises quotes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc : Doc</span>
<span class="sd">            Document to process.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Doc</span>
<span class="sd">            Same document, with quotes normalised.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
            <span class="n">token</span><span class="o">.</span><span class="n">norm_</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">norm_</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.core.normalizer.quotes.quotes.Quotes.translation_table" class="doc doc-heading">
<code class="highlight language-python"><span class="n">translation_table</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quote_group</span> <span class="k">for</span> <span class="p">(</span><span class="n">quote_group</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rep</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">quote_group</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">quote_group</span><span class="p">,</span> <span class="n">rep</span><span class="p">)</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.core.normalizer.quotes.quotes.Quotes.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">quotes</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/quotes/quotes.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quotes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">quotes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">quotes</span> <span class="o">=</span> <span class="n">quotes_and_apostrophes</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span>
        <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quote_group</span> <span class="k">for</span> <span class="n">quote_group</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">),</span>
        <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rep</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">quote_group</span><span class="p">)</span> <span class="k">for</span> <span class="n">quote_group</span><span class="p">,</span> <span class="n">rep</span> <span class="ow">in</span> <span class="n">quotes</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.core.normalizer.quotes.quotes.Quotes.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">

      <p>Normalises quotes.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>Document to process.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Same document, with quotes normalised.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/quotes/quotes.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalises quotes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        Document to process.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Doc</span>
<span class="sd">        Same document, with quotes normalised.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
        <span class="n">token</span><span class="o">.</span><span class="n">norm_</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">norm_</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.core.normalizer.quotes.patterns" class="doc doc-heading">
        <code>patterns</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.quotes.patterns.quotes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">quotes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;＂&#39;</span><span class="p">,</span> <span class="s1">&#39;〃&#39;</span><span class="p">,</span> <span class="s1">&#39;ײ&#39;</span><span class="p">,</span> <span class="s1">&#39;᳓&#39;</span><span class="p">,</span> <span class="s1">&#39;″&#39;</span><span class="p">,</span> <span class="s1">&#39;״&#39;</span><span class="p">,</span> <span class="s1">&#39;‶&#39;</span><span class="p">,</span> <span class="s1">&#39;˶&#39;</span><span class="p">,</span> <span class="s1">&#39;ʺ&#39;</span><span class="p">,</span> <span class="s1">&#39;“&#39;</span><span class="p">,</span> <span class="s1">&#39;”&#39;</span><span class="p">,</span> <span class="s1">&#39;˝&#39;</span><span class="p">,</span> <span class="s1">&#39;‟&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.quotes.patterns.apostrophes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">apostrophes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;｀&#39;</span><span class="p">,</span> <span class="s1">&#39;΄&#39;</span><span class="p">,</span> <span class="s1">&#39;＇&#39;</span><span class="p">,</span> <span class="s1">&#39;ˈ&#39;</span><span class="p">,</span> <span class="s1">&#39;ˊ&#39;</span><span class="p">,</span> <span class="s1">&#39;ᑊ&#39;</span><span class="p">,</span> <span class="s1">&#39;ˋ&#39;</span><span class="p">,</span> <span class="s1">&#39;ꞌ&#39;</span><span class="p">,</span> <span class="s1">&#39;ᛌ&#39;</span><span class="p">,</span> <span class="s1">&#39;𖽒&#39;</span><span class="p">,</span> <span class="s1">&#39;𖽑&#39;</span><span class="p">,</span> <span class="s1">&#39;‘&#39;</span><span class="p">,</span> <span class="s1">&#39;’&#39;</span><span class="p">,</span> <span class="s1">&#39;י&#39;</span><span class="p">,</span> <span class="s1">&#39;՚&#39;</span><span class="p">,</span> <span class="s1">&#39;‛&#39;</span><span class="p">,</span> <span class="s1">&#39;՝&#39;</span><span class="p">,</span> <span class="s1">&#39;`&#39;</span><span class="p">,</span> <span class="s1">&#39;`&#39;</span><span class="p">,</span> <span class="s1">&#39;′&#39;</span><span class="p">,</span> <span class="s1">&#39;׳&#39;</span><span class="p">,</span> <span class="s1">&#39;´&#39;</span><span class="p">,</span> <span class="s1">&#39;ʹ&#39;</span><span class="p">,</span> <span class="s1">&#39;˴&#39;</span><span class="p">,</span> <span class="s1">&#39;ߴ&#39;</span><span class="p">,</span> <span class="s1">&#39;‵&#39;</span><span class="p">,</span> <span class="s1">&#39;ߵ&#39;</span><span class="p">,</span> <span class="s1">&#39;ʹ&#39;</span><span class="p">,</span> <span class="s1">&#39;ʻ&#39;</span><span class="p">,</span> <span class="s1">&#39;ʼ&#39;</span><span class="p">,</span> <span class="s1">&#39;´&#39;</span><span class="p">,</span> <span class="s1">&#39;᾽&#39;</span><span class="p">,</span> <span class="s1">&#39;ʽ&#39;</span><span class="p">,</span> <span class="s1">&#39;῾&#39;</span><span class="p">,</span> <span class="s1">&#39;ʾ&#39;</span><span class="p">,</span> <span class="s1">&#39;᾿&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.quotes.patterns.quotes_and_apostrophes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">quotes_and_apostrophes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">quotes</span><span class="p">),</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">apostrophes</span><span class="p">),</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.normalizer.accents" class="doc doc-heading">
        <code>accents</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.core.normalizer.accents.factory" class="doc doc-heading">
        <code>factory</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.accents.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">accents</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.normalizer.accents.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">accents</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/accents/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;accents&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.accents&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.accents&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">accents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]],</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Accents</span><span class="p">(</span>
        <span class="n">accents</span><span class="o">=</span><span class="n">accents</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.core.normalizer.accents.patterns" class="doc doc-heading">
        <code>patterns</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.normalizer.accents.patterns.accents" class="doc doc-heading">
<code class="highlight language-python"><span class="n">accents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;ç&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;àáâä&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;èéêë&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;ìíîï&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;òóôö&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;ùúûü&#39;</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">)]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.core.normalizer.accents.accents" class="doc doc-heading">
        <code>accents</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h8 id="edsnlp.pipelines.core.normalizer.accents.accents.Accents" class="doc doc-heading">
          <code>Accents</code>



</h8>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code>object</code></p>


      <p>Normalises accents, using a same-length strategy.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>accents</code></td>
          <td class="doc-param-details">
            <p>List of accentuated characters and their transcription.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Tuple[str, str]]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/core/normalizer/accents/accents.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Accents</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalises accents, using a same-length strategy.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    accents : List[Tuple[str, str]]</span>
<span class="sd">        List of accentuated characters and their transcription.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">accents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">accents</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">accents</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span>
            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">accent_group</span> <span class="k">for</span> <span class="n">accent_group</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">accents</span><span class="p">),</span>
            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rep</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">accent_group</span><span class="p">)</span> <span class="k">for</span> <span class="n">accent_group</span><span class="p">,</span> <span class="n">rep</span> <span class="ow">in</span> <span class="n">accents</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove accents from spacy `NORM` attribute.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc : Doc</span>
<span class="sd">            The spaCy `Doc` object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Doc</span>
<span class="sd">            The document, with accents removed in `Token.norm_`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
            <span class="n">token</span><span class="o">.</span><span class="n">norm_</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">norm_</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.core.normalizer.accents.accents.Accents.translation_table" class="doc doc-heading">
<code class="highlight language-python"><span class="n">translation_table</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">accent_group</span> <span class="k">for</span> <span class="p">(</span><span class="n">accent_group</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">accents</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rep</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">accent_group</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">accent_group</span><span class="p">,</span> <span class="n">rep</span><span class="p">)</span> <span class="ow">in</span> <span class="n">accents</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.core.normalizer.accents.accents.Accents.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">accents</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/accents/accents.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">accents</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">accents</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">accents</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span>
        <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">accent_group</span> <span class="k">for</span> <span class="n">accent_group</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">accents</span><span class="p">),</span>
        <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rep</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">accent_group</span><span class="p">)</span> <span class="k">for</span> <span class="n">accent_group</span><span class="p">,</span> <span class="n">rep</span> <span class="ow">in</span> <span class="n">accents</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h9 id="edsnlp.pipelines.core.normalizer.accents.accents.Accents.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h9>


    <div class="doc doc-contents ">

      <p>Remove accents from spacy <code>NORM</code> attribute.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>The spaCy <code>Doc</code> object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The document, with accents removed in <code>Token.norm_</code>.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/normalizer/accents/accents.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove accents from spacy `NORM` attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        The spaCy `Doc` object.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Doc</span>
<span class="sd">        The document, with accents removed in `Token.norm_`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
        <span class="n">token</span><span class="o">.</span><span class="n">norm_</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">norm_</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translation_table</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.core.matcher" class="doc doc-heading">
        <code>matcher</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.matcher.matcher" class="doc doc-heading">
        <code>matcher</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.core.matcher.matcher.GenericMatcher" class="doc doc-heading">
          <code>GenericMatcher</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.base.BaseComponent" href="pipelines/base/#edsnlp.pipelines.base.BaseComponent">BaseComponent</a></code></p>


      <p>Provides a generic matcher component.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>The spaCy object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>terms</code></td>
          <td class="doc-param-details">
            <p>A dictionary of terms.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Patterns]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>regex</code></td>
          <td class="doc-param-details">
            <p>A dictionary of regular expressions.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Patterns]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>The default attribute to use for matching.
Can be overiden using the <code>terms</code> and <code>regex</code> configurations.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>filter_matches</code></td>
          <td class="doc-param-details">
            <p>Whether to filter out matches.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>on_ents_only</code></td>
          <td class="doc-param-details">
            <p>Whether to to look for matches around pre-extracted entities only.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether to skip excluded tokens (requires an upstream
pipeline to mark excluded tokens).</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/core/matcher/matcher.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">GenericMatcher</span><span class="p">(</span><span class="n">BaseComponent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides a generic matcher component.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        The spaCy object.</span>
<span class="sd">    terms : Optional[Patterns]</span>
<span class="sd">        A dictionary of terms.</span>
<span class="sd">    regex : Optional[Patterns]</span>
<span class="sd">        A dictionary of regular expressions.</span>
<span class="sd">    attr : str</span>
<span class="sd">        The default attribute to use for matching.</span>
<span class="sd">        Can be overiden using the `terms` and `regex` configurations.</span>
<span class="sd">    filter_matches : bool</span>
<span class="sd">        Whether to filter out matches.</span>
<span class="sd">    on_ents_only : bool</span>
<span class="sd">        Whether to to look for matches around pre-extracted entities only.</span>
<span class="sd">    ignore_excluded : bool</span>
<span class="sd">        Whether to skip excluded tokens (requires an upstream</span>
<span class="sd">        pipeline to mark excluded tokens).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">terms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Patterns</span><span class="p">],</span>
        <span class="n">regex</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Patterns</span><span class="p">],</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">attr</span> <span class="o">=</span> <span class="n">attr</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span> <span class="o">=</span> <span class="n">EDSPhraseMatcher</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span><span class="o">.</span><span class="n">build_patterns</span><span class="p">(</span><span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="n">terms</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">build_patterns</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find matching spans in doc.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        spans:</span>
<span class="sd">            List of Spans returned by the matchers.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">regex_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">spans</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">regex_matches</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">spans</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds spans to document.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object, annotated for extracted terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
                <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">label_</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">label_</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

        <span class="n">ents</span><span class="p">,</span> <span class="n">discarded</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="n">matches</span><span class="p">,</span> <span class="n">return_discarded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span>

        <span class="k">if</span> <span class="s2">&quot;discarded&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">discarded</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.matcher.matcher.GenericMatcher.nlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.matcher.matcher.GenericMatcher.attr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">attr</span> <span class="o">=</span> <span class="n">attr</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.matcher.matcher.GenericMatcher.phrase_matcher" class="doc doc-heading">
<code class="highlight language-python"><span class="n">phrase_matcher</span> <span class="o">=</span> <span class="n">EDSPhraseMatcher</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.matcher.matcher.GenericMatcher.regex_matcher" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.matcher.matcher.GenericMatcher.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/matcher/matcher.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">terms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Patterns</span><span class="p">],</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Patterns</span><span class="p">],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">attr</span> <span class="o">=</span> <span class="n">attr</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span> <span class="o">=</span> <span class="n">EDSPhraseMatcher</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span><span class="o">.</span><span class="n">build_patterns</span><span class="p">(</span><span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="n">terms</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">build_patterns</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.matcher.matcher.GenericMatcher.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Find matching spans in doc.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>spans</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of Spans returned by the matchers.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/matcher/matcher.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find matching spans in doc.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    spans:</span>
<span class="sd">        List of Spans returned by the matchers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">regex_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">spans</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">regex_matches</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">spans</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.matcher.matcher.GenericMatcher.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Adds spans to document.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>spaCy Doc object, annotated for extracted terms.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/matcher/matcher.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds spans to document.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object, annotated for extracted terms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">label_</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">label_</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

    <span class="n">ents</span><span class="p">,</span> <span class="n">discarded</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="n">matches</span><span class="p">,</span> <span class="n">return_discarded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span>

    <span class="k">if</span> <span class="s2">&quot;discarded&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">discarded</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.matcher.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.core.matcher.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">terms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;TEXT&#39;</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.matcher.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">regex</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/matcher/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;matcher&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.matcher&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.matcher&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">terms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">regex</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]],</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span><span class="n">terms</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">regex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">terms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">regex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">GenericMatcher</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">terms</span><span class="o">=</span><span class="n">terms</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.core.context" class="doc doc-heading">
        <code>context</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.context.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.core.context.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;note_id&#39;</span><span class="p">])</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.context.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/context/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.context&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">):</span>

    <span class="k">return</span> <span class="n">ContextAdder</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.context.context" class="doc doc-heading">
        <code>context</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.core.context.context.ContextAdder" class="doc doc-heading">
          <code>ContextAdder</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.base.BaseComponent" href="pipelines/base/#edsnlp.pipelines.base.BaseComponent">BaseComponent</a></code></p>


      <p>Provides a generic context adder component.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>The spaCy object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td class="doc-param-details">
            <p>The list of extensions to add to the <code>Doc</code></p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/core/context/context.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ContextAdder</span><span class="p">(</span><span class="n">BaseComponent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides a generic context adder component.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        The spaCy object.</span>
<span class="sd">    context : List[str]</span>
<span class="sd">        The list of extensions to add to the `Doc`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
                <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.context.context.ContextAdder.nlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.context.context.ContextAdder.context" class="doc doc-heading">
<code class="highlight language-python"><span class="n">context</span> <span class="o">=</span> <span class="n">context</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.context.context.ContextAdder.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/context/context.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">context</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.context.context.ContextAdder.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/context/context.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">set_extensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="n">col</span><span class="p">):</span>
            <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.context.context.ContextAdder.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/context/context.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.core.sentences" class="doc doc-heading">
        <code>sentences</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.sentences.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.core.sentences.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">punct_chars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_endlines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.sentences.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">punct_chars</span><span class="p">,</span> <span class="n">use_endlines</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/sentences/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;sentences&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.sentences&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.sentences&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">punct_chars</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">use_endlines</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">SentenceSegmenter</span><span class="p">(</span>
        <span class="n">punct_chars</span><span class="o">=</span><span class="n">punct_chars</span><span class="p">,</span>
        <span class="n">use_endlines</span><span class="o">=</span><span class="n">use_endlines</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.sentences.sentences" class="doc doc-heading">
        <code>sentences</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.core.sentences.sentences.SentenceSegmenter" class="doc doc-heading">
          <code>SentenceSegmenter</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code>object</code></p>


      <p>Segments the Doc into sentences using a rule-based strategy,
specific to AP-HP documents.</p>
<p>Applies the same rule-based pipeline as spaCy's sentencizer,
and adds a simple rule on the new lines : if a new line is followed by a
capitalised word, then it is also an end of sentence.</p>
<p>DOCS: https://spacy.io/api/sentencizer</p>
<h6 id="edsnlp.pipelines.core.sentences.sentences.SentenceSegmenter--arguments">Arguments</h6>
<p>punct_chars : Optional[List[str]]
    Punctuation characters.
use_endlines : bool
    Whether to use endlines prediction.</p>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/core/sentences/sentences.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">SentenceSegmenter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Segments the Doc into sentences using a rule-based strategy,</span>
<span class="sd">    specific to AP-HP documents.</span>

<span class="sd">    Applies the same rule-based pipeline as spaCy&#39;s sentencizer,</span>
<span class="sd">    and adds a simple rule on the new lines : if a new line is followed by a</span>
<span class="sd">    capitalised word, then it is also an end of sentence.</span>

<span class="sd">    DOCS: https://spacy.io/api/sentencizer</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    punct_chars : Optional[List[str]]</span>
<span class="sd">        Punctuation characters.</span>
<span class="sd">    use_endlines : bool</span>
<span class="sd">        Whether to use endlines prediction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">punct_chars</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">use_endlines</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="k">if</span> <span class="n">punct_chars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">punct_chars</span> <span class="o">=</span> <span class="n">punctuation</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">punct_chars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">punct_chars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_endlines</span> <span class="o">=</span> <span class="n">use_endlines</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Segments the document in sentences.</span>

<span class="sd">        Arguments</span>
<span class="sd">        ---------</span>
<span class="sd">        doc:</span>
<span class="sd">            A spacy Doc object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc:</span>
<span class="sd">            A spaCy Doc object, annotated for sentences.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">doc</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">doc</span>

        <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">seen_period</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">seen_newline</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
            <span class="n">is_in_punct_chars</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">punct_chars</span>
            <span class="n">is_newline</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">is_space</span> <span class="ow">and</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">token</span><span class="o">.</span><span class="n">text</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_endlines</span><span class="p">:</span>
                <span class="n">end_line</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="s2">&quot;end_line&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">is_newline</span> <span class="o">=</span> <span class="n">is_newline</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_line</span> <span class="ow">or</span> <span class="n">end_line</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>

            <span class="n">token</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="p">)</span>  <span class="c1"># To set the attributes at False by default for the other tokens</span>
            <span class="k">if</span> <span class="n">seen_period</span> <span class="ow">or</span> <span class="n">seen_newline</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_punct</span> <span class="ow">or</span> <span class="n">is_in_punct_chars</span> <span class="ow">or</span> <span class="n">is_newline</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">seen_period</span><span class="p">:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">seen_newline</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">seen_period</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">shape_</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Xx&quot;</span><span class="p">)</span>
                    <span class="n">seen_newline</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">seen_period</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">is_in_punct_chars</span><span class="p">:</span>
                <span class="n">seen_period</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">is_newline</span><span class="p">:</span>
                <span class="n">seen_newline</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.sentences.sentences.SentenceSegmenter.punct_chars" class="doc doc-heading">
<code class="highlight language-python"><span class="n">punct_chars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">punct_chars</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.sentences.sentences.SentenceSegmenter.use_endlines" class="doc doc-heading">
<code class="highlight language-python"><span class="n">use_endlines</span> <span class="o">=</span> <span class="n">use_endlines</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.sentences.sentences.SentenceSegmenter.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">punct_chars</span><span class="p">,</span> <span class="n">use_endlines</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/sentences/sentences.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">punct_chars</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">use_endlines</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="k">if</span> <span class="n">punct_chars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">punct_chars</span> <span class="o">=</span> <span class="n">punctuation</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">punct_chars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">punct_chars</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_endlines</span> <span class="o">=</span> <span class="n">use_endlines</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.sentences.sentences.SentenceSegmenter.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Segments the document in sentences.</p>
<h6 id="edsnlp.pipelines.core.sentences.sentences.SentenceSegmenter.__call__--arguments">Arguments</h6>
<p>doc:
    A spacy Doc object.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A spaCy Doc object, annotated for sentences.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/sentences/sentences.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Segments the document in sentences.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ---------</span>
<span class="sd">    doc:</span>
<span class="sd">        A spacy Doc object.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc:</span>
<span class="sd">        A spaCy Doc object, annotated for sentences.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">doc</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">doc</span>

    <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">seen_period</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">seen_newline</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
        <span class="n">is_in_punct_chars</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">punct_chars</span>
        <span class="n">is_newline</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">is_space</span> <span class="ow">and</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">token</span><span class="o">.</span><span class="n">text</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_endlines</span><span class="p">:</span>
            <span class="n">end_line</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="s2">&quot;end_line&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">is_newline</span> <span class="o">=</span> <span class="n">is_newline</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_line</span> <span class="ow">or</span> <span class="n">end_line</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">token</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="p">)</span>  <span class="c1"># To set the attributes at False by default for the other tokens</span>
        <span class="k">if</span> <span class="n">seen_period</span> <span class="ow">or</span> <span class="n">seen_newline</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">is_punct</span> <span class="ow">or</span> <span class="n">is_in_punct_chars</span> <span class="ow">or</span> <span class="n">is_newline</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">seen_period</span><span class="p">:</span>
                <span class="n">token</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">seen_newline</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">seen_period</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">token</span><span class="o">.</span><span class="n">sent_start</span> <span class="o">=</span> <span class="n">token</span><span class="o">.</span><span class="n">shape_</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Xx&quot;</span><span class="p">)</span>
                <span class="n">seen_newline</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">seen_period</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">is_in_punct_chars</span><span class="p">:</span>
            <span class="n">seen_period</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">is_newline</span><span class="p">:</span>
            <span class="n">seen_newline</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.sentences.terms" class="doc doc-heading">
        <code>terms</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.core.sentences.terms.punctuation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">punctuation</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;!&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;։&#39;</span><span class="p">,</span> <span class="s1">&#39;؟&#39;</span><span class="p">,</span> <span class="s1">&#39;۔&#39;</span><span class="p">,</span> <span class="s1">&#39;܀&#39;</span><span class="p">,</span> <span class="s1">&#39;܁&#39;</span><span class="p">,</span> <span class="s1">&#39;܂&#39;</span><span class="p">,</span> <span class="s1">&#39;߹&#39;</span><span class="p">,</span> <span class="s1">&#39;।&#39;</span><span class="p">,</span> <span class="s1">&#39;॥&#39;</span><span class="p">,</span> <span class="s1">&#39;၊&#39;</span><span class="p">,</span> <span class="s1">&#39;။&#39;</span><span class="p">,</span> <span class="s1">&#39;።&#39;</span><span class="p">,</span> <span class="s1">&#39;፧&#39;</span><span class="p">,</span> <span class="s1">&#39;፨&#39;</span><span class="p">,</span> <span class="s1">&#39;᙮&#39;</span><span class="p">,</span> <span class="s1">&#39;᜵&#39;</span><span class="p">,</span> <span class="s1">&#39;᜶&#39;</span><span class="p">,</span> <span class="s1">&#39;᠃&#39;</span><span class="p">,</span> <span class="s1">&#39;᠉&#39;</span><span class="p">,</span> <span class="s1">&#39;᥄&#39;</span><span class="p">,</span> <span class="s1">&#39;᥅&#39;</span><span class="p">,</span> <span class="s1">&#39;᪨&#39;</span><span class="p">,</span> <span class="s1">&#39;᪩&#39;</span><span class="p">,</span> <span class="s1">&#39;᪪&#39;</span><span class="p">,</span> <span class="s1">&#39;᪫&#39;</span><span class="p">,</span> <span class="s1">&#39;᭚&#39;</span><span class="p">,</span> <span class="s1">&#39;᭛&#39;</span><span class="p">,</span> <span class="s1">&#39;᭞&#39;</span><span class="p">,</span> <span class="s1">&#39;᭟&#39;</span><span class="p">,</span> <span class="s1">&#39;᰻&#39;</span><span class="p">,</span> <span class="s1">&#39;᰼&#39;</span><span class="p">,</span> <span class="s1">&#39;᱾&#39;</span><span class="p">,</span> <span class="s1">&#39;᱿&#39;</span><span class="p">,</span> <span class="s1">&#39;‼&#39;</span><span class="p">,</span> <span class="s1">&#39;‽&#39;</span><span class="p">,</span> <span class="s1">&#39;⁇&#39;</span><span class="p">,</span> <span class="s1">&#39;⁈&#39;</span><span class="p">,</span> <span class="s1">&#39;⁉&#39;</span><span class="p">,</span> <span class="s1">&#39;⸮&#39;</span><span class="p">,</span> <span class="s1">&#39;⸼&#39;</span><span class="p">,</span> <span class="s1">&#39;꓿&#39;</span><span class="p">,</span> <span class="s1">&#39;꘎&#39;</span><span class="p">,</span> <span class="s1">&#39;꘏&#39;</span><span class="p">,</span> <span class="s1">&#39;꛳&#39;</span><span class="p">,</span> <span class="s1">&#39;꛷&#39;</span><span class="p">,</span> <span class="s1">&#39;꡶&#39;</span><span class="p">,</span> <span class="s1">&#39;꡷&#39;</span><span class="p">,</span> <span class="s1">&#39;꣎&#39;</span><span class="p">,</span> <span class="s1">&#39;꣏&#39;</span><span class="p">,</span> <span class="s1">&#39;꤯&#39;</span><span class="p">,</span> <span class="s1">&#39;꧈&#39;</span><span class="p">,</span> <span class="s1">&#39;꧉&#39;</span><span class="p">,</span> <span class="s1">&#39;꩝&#39;</span><span class="p">,</span> <span class="s1">&#39;꩞&#39;</span><span class="p">,</span> <span class="s1">&#39;꩟&#39;</span><span class="p">,</span> <span class="s1">&#39;꫰&#39;</span><span class="p">,</span> <span class="s1">&#39;꫱&#39;</span><span class="p">,</span> <span class="s1">&#39;꯫&#39;</span><span class="p">,</span> <span class="s1">&#39;﹒&#39;</span><span class="p">,</span> <span class="s1">&#39;﹖&#39;</span><span class="p">,</span> <span class="s1">&#39;﹗&#39;</span><span class="p">,</span> <span class="s1">&#39;！&#39;</span><span class="p">,</span> <span class="s1">&#39;．&#39;</span><span class="p">,</span> <span class="s1">&#39;？&#39;</span><span class="p">,</span> <span class="s1">&#39;𐩖&#39;</span><span class="p">,</span> <span class="s1">&#39;𐩗&#39;</span><span class="p">,</span> <span class="s1">&#39;𑁇&#39;</span><span class="p">,</span> <span class="s1">&#39;𑁈&#39;</span><span class="p">,</span> <span class="s1">&#39;𑂾&#39;</span><span class="p">,</span> <span class="s1">&#39;𑂿&#39;</span><span class="p">,</span> <span class="s1">&#39;𑃀&#39;</span><span class="p">,</span> <span class="s1">&#39;𑃁&#39;</span><span class="p">,</span> <span class="s1">&#39;𑅁&#39;</span><span class="p">,</span> <span class="s1">&#39;𑅂&#39;</span><span class="p">,</span> <span class="s1">&#39;𑅃&#39;</span><span class="p">,</span> <span class="s1">&#39;𑇅&#39;</span><span class="p">,</span> <span class="s1">&#39;𑇆&#39;</span><span class="p">,</span> <span class="s1">&#39;𑇍&#39;</span><span class="p">,</span> <span class="s1">&#39;𑇞&#39;</span><span class="p">,</span> <span class="s1">&#39;𑇟&#39;</span><span class="p">,</span> <span class="s1">&#39;𑈸&#39;</span><span class="p">,</span> <span class="s1">&#39;𑈹&#39;</span><span class="p">,</span> <span class="s1">&#39;𑈻&#39;</span><span class="p">,</span> <span class="s1">&#39;𑈼&#39;</span><span class="p">,</span> <span class="s1">&#39;𑊩&#39;</span><span class="p">,</span> <span class="s1">&#39;𑑋&#39;</span><span class="p">,</span> <span class="s1">&#39;𑑌&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗂&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗃&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗉&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗊&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗋&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗌&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗍&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗎&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗏&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗐&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗑&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗒&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗓&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗔&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗕&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗖&#39;</span><span class="p">,</span> <span class="s1">&#39;𑗗&#39;</span><span class="p">,</span> <span class="s1">&#39;𑙁&#39;</span><span class="p">,</span> <span class="s1">&#39;𑙂&#39;</span><span class="p">,</span> <span class="s1">&#39;𑜼&#39;</span><span class="p">,</span> <span class="s1">&#39;𑜽&#39;</span><span class="p">,</span> <span class="s1">&#39;𑜾&#39;</span><span class="p">,</span> <span class="s1">&#39;𑩂&#39;</span><span class="p">,</span> <span class="s1">&#39;𑩃&#39;</span><span class="p">,</span> <span class="s1">&#39;𑪛&#39;</span><span class="p">,</span> <span class="s1">&#39;𑪜&#39;</span><span class="p">,</span> <span class="s1">&#39;𑱁&#39;</span><span class="p">,</span> <span class="s1">&#39;𑱂&#39;</span><span class="p">,</span> <span class="s1">&#39;𖩮&#39;</span><span class="p">,</span> <span class="s1">&#39;𖩯&#39;</span><span class="p">,</span> <span class="s1">&#39;𖫵&#39;</span><span class="p">,</span> <span class="s1">&#39;𖬷&#39;</span><span class="p">,</span> <span class="s1">&#39;𖬸&#39;</span><span class="p">,</span> <span class="s1">&#39;𖭄&#39;</span><span class="p">,</span> <span class="s1">&#39;𛲟&#39;</span><span class="p">,</span> <span class="s1">&#39;𝪈&#39;</span><span class="p">,</span> <span class="s1">&#39;｡&#39;</span><span class="p">,</span> <span class="s1">&#39;。&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.core.advanced" class="doc doc-heading">
        <code>advanced</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.advanced.advanced" class="doc doc-heading">
        <code>advanced</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex" class="doc doc-heading">
          <code>AdvancedRegex</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.core.matcher.GenericMatcher" href="../pipelines/core/matcher/matcher/#edsnlp.pipelines.core.matcher.matcher.GenericMatcher">GenericMatcher</a></code></p>


      <p>Allows additional matching in the surrounding context of the main match group,
for qualification/filtering.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy <code>Language</code> object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>regex_config</code></td>
          <td class="doc-param-details">
            <p>Configuration for the main expression.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Dict[str, Any]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>window</code></td>
          <td class="doc-param-details">
            <p>Number of tokens to consider before and after the main expression.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>Attribute to match on, eg <code>TEXT</code>, <code>NORM</code>, etc.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td class="doc-param-details">
            <p>Verbosity level, useful for debugging.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether to skip excluded tokens.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">AdvancedRegex</span><span class="p">(</span><span class="n">GenericMatcher</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Allows additional matching in the surrounding context of the main match group,</span>
<span class="sd">    for qualification/filtering.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy `Language` object.</span>
<span class="sd">    regex_config : Dict[str, Any]</span>
<span class="sd">        Configuration for the main expression.</span>
<span class="sd">    window : int</span>
<span class="sd">        Number of tokens to consider before and after the main expression.</span>
<span class="sd">    attr : str</span>
<span class="sd">        Attribute to match on, eg `TEXT`, `NORM`, etc.</span>
<span class="sd">    verbose : int</span>
<span class="sd">        Verbosity level, useful for debugging.</span>
<span class="sd">    ignore_excluded : bool</span>
<span class="sd">        Whether to skip excluded tokens.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">regex_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span> <span class="o">=</span> <span class="n">_check_regex_config</span><span class="p">(</span><span class="n">regex_config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">window</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="n">regex_config</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
            <span class="n">terms</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
            <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_excluded</span> <span class="o">=</span> <span class="n">ignore_excluded</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;my_ents&quot;</span><span class="p">):</span>
            <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;my_ents&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;matcher_name&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;matcher_name&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;before_extract&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;before_extract&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;after_extract&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;after_extract&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;window&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;window&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;before_snippet&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;before_snippet&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;after_snippet&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;after_snippet&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process the document, looking for named entities.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc : Doc</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List[Span]</span>
<span class="sd">            List of detected spans.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ents</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_postprocessing_pipeline</span><span class="p">(</span><span class="n">ents</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ents</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds spans to document.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object, annotated for extracted terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="n">ents</span><span class="p">,</span> <span class="n">discarded</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="n">ents</span><span class="p">,</span> <span class="n">return_discarded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span>

        <span class="k">if</span> <span class="s2">&quot;discarded&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">discarded</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span>

    <span class="k">def</span> <span class="nf">_postprocessing_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]):</span>
        <span class="c1"># add a window within the sentence around entities</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_window</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">]</span>

        <span class="c1"># Remove entities based on the snippet located just before and after the entity</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exclude_filter</span><span class="p">,</span> <span class="n">ents</span><span class="p">)</span>

        <span class="c1"># Extract informations from the entity&#39;s context via regex</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_snippet_extraction</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">ents</span>

    <span class="k">def</span> <span class="nf">_add_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ent</span><span class="p">:</span> <span class="n">Span</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Span</span><span class="p">:</span>
        <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">doc</span><span class="p">[</span>
            <span class="nb">max</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">sent</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="p">:</span> <span class="nb">min</span><span class="p">(</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">sent</span><span class="o">.</span><span class="n">end</span>
            <span class="p">)</span>
        <span class="p">]</span>

        <span class="c1"># include the entity in the snippets so that we can extract</span>
        <span class="c1"># the number when it is attached to the word, e.g. &quot;3PA&quot;</span>
        <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">before_snippet</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">doc</span><span class="p">[</span>
            <span class="nb">max</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">sent</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="p">:</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span>
        <span class="p">]</span>
        <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_snippet</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">doc</span><span class="p">[</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">sent</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">ent</span>

    <span class="k">def</span> <span class="nf">get_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">span</span><span class="p">:</span> <span class="n">Span</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attr&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">get_text</span><span class="p">(</span>
            <span class="n">doclike</span><span class="o">=</span><span class="n">span</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_exclude_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ent</span><span class="p">:</span> <span class="n">Span</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Span</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span>

        <span class="n">before_exclude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;before_exclude&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">after_exclude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;after_exclude&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">before_exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">before_snippet</span>
            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">before_exclude</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;excluded (before) string: </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2"> - pattern </span><span class="si">{</span><span class="n">before_exclude</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">after_exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_snippet</span>
            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">after_exclude</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;excluded (after) string: </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2"> - pattern </span><span class="si">{</span><span class="n">after_exclude</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_snippet_extraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ent</span><span class="p">:</span> <span class="n">Span</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Span</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span>

        <span class="n">before_extract</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;before_extract&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">after_extract</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;after_extract&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">before_extract</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">before_extract</span> <span class="o">=</span> <span class="p">[</span><span class="n">before_extract</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">after_extract</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">after_extract</span> <span class="o">=</span> <span class="p">[</span><span class="n">after_extract</span><span class="p">]</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">before_snippet</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">before_extract</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">before_extract</span><span class="p">:</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">before_extract</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">match</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_snippet</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_extract</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">after_extract</span><span class="p">:</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_extract</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">match</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ent</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex.regex_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex_config</span> <span class="o">=</span> <span class="n">_check_regex_config</span><span class="p">(</span><span class="n">regex_config</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex.window" class="doc doc-heading">
<code class="highlight language-python"><span class="n">window</span> <span class="o">=</span> <span class="n">window</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex.verbose" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex.ignore_excluded" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ignore_excluded</span> <span class="o">=</span> <span class="n">ignore_excluded</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">regex_config</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">regex_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span> <span class="o">=</span> <span class="n">_check_regex_config</span><span class="p">(</span><span class="n">regex_config</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">window</span>
    <span class="n">regex</span> <span class="o">=</span> <span class="n">regex_config</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">terms</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ignore_excluded</span> <span class="o">=</span> <span class="n">ignore_excluded</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;my_ents&quot;</span><span class="p">):</span>
        <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;my_ents&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;matcher_name&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;matcher_name&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;before_extract&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;before_extract&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;after_extract&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;after_extract&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;window&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;window&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;before_snippet&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;before_snippet&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;after_snippet&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;after_snippet&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Process the document, looking for named entities.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List[Span]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of detected spans.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process the document, looking for named entities.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List[Span]</span>
<span class="sd">        List of detected spans.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ents</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_postprocessing_pipeline</span><span class="p">(</span><span class="n">ents</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ents</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Adds spans to document.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>spaCy Doc object, annotated for extracted terms.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds spans to document.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object, annotated for extracted terms.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="n">ents</span><span class="p">,</span> <span class="n">discarded</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="n">ents</span><span class="p">,</span> <span class="n">return_discarded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span>

    <span class="k">if</span> <span class="s2">&quot;discarded&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">discarded</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex._postprocessing_pipeline" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_postprocessing_pipeline</span><span class="p">(</span><span class="n">ents</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_postprocessing_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ents</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]):</span>
    <span class="c1"># add a window within the sentence around entities</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_window</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">]</span>

    <span class="c1"># Remove entities based on the snippet located just before and after the entity</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exclude_filter</span><span class="p">,</span> <span class="n">ents</span><span class="p">)</span>

    <span class="c1"># Extract informations from the entity&#39;s context via regex</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_snippet_extraction</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">ents</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex._add_window" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_add_window</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_add_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ent</span><span class="p">:</span> <span class="n">Span</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Span</span><span class="p">:</span>
    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">doc</span><span class="p">[</span>
        <span class="nb">max</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">sent</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="p">:</span> <span class="nb">min</span><span class="p">(</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">sent</span><span class="o">.</span><span class="n">end</span>
        <span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># include the entity in the snippets so that we can extract</span>
    <span class="c1"># the number when it is attached to the word, e.g. &quot;3PA&quot;</span>
    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">before_snippet</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">doc</span><span class="p">[</span>
        <span class="nb">max</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">sent</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="p">:</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span>
    <span class="p">]</span>
    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_snippet</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">doc</span><span class="p">[</span>
        <span class="n">ent</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span> <span class="n">ent</span><span class="o">.</span><span class="n">sent</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">ent</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex.get_text" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_text</span><span class="p">(</span><span class="n">span</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">span</span><span class="p">:</span> <span class="n">Span</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attr&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attr</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">get_text</span><span class="p">(</span>
        <span class="n">doclike</span><span class="o">=</span><span class="n">span</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex._exclude_filter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_exclude_filter</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_exclude_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ent</span><span class="p">:</span> <span class="n">Span</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Span</span><span class="p">:</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span>

    <span class="n">before_exclude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;before_exclude&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">after_exclude</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;after_exclude&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">before_exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">before_snippet</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">before_exclude</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;excluded (before) string: </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2"> - pattern </span><span class="si">{</span><span class="n">before_exclude</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">after_exclude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_snippet</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">after_exclude</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;excluded (after) string: </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2"> - pattern </span><span class="si">{</span><span class="n">after_exclude</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.core.advanced.advanced.AdvancedRegex._snippet_extraction" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_snippet_extraction</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_snippet_extraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ent</span><span class="p">:</span> <span class="n">Span</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Span</span><span class="p">:</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span>

    <span class="n">before_extract</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;before_extract&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">after_extract</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_config</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;after_extract&quot;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">before_extract</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">before_extract</span> <span class="o">=</span> <span class="p">[</span><span class="n">before_extract</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">after_extract</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">after_extract</span> <span class="o">=</span> <span class="p">[</span><span class="n">after_extract</span><span class="p">]</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">before_snippet</span>
    <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">before_extract</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">before_extract</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">before_extract</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">match</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_snippet</span>
    <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_extract</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">after_extract</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">after_extract</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">match</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ent</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.advanced.advanced._check_regex_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_check_regex_config</span><span class="p">(</span><span class="n">regex_config</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/advanced.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_check_regex_config</span><span class="p">(</span><span class="n">regex_config</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">regex_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The value of the key </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">, but a dict is expected&quot;</span>
            <span class="p">)</span>

        <span class="n">single_group_regex_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;before_extract&quot;</span><span class="p">,</span> <span class="s2">&quot;after_extract&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">single_group_regex_key</span> <span class="ow">in</span> <span class="n">single_group_regex_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">single_group_regex_key</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                <span class="c1"># ensure it is a list</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">single_group_regex_key</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">v</span><span class="p">[</span><span class="n">single_group_regex_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">single_group_regex_key</span><span class="p">]]</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">regex</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">single_group_regex_key</span><span class="p">]):</span>
                    <span class="n">n_groups</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span>

                    <span class="k">if</span> <span class="n">n_groups</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># Adding grouping parenthesis</span>
                        <span class="n">v</span><span class="p">[</span><span class="n">single_group_regex_key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="n">regex</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;)&quot;</span>
                    <span class="k">elif</span> <span class="n">n_groups</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="c1"># Accepting only 1 group per regex</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;The RegEx for </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span><span class="si">}</span><span class="s2">) &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;stored in </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">single_group_regex_key</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;contains </span><span class="si">{</span><span class="n">n_groups</span><span class="si">}</span><span class="s2"> capturing groups, 1 expected&quot;</span>
                        <span class="p">)</span>

    <span class="k">return</span> <span class="n">regex_config</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.core.advanced.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.core.advanced.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.core.advanced.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">regex_config</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/core/advanced/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span>
    <span class="s2">&quot;advanced-regex&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.advanced-regex&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span>
<span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.advanced-regex&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">regex_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>

    <span class="k">return</span> <span class="n">AdvancedRegex</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">regex_config</span><span class="o">=</span><span class="n">regex_config</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.pipelines.misc" class="doc doc-heading">
        <code>misc</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.misc.reason" class="doc doc-heading">
        <code>reason</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.reason.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.reason.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">reasons</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;TEXT&#39;</span><span class="p">,</span> <span class="n">use_sections</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.misc.reason.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">reasons</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">use_sections</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/reason/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;reason&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.reason&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.reason&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">reasons</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">use_sections</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Reason</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">reasons</span><span class="o">=</span><span class="n">reasons</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">use_sections</span><span class="o">=</span><span class="n">use_sections</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.reason.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.reason.patterns.reasons" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reasons</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">reasons</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;(?i)motif de l.?hospitalisation : .+&#39;</span><span class="p">,</span> <span class="s1">&#39;(?i)hospitalis[ée].?.*(pour|. cause|suite [àa]).+&#39;</span><span class="p">,</span> <span class="s1">&#39;(?i)(consulte|prise en charge(?!</span><span class="se">\\</span><span class="s1">set</span><span class="se">\\</span><span class="s1">svous</span><span class="se">\\</span><span class="s1">sassurer</span><span class="se">\\</span><span class="s1">sun</span><span class="se">\\</span><span class="s1">straitement</span><span class="se">\\</span><span class="s1">sadapté)).*pour.+&#39;</span><span class="p">,</span> <span class="s1">&#39;(?i)motif</span><span class="se">\\</span><span class="s1">sd.hospitalisation</span><span class="se">\\</span><span class="s1">s:.+&#39;</span><span class="p">,</span> <span class="s1">&#39;(?i)au total</span><span class="se">\\</span><span class="s1">s?</span><span class="se">\\</span><span class="s1">:?</span><span class="se">\\</span><span class="s1">s?</span><span class="se">\\</span><span class="s1">n?.+&#39;</span><span class="p">,</span> <span class="s1">&#39;(?i)motif</span><span class="se">\\</span><span class="s1">sde</span><span class="se">\\</span><span class="s1">sla</span><span class="se">\\</span><span class="s1">sconsultation&#39;</span><span class="p">,</span> <span class="s1">&#39;(?i)motif</span><span class="se">\\</span><span class="s1">sd.admission&#39;</span><span class="p">,</span> <span class="s1">&#39;(?i)conclusion</span><span class="se">\\</span><span class="s1">smedicale&#39;</span><span class="p">])</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.reason.patterns.sections_reason" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sections_reason</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;motif&#39;</span><span class="p">,</span> <span class="s1">&#39;conclusion&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.reason.patterns.section_exclude" class="doc doc-heading">
<code class="highlight language-python"><span class="n">section_exclude</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;antécédents&#39;</span><span class="p">,</span> <span class="s1">&#39;antécédents familiaux&#39;</span><span class="p">,</span> <span class="s1">&#39;histoire de la maladie&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.reason.reason" class="doc doc-heading">
        <code>reason</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.reason.reason.Reason" class="doc doc-heading">
          <code>Reason</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.core.matcher.GenericMatcher" href="../pipelines/core/matcher/matcher/#edsnlp.pipelines.core.matcher.matcher.GenericMatcher">GenericMatcher</a></code></p>


      <p>Pipeline to identify the reason of the hospitalisation.</p>
<p>It declares a Span extension called <code>ents_reason</code> and adds
the key <code>reasons</code> to doc.spans.</p>
<p>It also declares the boolean extension <code>is_reason</code>.
This extension is set to True for the Reason Spans but also
for the entities that overlap the reason span.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy nlp pipeline to use for matching.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>reasons</code></td>
          <td class="doc-param-details">
            <p>The terminology of reasons.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Dict[str, Union[List[str], str]]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>spaCy's attribute to use:
a string with the value "TEXT" or "NORM", or a dict with
the key 'term_attr'. We can also add a key for each regex.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>use_sections</code></td>
          <td class="doc-param-details">
            <p>whether or not use the <code>sections</code> pipeline to improve results.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool,</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether to skip excluded tokens.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/reason/reason.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Reason</span><span class="p">(</span><span class="n">GenericMatcher</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pipeline to identify the reason of the hospitalisation.</span>

<span class="sd">    It declares a Span extension called `ents_reason` and adds</span>
<span class="sd">    the key `reasons` to doc.spans.</span>

<span class="sd">    It also declares the boolean extension `is_reason`.</span>
<span class="sd">    This extension is set to True for the Reason Spans but also</span>
<span class="sd">    for the entities that overlap the reason span.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy nlp pipeline to use for matching.</span>
<span class="sd">    reasons : Optional[Dict[str, Union[List[str], str]]]</span>
<span class="sd">        The terminology of reasons.</span>
<span class="sd">    attr : str</span>
<span class="sd">        spaCy&#39;s attribute to use:</span>
<span class="sd">        a string with the value &quot;TEXT&quot; or &quot;NORM&quot;, or a dict with</span>
<span class="sd">        the key &#39;term_attr&#39;. We can also add a key for each regex.</span>
<span class="sd">    use_sections : bool,</span>
<span class="sd">        whether or not use the `sections` pipeline to improve results.</span>
<span class="sd">    ignore_excluded : bool</span>
<span class="sd">        Whether to skip excluded tokens.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">reasons</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]],</span>
        <span class="n">attr</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">use_sections</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="k">if</span> <span class="n">reasons</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reasons</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">reasons</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="p">,</span>
            <span class="n">terms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">regex</span><span class="o">=</span><span class="n">reasons</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_sections</span> <span class="o">=</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="s2">&quot;eds.sections&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span> <span class="ow">or</span> <span class="s2">&quot;sections&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_sections</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;You have requested that the pipeline use annotations &quot;</span>
                <span class="s2">&quot;provided by the `eds.section` pipeline, but it was not set. &quot;</span>
                <span class="s2">&quot;Skipping that step.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;ents_reason&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;ents_reason&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;is_reason&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;is_reason&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_enhance_with_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sections</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">reasons</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Enhance the list of reasons with the section information.</span>
<span class="sd">        If the reason overlaps with history, so it will be removed from the list</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sections : Iterable</span>
<span class="sd">            Spans of sections identified with the `sections` pipeline</span>
<span class="sd">        reasons : Iterable</span>
<span class="sd">            Reasons list identified by the regex</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List</span>
<span class="sd">            Updated list of spans reasons</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">label_</span> <span class="ow">in</span> <span class="n">patterns</span><span class="o">.</span><span class="n">sections_reason</span><span class="p">:</span>
                <span class="n">reasons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">label_</span> <span class="ow">in</span> <span class="n">patterns</span><span class="o">.</span><span class="n">section_exclude</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">reason</span> <span class="ow">in</span> <span class="n">reasons</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">reason</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">):</span>
                        <span class="n">reasons</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reason</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">reasons</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Find spans related to the reasons of the hospitalisation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc : Doc</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Doc</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="n">reasons</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;reasons&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_sections</span><span class="p">:</span>
            <span class="n">sections</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;sections&quot;</span><span class="p">]</span>
            <span class="n">reasons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enhance_with_sections</span><span class="p">(</span><span class="n">sections</span><span class="o">=</span><span class="n">sections</span><span class="p">,</span> <span class="n">reasons</span><span class="o">=</span><span class="n">reasons</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;reasons&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reasons</span>

        <span class="c1"># Entities</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">reason</span> <span class="ow">in</span> <span class="n">reasons</span><span class="p">:</span>  <span class="c1"># TODO optimize this iteration</span>
                <span class="n">ent_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">ent</span><span class="p">,</span> <span class="n">reason</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">reason</span><span class="o">.</span><span class="n">end</span><span class="p">):</span>
                        <span class="n">ent_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span>
                        <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">is_reason</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="n">reason</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">ents_reason</span> <span class="o">=</span> <span class="n">ent_list</span>
                <span class="n">reason</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">is_reason</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.reason.reason.Reason.use_sections" class="doc doc-heading">
<code class="highlight language-python"><span class="n">use_sections</span> <span class="o">=</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="s1">&#39;eds.sections&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span> <span class="ow">or</span> <span class="s1">&#39;sections&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.reason.reason.Reason.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">reasons</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">use_sections</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/reason/reason.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">reasons</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">use_sections</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="k">if</span> <span class="n">reasons</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">reasons</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">reasons</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">terms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">reasons</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">use_sections</span> <span class="o">=</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="s2">&quot;eds.sections&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span> <span class="ow">or</span> <span class="s2">&quot;sections&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_sections</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;You have requested that the pipeline use annotations &quot;</span>
            <span class="s2">&quot;provided by the `eds.section` pipeline, but it was not set. &quot;</span>
            <span class="s2">&quot;Skipping that step.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.reason.reason.Reason.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/reason/reason.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;ents_reason&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;ents_reason&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;is_reason&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;is_reason&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.reason.reason.Reason._enhance_with_sections" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_enhance_with_sections</span><span class="p">(</span><span class="n">sections</span><span class="p">,</span> <span class="n">reasons</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Enhance the list of reasons with the section information.
If the reason overlaps with history, so it will be removed from the list</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sections</code></td>
          <td class="doc-param-details">
            <p>Spans of sections identified with the <code>sections</code> pipeline</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Iterable</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>reasons</code></td>
          <td class="doc-param-details">
            <p>Reasons list identified by the regex</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Iterable</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Updated list of spans reasons</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/reason/reason.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_enhance_with_sections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sections</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">reasons</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Enhance the list of reasons with the section information.</span>
<span class="sd">    If the reason overlaps with history, so it will be removed from the list</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sections : Iterable</span>
<span class="sd">        Spans of sections identified with the `sections` pipeline</span>
<span class="sd">    reasons : Iterable</span>
<span class="sd">        Reasons list identified by the regex</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List</span>
<span class="sd">        Updated list of spans reasons</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">label_</span> <span class="ow">in</span> <span class="n">patterns</span><span class="o">.</span><span class="n">sections_reason</span><span class="p">:</span>
            <span class="n">reasons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">label_</span> <span class="ow">in</span> <span class="n">patterns</span><span class="o">.</span><span class="n">section_exclude</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">reason</span> <span class="ow">in</span> <span class="n">reasons</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">reason</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">):</span>
                    <span class="n">reasons</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">reason</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">reasons</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.reason.reason.Reason.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Find spans related to the reasons of the hospitalisation</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/reason/reason.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Find spans related to the reasons of the hospitalisation</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Doc</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="n">reasons</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;reasons&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_sections</span><span class="p">:</span>
        <span class="n">sections</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;sections&quot;</span><span class="p">]</span>
        <span class="n">reasons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enhance_with_sections</span><span class="p">(</span><span class="n">sections</span><span class="o">=</span><span class="n">sections</span><span class="p">,</span> <span class="n">reasons</span><span class="o">=</span><span class="n">reasons</span><span class="p">)</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;reasons&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reasons</span>

    <span class="c1"># Entities</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">reason</span> <span class="ow">in</span> <span class="n">reasons</span><span class="p">:</span>  <span class="c1"># TODO optimize this iteration</span>
            <span class="n">ent_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">ent</span><span class="p">,</span> <span class="n">reason</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">reason</span><span class="o">.</span><span class="n">end</span><span class="p">):</span>
                    <span class="n">ent_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent</span><span class="p">)</span>
                    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">is_reason</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">reason</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">ents_reason</span> <span class="o">=</span> <span class="n">ent_list</span>
            <span class="n">reason</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">is_reason</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.misc.consultation_dates" class="doc doc-heading">
        <code>consultation_dates</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.consultation_dates.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.consultation_dates.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">consultation_mention</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">town_mention</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">document_date_mention</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.misc.consultation_dates.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">consultation_mention</span><span class="p">,</span> <span class="n">town_mention</span><span class="p">,</span> <span class="n">document_date_mention</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/consultation_dates/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span>
    <span class="s2">&quot;consultation_dates&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eds.consultation_dates&quot;</span><span class="p">,</span>
    <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">,</span>
<span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.consultation_dates&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">consultation_mention</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
    <span class="n">town_mention</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
    <span class="n">document_date_mention</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">ConsultationDates</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">consultation_mention</span><span class="o">=</span><span class="n">consultation_mention</span><span class="p">,</span>
        <span class="n">document_date_mention</span><span class="o">=</span><span class="n">document_date_mention</span><span class="p">,</span>
        <span class="n">town_mention</span><span class="o">=</span><span class="n">town_mention</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.consultation_dates.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.consultation_dates.patterns.consultation_mention" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consultation_mention</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rendez-vous pris&#39;</span><span class="p">,</span> <span class="s1">&#39;consultation&#39;</span><span class="p">,</span> <span class="s1">&#39;consultation.{1,8}examen&#39;</span><span class="p">,</span> <span class="s1">&#39;examen clinique&#39;</span><span class="p">,</span> <span class="s1">&#39;de compte rendu&#39;</span><span class="p">,</span> <span class="s2">&quot;date de l&#39;examen&quot;</span><span class="p">,</span> <span class="s1">&#39;examen realise le&#39;</span><span class="p">,</span> <span class="s1">&#39;date de la visite&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.consultation_dates.patterns.town_mention" class="doc doc-heading">
<code class="highlight language-python"><span class="n">town_mention</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;paris&#39;</span><span class="p">,</span> <span class="s1">&#39;kremlin.bicetre&#39;</span><span class="p">,</span> <span class="s1">&#39;creteil&#39;</span><span class="p">,</span> <span class="s1">&#39;boulogne.billancourt&#39;</span><span class="p">,</span> <span class="s1">&#39;villejuif&#39;</span><span class="p">,</span> <span class="s1">&#39;clamart&#39;</span><span class="p">,</span> <span class="s1">&#39;bobigny&#39;</span><span class="p">,</span> <span class="s1">&#39;clichy&#39;</span><span class="p">,</span> <span class="s1">&#39;ivry.sur.seine&#39;</span><span class="p">,</span> <span class="s1">&#39;issy.les.moulineaux&#39;</span><span class="p">,</span> <span class="s1">&#39;draveil&#39;</span><span class="p">,</span> <span class="s1">&#39;limeil&#39;</span><span class="p">,</span> <span class="s1">&#39;champcueil&#39;</span><span class="p">,</span> <span class="s1">&#39;roche.guyon&#39;</span><span class="p">,</span> <span class="s1">&#39;bondy&#39;</span><span class="p">,</span> <span class="s1">&#39;colombes&#39;</span><span class="p">,</span> <span class="s1">&#39;hendaye&#39;</span><span class="p">,</span> <span class="s1">&#39;herck.sur.mer&#39;</span><span class="p">,</span> <span class="s1">&#39;labruyere&#39;</span><span class="p">,</span> <span class="s1">&#39;garches&#39;</span><span class="p">,</span> <span class="s1">&#39;sevran&#39;</span><span class="p">,</span> <span class="s1">&#39;hyeres&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.consultation_dates.patterns.document_date_mention" class="doc doc-heading">
<code class="highlight language-python"><span class="n">document_date_mention</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;imprime le&#39;</span><span class="p">,</span> <span class="s1">&#39;signe electroniquement&#39;</span><span class="p">,</span> <span class="s1">&#39;signe le&#39;</span><span class="p">,</span> <span class="s1">&#39;saisi le&#39;</span><span class="p">,</span> <span class="s1">&#39;dicte le&#39;</span><span class="p">,</span> <span class="s1">&#39;tape le&#39;</span><span class="p">,</span> <span class="s1">&#39;date de reference&#39;</span><span class="p">,</span> <span class="s1">&#39;date</span><span class="se">\\</span><span class="s1">s*:&#39;</span><span class="p">,</span> <span class="s1">&#39;dactylographie le&#39;</span><span class="p">,</span> <span class="s1">&#39;date du rapport&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.consultation_dates.consultation_dates" class="doc doc-heading">
        <code>consultation_dates</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.consultation_dates.consultation_dates.ConsultationDates" class="doc doc-heading">
          <code>ConsultationDates</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.core.matcher.GenericMatcher" href="../pipelines/core/matcher/matcher/#edsnlp.pipelines.core.matcher.matcher.GenericMatcher">GenericMatcher</a></code></p>


      <p>Class to extract consultation dates from "CR-CONS" documents.</p>
<p>The pipeline populates the <code class="highlight"><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s1">&#39;consultation_dates&#39;</span><span class="p">]</span></code> list.</p>
<p>For each extraction <code>s</code> in this list, the corresponding date is available
as <code>s._.consultation_date</code>.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>Language pipeline object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>consultation_mention</code></td>
          <td class="doc-param-details">
            <p>List of RegEx for consultation mentions.</p>
<ul>
<li>If <code>type==list</code>: Overrides the default list</li>
<li>If <code>type==bool</code>: Uses the default list of True, disable if False</li>
</ul>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[List[str], bool]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>
      <p>town_mention : Union[List[str], bool]
    List of RegEx for all AP-HP hospitals' towns mentions.</p>
<div class="highlight"><pre><span></span><code>- If `type==list`: Overrides the default list
- If `type==bool`: Uses the default list of True, disable if False
</code></pre></div>
<p>document_date_mention : Union[List[str], bool]
    List of RegEx for document date.</p>
<div class="highlight"><pre><span></span><code>- If `type==list`: Overrides the default list
- If `type==bool`: Uses the default list of True, disable if False
</code></pre></div>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/consultation_dates/consultation_dates.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ConsultationDates</span><span class="p">(</span><span class="n">GenericMatcher</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to extract consultation dates from &quot;CR-CONS&quot; documents.</span>

<span class="sd">    The pipeline populates the `#!python doc.spans[&#39;consultation_dates&#39;]` list.</span>

<span class="sd">    For each extraction `s` in this list, the corresponding date is available</span>
<span class="sd">    as `s._.consultation_date`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        Language pipeline object</span>
<span class="sd">    consultation_mention : Union[List[str], bool]</span>
<span class="sd">        List of RegEx for consultation mentions.</span>

<span class="sd">        - If `type==list`: Overrides the default list</span>
<span class="sd">        - If `type==bool`: Uses the default list of True, disable if False</span>

<span class="sd">    town_mention : Union[List[str], bool]</span>
<span class="sd">        List of RegEx for all AP-HP hospitals&#39; towns mentions.</span>

<span class="sd">        - If `type==list`: Overrides the default list</span>
<span class="sd">        - If `type==bool`: Uses the default list of True, disable if False</span>
<span class="sd">    document_date_mention : Union[List[str], bool]</span>
<span class="sd">        List of RegEx for document date.</span>

<span class="sd">        - If `type==list`: Overrides the default list</span>
<span class="sd">        - If `type==bool`: Uses the default list of True, disable if False</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">consultation_mention</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
        <span class="n">town_mention</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
        <span class="n">document_date_mention</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;This pipeline is still in beta&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;This pipeline should ONLY be used on notes &quot;</span>
            <span class="s2">&quot;where `note_class_source_value == &#39;CR-CONS&#39;`&quot;</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;This pipeline requires to use the normalizer pipeline with:</span>
<span class="sd">        lowercase=True,</span>
<span class="sd">        accents=True,</span>
<span class="sd">        quotes=True&quot;&quot;&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nlp</span><span class="o">.</span><span class="n">has_pipe</span><span class="p">(</span><span class="s2">&quot;dates&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">nlp</span><span class="o">.</span><span class="n">get_pipe</span><span class="p">(</span><span class="s2">&quot;dates&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">):</span>

            <span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
            <span class="n">config</span><span class="p">[</span><span class="s2">&quot;on_ents_only&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;consultation_mentions&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">date_matcher</span> <span class="o">=</span> <span class="n">Dates</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date_matcher</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">consultation_mention</span><span class="p">:</span>
            <span class="n">consultation_mention</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="n">consultation_mention</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">consultation_mention</span> <span class="o">=</span> <span class="n">consult_regex</span><span class="o">.</span><span class="n">consultation_mention</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">document_date_mention</span><span class="p">:</span>
            <span class="n">document_date_mention</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="n">document_date_mention</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">document_date_mention</span> <span class="o">=</span> <span class="n">consult_regex</span><span class="o">.</span><span class="n">document_date_mention</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">town_mention</span><span class="p">:</span>
            <span class="n">town_mention</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="n">town_mention</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">town_mention</span> <span class="o">=</span> <span class="n">consult_regex</span><span class="o">.</span><span class="n">town_mention</span>

        <span class="n">regex</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">consultation_mention</span><span class="o">=</span><span class="n">consultation_mention</span><span class="p">,</span>
            <span class="n">town_mention</span><span class="o">=</span><span class="n">town_mention</span><span class="p">,</span>
            <span class="n">document_date_mention</span><span class="o">=</span><span class="n">document_date_mention</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="p">,</span>
            <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
            <span class="n">terms</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;consultation_date&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;consultation_date&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds entities</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc: spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc: Doc</span>
<span class="sd">            spaCy Doc object with additional</span>
<span class="sd">            `doc.spans[&#39;consultation_dates]` `SpanGroup`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;consultation_mentions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ents</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;consultation_dates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_matcher</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">mention</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
            <span class="c1"># Looking for a date</span>
            <span class="c1"># - In the same sentence</span>
            <span class="c1"># - Not less than 10 tokens AFTER the consultation mention</span>
            <span class="n">matching_dates</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">date</span>
                <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;dates&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">mention</span><span class="o">.</span><span class="n">sent</span> <span class="o">==</span> <span class="n">date</span><span class="o">.</span><span class="n">sent</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">mention</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">mention</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">]</span>

            <span class="k">if</span> <span class="n">matching_dates</span><span class="p">:</span>
                <span class="c1"># We keep the first mention of a date</span>
                <span class="n">kept_date</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">matching_dates</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
                <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">mention</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="n">kept_date</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
                <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="o">=</span> <span class="n">mention</span><span class="o">.</span><span class="n">label_</span>
                <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">consultation_date</span> <span class="o">=</span> <span class="n">kept_date</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span>

                <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;consultation_dates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

        <span class="k">del</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;consultation_mentions&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.consultation_dates.consultation_dates.ConsultationDates.date_matcher" class="doc doc-heading">
<code class="highlight language-python"><span class="n">date_matcher</span> <span class="o">=</span> <span class="n">Dates</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="kc">None</span><span class="o">=</span><span class="n">config</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.consultation_dates.consultation_dates.ConsultationDates.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">consultation_mention</span><span class="p">,</span> <span class="n">town_mention</span><span class="p">,</span> <span class="n">document_date_mention</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/consultation_dates/consultation_dates.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">consultation_mention</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
    <span class="n">town_mention</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
    <span class="n">document_date_mention</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">bool</span><span class="p">],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;This pipeline is still in beta&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
        <span class="s2">&quot;This pipeline should ONLY be used on notes &quot;</span>
        <span class="s2">&quot;where `note_class_source_value == &#39;CR-CONS&#39;`&quot;</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
        <span class="sd">&quot;&quot;&quot;This pipeline requires to use the normalizer pipeline with:</span>
<span class="sd">    lowercase=True,</span>
<span class="sd">    accents=True,</span>
<span class="sd">    quotes=True&quot;&quot;&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nlp</span><span class="o">.</span><span class="n">has_pipe</span><span class="p">(</span><span class="s2">&quot;dates&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">nlp</span><span class="o">.</span><span class="n">get_pipe</span><span class="p">(</span><span class="s2">&quot;dates&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">):</span>

        <span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
        <span class="n">config</span><span class="p">[</span><span class="s2">&quot;on_ents_only&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;consultation_mentions&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">date_matcher</span> <span class="o">=</span> <span class="n">Dates</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="o">**</span><span class="n">config</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_matcher</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">consultation_mention</span><span class="p">:</span>
        <span class="n">consultation_mention</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="n">consultation_mention</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">consultation_mention</span> <span class="o">=</span> <span class="n">consult_regex</span><span class="o">.</span><span class="n">consultation_mention</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">document_date_mention</span><span class="p">:</span>
        <span class="n">document_date_mention</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="n">document_date_mention</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">document_date_mention</span> <span class="o">=</span> <span class="n">consult_regex</span><span class="o">.</span><span class="n">document_date_mention</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">town_mention</span><span class="p">:</span>
        <span class="n">town_mention</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="n">town_mention</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">town_mention</span> <span class="o">=</span> <span class="n">consult_regex</span><span class="o">.</span><span class="n">town_mention</span>

    <span class="n">regex</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">consultation_mention</span><span class="o">=</span><span class="n">consultation_mention</span><span class="p">,</span>
        <span class="n">town_mention</span><span class="o">=</span><span class="n">town_mention</span><span class="p">,</span>
        <span class="n">document_date_mention</span><span class="o">=</span><span class="n">document_date_mention</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">regex</span><span class="p">,</span>
        <span class="n">terms</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.consultation_dates.consultation_dates.ConsultationDates.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/consultation_dates/consultation_dates.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;consultation_date&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;consultation_date&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.consultation_dates.consultation_dates.ConsultationDates.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Finds entities</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>spaCy Doc object with additional
<code>doc.spans['consultation_dates]</code> <code>SpanGroup</code></p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/consultation_dates/consultation_dates.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds entities</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc: spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc: Doc</span>
<span class="sd">        spaCy Doc object with additional</span>
<span class="sd">        `doc.spans[&#39;consultation_dates]` `SpanGroup`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;consultation_mentions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ents</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;consultation_dates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_matcher</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">mention</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
        <span class="c1"># Looking for a date</span>
        <span class="c1"># - In the same sentence</span>
        <span class="c1"># - Not less than 10 tokens AFTER the consultation mention</span>
        <span class="n">matching_dates</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">date</span>
            <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;dates&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">mention</span><span class="o">.</span><span class="n">sent</span> <span class="o">==</span> <span class="n">date</span><span class="o">.</span><span class="n">sent</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">mention</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">mention</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="n">matching_dates</span><span class="p">:</span>
            <span class="c1"># We keep the first mention of a date</span>
            <span class="n">kept_date</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">matching_dates</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">start</span><span class="p">)</span>
            <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">mention</span><span class="o">.</span><span class="n">start</span> <span class="p">:</span> <span class="n">kept_date</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
            <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="o">=</span> <span class="n">mention</span><span class="o">.</span><span class="n">label_</span>
            <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">consultation_date</span> <span class="o">=</span> <span class="n">kept_date</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span>

            <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;consultation_dates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

    <span class="k">del</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;consultation_mentions&quot;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.misc.sections" class="doc doc-heading">
        <code>sections</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.sections.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sections</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">add_patterns</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.misc.sections.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">sections</span><span class="p">,</span> <span class="n">add_patterns</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/sections/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;sections&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.sections&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.sections&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sections</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span>
    <span class="n">add_patterns</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Sections</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">sections</span><span class="o">=</span><span class="n">sections</span><span class="p">,</span>
        <span class="n">add_patterns</span><span class="o">=</span><span class="n">add_patterns</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.sections.sections" class="doc doc-heading">
        <code>sections</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.sections.sections.Sections" class="doc doc-heading">
          <code>Sections</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.core.matcher.GenericMatcher" href="../pipelines/core/matcher/matcher/#edsnlp.pipelines.core.matcher.matcher.GenericMatcher">GenericMatcher</a></code></p>


      <p>Divides the document into sections.</p>
<p>By default, we are using a dataset of documents annotated for section titles,
using the work done by Ivan Lerner, reviewed by Gilles Chatellier.</p>
<p>Detected sections are :</p>
<ul>
<li>allergies ;</li>
<li>antécédents ;</li>
<li>antécédents familiaux ;</li>
<li>traitements entrée ;</li>
<li>conclusion ;</li>
<li>conclusion entrée ;</li>
<li>habitus ;</li>
<li>correspondants ;</li>
<li>diagnostic ;</li>
<li>données biométriques entrée ;</li>
<li>examens ;</li>
<li>examens complémentaires ;</li>
<li>facteurs de risques ;</li>
<li>histoire de la maladie ;</li>
<li>actes ;</li>
<li>motif ;</li>
<li>prescriptions ;</li>
<li>traitements sortie.</li>
</ul>
<p>The component looks for section titles within the document,
and stores them in the <code>section_title</code> extension.</p>
<p>For ease-of-use, the component also populates a <code>section</code> extension,
which contains a list of spans corresponding to the "sections" of the
document. These span from the start of one section title to the next,
which can introduce obvious bias should an intermediate section title
goes undetected.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy pipeline object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>sections</code></td>
          <td class="doc-param-details">
            <p>Dictionary of terms to look for.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Dict[str, List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>Default attribute to match on.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether to skip excluded tokens.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/sections/sections.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Sections</span><span class="p">(</span><span class="n">GenericMatcher</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Divides the document into sections.</span>

<span class="sd">    By default, we are using a dataset of documents annotated for section titles,</span>
<span class="sd">    using the work done by Ivan Lerner, reviewed by Gilles Chatellier.</span>

<span class="sd">    Detected sections are :</span>

<span class="sd">    - allergies ;</span>
<span class="sd">    - antécédents ;</span>
<span class="sd">    - antécédents familiaux ;</span>
<span class="sd">    - traitements entrée ;</span>
<span class="sd">    - conclusion ;</span>
<span class="sd">    - conclusion entrée ;</span>
<span class="sd">    - habitus ;</span>
<span class="sd">    - correspondants ;</span>
<span class="sd">    - diagnostic ;</span>
<span class="sd">    - données biométriques entrée ;</span>
<span class="sd">    - examens ;</span>
<span class="sd">    - examens complémentaires ;</span>
<span class="sd">    - facteurs de risques ;</span>
<span class="sd">    - histoire de la maladie ;</span>
<span class="sd">    - actes ;</span>
<span class="sd">    - motif ;</span>
<span class="sd">    - prescriptions ;</span>
<span class="sd">    - traitements sortie.</span>

<span class="sd">    The component looks for section titles within the document,</span>
<span class="sd">    and stores them in the `section_title` extension.</span>

<span class="sd">    For ease-of-use, the component also populates a `section` extension,</span>
<span class="sd">    which contains a list of spans corresponding to the &quot;sections&quot; of the</span>
<span class="sd">    document. These span from the start of one section title to the next,</span>
<span class="sd">    which can introduce obvious bias should an intermediate section title</span>
<span class="sd">    goes undetected.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy pipeline object.</span>
<span class="sd">    sections : Dict[str, List[str]]</span>
<span class="sd">        Dictionary of terms to look for.</span>
<span class="sd">    attr : str</span>
<span class="sd">        Default attribute to match on.</span>
<span class="sd">    ignore_excluded : bool</span>
<span class="sd">        Whether to skip excluded tokens.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">sections</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">add_patterns</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;The component Sections is still in Beta. Use at your own risks.&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">sections</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sections</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">sections</span>
        <span class="n">sections</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sections</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_patterns</span> <span class="o">=</span> <span class="n">add_patterns</span>
        <span class="k">if</span> <span class="n">add_patterns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">sections</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;\n[^\n]{0,5}&quot;</span> <span class="o">+</span> <span class="n">ent</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;[^\n]{0,5}\n&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="p">,</span>
            <span class="n">terms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">regex</span><span class="o">=</span><span class="n">sections</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">nlp</span><span class="o">.</span><span class="n">has_pipe</span><span class="p">(</span><span class="s2">&quot;normalizer&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="ow">not</span> <span class="n">nlp</span><span class="o">.</span><span class="n">has_pipe</span><span class="p">(</span><span class="s2">&quot;eds.normalizer&quot;</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;You should add pipe `eds.normalizer`&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">():</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;section_title&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;section_title&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="c1"># noinspection PyProtectedMember</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Divides the doc into sections</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object, annotated for sections</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_patterns</span><span class="p">:</span>
            <span class="c1"># Remove preceding newline</span>
            <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">title</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">titles</span>
            <span class="p">]</span>

        <span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">titles</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">titles</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="n">section</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">t2</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">t1</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
            <span class="n">section</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section_title</span> <span class="o">=</span> <span class="n">t1</span>
            <span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">titles</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">titles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">section</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
            <span class="n">section</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section_title</span> <span class="o">=</span> <span class="n">t</span>
            <span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;sections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sections</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;section_titles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">titles</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.sections.sections.Sections.add_patterns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add_patterns</span> <span class="o">=</span> <span class="n">add_patterns</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.sections.sections.Sections.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">sections</span><span class="p">,</span> <span class="n">add_patterns</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/sections/sections.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">sections</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">add_patterns</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
        <span class="s2">&quot;The component Sections is still in Beta. Use at your own risks.&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">sections</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sections</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">sections</span>
    <span class="n">sections</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sections</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">add_patterns</span> <span class="o">=</span> <span class="n">add_patterns</span>
    <span class="k">if</span> <span class="n">add_patterns</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">sections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">sections</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;\n[^\n]{0,5}&quot;</span> <span class="o">+</span> <span class="n">ent</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;[^\n]{0,5}\n&quot;</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">terms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">regex</span><span class="o">=</span><span class="n">sections</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">nlp</span><span class="o">.</span><span class="n">has_pipe</span><span class="p">(</span><span class="s2">&quot;normalizer&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="ow">not</span> <span class="n">nlp</span><span class="o">.</span><span class="n">has_pipe</span><span class="p">(</span><span class="s2">&quot;eds.normalizer&quot;</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;You should add pipe `eds.normalizer`&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.sections.sections.Sections.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/sections/sections.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">():</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;section_title&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;section_title&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.sections.sections.Sections.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Divides the doc into sections</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>spaCy Doc object, annotated for sections</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/sections/sections.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Divides the doc into sections</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object, annotated for sections</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_patterns</span><span class="p">:</span>
        <span class="c1"># Remove preceding newline</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">title</span><span class="o">.</span><span class="n">label_</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">titles</span>
        <span class="p">]</span>

    <span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">titles</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">titles</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="n">section</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">t1</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">t2</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">t1</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="n">section</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section_title</span> <span class="o">=</span> <span class="n">t1</span>
        <span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">titles</span><span class="p">:</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">titles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">section</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="n">section</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">section_title</span> <span class="o">=</span> <span class="n">t</span>
        <span class="n">sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;sections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sections</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;section_titles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">titles</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.sections.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">

      <p>These section titles were extracted from a work performed by Ivan Lerner at AP-HP.
It supplied a number of documents annotated for section titles.</p>
<p>The section titles were reviewed by Gilles Chatellier, who gave meaningful insights.</p>
<p>See sections/section-dataset notebook for detail.</p>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.allergies" class="doc doc-heading">
<code class="highlight language-python"><span class="n">allergies</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;allergies&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.antecedents" class="doc doc-heading">
<code class="highlight language-python"><span class="n">antecedents</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;antecedents&#39;</span><span class="p">,</span> <span class="s1">&#39;antecedents medicaux et chirurgicaux&#39;</span><span class="p">,</span> <span class="s1">&#39;antecedents personnels&#39;</span><span class="p">,</span> <span class="s1">&#39;antecedents medicaux&#39;</span><span class="p">,</span> <span class="s1">&#39;antecedents chirurgicaux&#39;</span><span class="p">,</span> <span class="s1">&#39;atcd&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.antecedents_familiaux" class="doc doc-heading">
<code class="highlight language-python"><span class="n">antecedents_familiaux</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;antecedents familiaux&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.traitements_entree" class="doc doc-heading">
<code class="highlight language-python"><span class="n">traitements_entree</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;attitude therapeutique initiale&#39;</span><span class="p">,</span> <span class="s2">&quot;traitement a l&#39;entree&quot;</span><span class="p">,</span> <span class="s1">&#39;traitement actuel&#39;</span><span class="p">,</span> <span class="s1">&#39;traitement en cours&#39;</span><span class="p">,</span> <span class="s2">&quot;traitements a l&#39;entree&quot;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.conclusion" class="doc doc-heading">
<code class="highlight language-python"><span class="n">conclusion</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;au total&#39;</span><span class="p">,</span> <span class="s1">&#39;conclusion&#39;</span><span class="p">,</span> <span class="s1">&#39;conclusion de sortie&#39;</span><span class="p">,</span> <span class="s1">&#39;syntese medicale / conclusion&#39;</span><span class="p">,</span> <span class="s1">&#39;synthese&#39;</span><span class="p">,</span> <span class="s1">&#39;synthese medicale&#39;</span><span class="p">,</span> <span class="s1">&#39;synthese medicale/conclusion&#39;</span><span class="p">,</span> <span class="s1">&#39;conclusion medicale&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.conclusion_entree" class="doc doc-heading">
<code class="highlight language-python"><span class="n">conclusion_entree</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;conclusion a l&#39;entree&quot;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.habitus" class="doc doc-heading">
<code class="highlight language-python"><span class="n">habitus</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;contexte familial et social&#39;</span><span class="p">,</span> <span class="s1">&#39;habitus&#39;</span><span class="p">,</span> <span class="s1">&#39;mode de vie&#39;</span><span class="p">,</span> <span class="s1">&#39;mode de vie - scolarite&#39;</span><span class="p">,</span> <span class="s1">&#39;situation sociale, mode de vie&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.correspondants" class="doc doc-heading">
<code class="highlight language-python"><span class="n">correspondants</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;correspondants&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.diagnostic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">diagnostic</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;diagnostic retenu&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.donnees_biometriques_entree" class="doc doc-heading">
<code class="highlight language-python"><span class="n">donnees_biometriques_entree</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;donnees biometriques et parametres vitaux a l&#39;entree&quot;</span><span class="p">,</span> <span class="s2">&quot;parametres vitaux et donnees biometriques a l&#39;entree&quot;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.examens" class="doc doc-heading">
<code class="highlight language-python"><span class="n">examens</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;examen clinique&#39;</span><span class="p">,</span> <span class="s2">&quot;examen clinique a l&#39;entree&quot;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.examens_complementaires" class="doc doc-heading">
<code class="highlight language-python"><span class="n">examens_complementaires</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;examen(s) complementaire(s)&#39;</span><span class="p">,</span> <span class="s1">&#39;examens complementaires&#39;</span><span class="p">,</span> <span class="s2">&quot;examens complementaires a l&#39;entree&quot;</span><span class="p">,</span> <span class="s1">&#39;examens complementaires realises pendant le sejour&#39;</span><span class="p">,</span> <span class="s1">&#39;examens para-cliniques&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.facteurs_de_risques" class="doc doc-heading">
<code class="highlight language-python"><span class="n">facteurs_de_risques</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;facteurs de risque&#39;</span><span class="p">,</span> <span class="s1">&#39;facteurs de risques&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.histoire_de_la_maladie" class="doc doc-heading">
<code class="highlight language-python"><span class="n">histoire_de_la_maladie</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;histoire de la maladie&#39;</span><span class="p">,</span> <span class="s1">&#39;histoire de la maladie - explorations&#39;</span><span class="p">,</span> <span class="s1">&#39;histoire de la maladie actuelle&#39;</span><span class="p">,</span> <span class="s1">&#39;histoire du poids&#39;</span><span class="p">,</span> <span class="s1">&#39;histoire recente&#39;</span><span class="p">,</span> <span class="s1">&#39;histoire recente de la maladie&#39;</span><span class="p">,</span> <span class="s1">&#39;rappel clinique&#39;</span><span class="p">,</span> <span class="s1">&#39;resume&#39;</span><span class="p">,</span> <span class="s1">&#39;resume clinique&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.actes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">actes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;intervention&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.motif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">motif</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;motif&#39;</span><span class="p">,</span> <span class="s2">&quot;motif d&#39;hospitalisation&quot;</span><span class="p">,</span> <span class="s2">&quot;motif de l&#39;hospitalisation&quot;</span><span class="p">,</span> <span class="s1">&#39;motif medical&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.prescriptions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prescriptions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;prescriptions de sortie&#39;</span><span class="p">,</span> <span class="s1">&#39;prescriptions medicales de sortie&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.traitements_sortie" class="doc doc-heading">
<code class="highlight language-python"><span class="n">traitements_sortie</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;traitement de sortie&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.sections.patterns.sections" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sections</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;allergies&#39;</span><span class="p">:</span> <span class="n">allergies</span><span class="p">,</span> <span class="s1">&#39;antécédents&#39;</span><span class="p">:</span> <span class="n">antecedents</span><span class="p">,</span> <span class="s1">&#39;antécédents familiaux&#39;</span><span class="p">:</span> <span class="n">antecedents_familiaux</span><span class="p">,</span> <span class="s1">&#39;traitements entrée&#39;</span><span class="p">:</span> <span class="n">traitements_entree</span><span class="p">,</span> <span class="s1">&#39;conclusion&#39;</span><span class="p">:</span> <span class="n">conclusion</span><span class="p">,</span> <span class="s1">&#39;conclusion entrée&#39;</span><span class="p">:</span> <span class="n">conclusion_entree</span><span class="p">,</span> <span class="s1">&#39;habitus&#39;</span><span class="p">:</span> <span class="n">habitus</span><span class="p">,</span> <span class="s1">&#39;correspondants&#39;</span><span class="p">:</span> <span class="n">correspondants</span><span class="p">,</span> <span class="s1">&#39;diagnostic&#39;</span><span class="p">:</span> <span class="n">diagnostic</span><span class="p">,</span> <span class="s1">&#39;données biométriques entrée&#39;</span><span class="p">:</span> <span class="n">donnees_biometriques_entree</span><span class="p">,</span> <span class="s1">&#39;examens&#39;</span><span class="p">:</span> <span class="n">examens</span><span class="p">,</span> <span class="s1">&#39;examens complémentaires&#39;</span><span class="p">:</span> <span class="n">examens_complementaires</span><span class="p">,</span> <span class="s1">&#39;facteurs de risques&#39;</span><span class="p">:</span> <span class="n">facteurs_de_risques</span><span class="p">,</span> <span class="s1">&#39;histoire de la maladie&#39;</span><span class="p">:</span> <span class="n">histoire_de_la_maladie</span><span class="p">,</span> <span class="s1">&#39;actes&#39;</span><span class="p">:</span> <span class="n">actes</span><span class="p">,</span> <span class="s1">&#39;motif&#39;</span><span class="p">:</span> <span class="n">motif</span><span class="p">,</span> <span class="s1">&#39;prescriptions&#39;</span><span class="p">:</span> <span class="n">prescriptions</span><span class="p">,</span> <span class="s1">&#39;traitements sortie&#39;</span><span class="p">:</span> <span class="n">traitements_sortie</span><span class="p">}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.misc.dates" class="doc doc-heading">
        <code>dates</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.dates.dates" class="doc doc-heading">
        <code>dates</code>



</h6>

    <div class="doc doc-contents ">

      <p><code>eds.dates</code> pipeline.</p>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.dates.dates.PERIOD_PROXIMITY_THRESHOLD" class="doc doc-heading">
<code class="highlight language-python"><span class="n">PERIOD_PROXIMITY_THRESHOLD</span> <span class="o">=</span> <span class="mi">3</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.dates.dates.Dates" class="doc doc-heading">
          <code>Dates</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.base.BaseComponent" href="pipelines/base/#edsnlp.pipelines.base.BaseComponent">BaseComponent</a></code></p>


      <p>Tags and normalizes dates, using the open-source <code>dateparser</code> library.</p>
<p>The pipeline uses spaCy's <code>filter_spans</code> function.
It filters out false positives, and introduce a hierarchy between patterns.
For instance, in case of ambiguity, the pipeline will decide that a date is a
date without a year rather than a date without a day.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>Language pipeline object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>spacy.language.Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>absolute</code></td>
          <td class="doc-param-details">
            <p>List of regular expressions for absolute dates.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[List[str], str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>relative</code></td>
          <td class="doc-param-details">
            <p>List of regular expressions for relative dates
(eg <code>hier</code>, <code>la semaine prochaine</code>).</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[List[str], str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>duration</code></td>
          <td class="doc-param-details">
            <p>List of regular expressions for durations
(eg <code>pendant trois mois</code>).</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[List[str], str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>false_positive</code></td>
          <td class="doc-param-details">
            <p>List of regular expressions for false positive (eg phone numbers, etc).</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[List[str], str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>on_ents_only</code></td>
          <td class="doc-param-details">
            <p>Wether to look on dates in the whole document or in specific sentences:</p>
<ul>
<li>If <code>True</code>: Only look in the sentences of each entity in doc.ents</li>
<li>If False: Look in the whole document</li>
<li>If given a string <code>key</code> or list of string: Only look in the sentences of
each entity in <code class="highlight"><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">key</span><span class="p">]</span></code></li>
</ul>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[bool, str, List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>detect_periods</code></td>
          <td class="doc-param-details">
            <p>Wether to detect periods (experimental)</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>spaCy attribute to use</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/dates/dates.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Dates</span><span class="p">(</span><span class="n">BaseComponent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tags and normalizes dates, using the open-source `dateparser` library.</span>

<span class="sd">    The pipeline uses spaCy&#39;s `filter_spans` function.</span>
<span class="sd">    It filters out false positives, and introduce a hierarchy between patterns.</span>
<span class="sd">    For instance, in case of ambiguity, the pipeline will decide that a date is a</span>
<span class="sd">    date without a year rather than a date without a day.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : spacy.language.Language</span>
<span class="sd">        Language pipeline object</span>
<span class="sd">    absolute : Union[List[str], str]</span>
<span class="sd">        List of regular expressions for absolute dates.</span>
<span class="sd">    relative : Union[List[str], str]</span>
<span class="sd">        List of regular expressions for relative dates</span>
<span class="sd">        (eg `hier`, `la semaine prochaine`).</span>
<span class="sd">    duration : Union[List[str], str]</span>
<span class="sd">        List of regular expressions for durations</span>
<span class="sd">        (eg `pendant trois mois`).</span>
<span class="sd">    false_positive : Union[List[str], str]</span>
<span class="sd">        List of regular expressions for false positive (eg phone numbers, etc).</span>
<span class="sd">    on_ents_only : Union[bool, str, List[str]]</span>
<span class="sd">        Wether to look on dates in the whole document or in specific sentences:</span>

<span class="sd">        - If `True`: Only look in the sentences of each entity in doc.ents</span>
<span class="sd">        - If False: Look in the whole document</span>
<span class="sd">        - If given a string `key` or list of string: Only look in the sentences of</span>
<span class="sd">          each entity in `#!python doc.spans[key]`</span>
<span class="sd">    detect_periods : bool</span>
<span class="sd">        Wether to detect periods (experimental)</span>
<span class="sd">    attr : str</span>
<span class="sd">        spaCy attribute to use</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># noinspection PyProtectedMember</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">absolute</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">relative</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">false_positive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">on_ents_only</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">detect_periods</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>

        <span class="k">if</span> <span class="n">absolute</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">absolute</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">absolute_pattern</span>
        <span class="k">if</span> <span class="n">relative</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">relative</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">relative_pattern</span>
        <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">duration_pattern</span>
        <span class="k">if</span> <span class="n">false_positive</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">false_positive</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">false_positive_pattern</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">absolute</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">absolute</span> <span class="o">=</span> <span class="p">[</span><span class="n">absolute</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">relative</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">relative</span> <span class="o">=</span> <span class="p">[</span><span class="n">relative</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">relative</span> <span class="o">=</span> <span class="p">[</span><span class="n">duration</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">false_positive</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">false_positive</span> <span class="o">=</span> <span class="p">[</span><span class="n">false_positive</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="o">=</span> <span class="n">on_ents_only</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="o">=</span><span class="s2">&quot;strict&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;false_positive&quot;</span><span class="p">,</span> <span class="n">false_positive</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span> <span class="n">absolute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;relative&quot;</span><span class="p">,</span> <span class="n">relative</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">detect_periods</span> <span class="o">=</span> <span class="n">detect_periods</span>

        <span class="k">if</span> <span class="n">detect_periods</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The period extractor is experimental.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set extensions for the dates pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find dates in doc.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dates:</span>
<span class="sd">            list of date spans</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
                <span class="n">ents</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">]</span>
                <span class="n">ents</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
                    <span class="n">ents</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>

            <span class="n">dates</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="n">ent</span><span class="o">.</span><span class="n">sent</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">]):</span>
                <span class="n">dates</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span>
                    <span class="n">dates</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span>
                        <span class="n">sent</span><span class="p">,</span>
                        <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">return_groupdict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">dates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span>
                <span class="n">doc</span><span class="p">,</span>
                <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">return_groupdict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">dates</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
        <span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">date</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span> <span class="k">if</span> <span class="n">date</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label_</span> <span class="o">!=</span> <span class="s2">&quot;false_positive&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">dates</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse dates using the groupdict returned by the matcher.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dates : List[Tuple[Span, Dict[str, str]]]</span>
<span class="sd">            List of tuples containing the spans and groupdict</span>
<span class="sd">            returned by the matcher.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List[Span]</span>
<span class="sd">            List of processed spans, with the date parsed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">span</span><span class="p">,</span> <span class="n">groupdict</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s2">&quot;relative&quot;</span><span class="p">:</span>
                <span class="n">parsed</span> <span class="o">=</span> <span class="n">RelativeDate</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span><span class="n">groupdict</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s2">&quot;absolute&quot;</span><span class="p">:</span>
                <span class="n">parsed</span> <span class="o">=</span> <span class="n">AbsoluteDate</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span><span class="n">groupdict</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parsed</span> <span class="o">=</span> <span class="n">Duration</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span><span class="n">groupdict</span><span class="p">)</span>

            <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">parsed</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">span</span> <span class="k">for</span> <span class="n">span</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">process_periods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Experimental period detection.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dates : List[Span]</span>
<span class="sd">            List of detected dates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List[Span]</span>
<span class="sd">            List of detected periods.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>

        <span class="n">periods</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="n">dates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">start</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dates</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dates</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>

            <span class="k">if</span> <span class="n">d1</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="n">Mode</span><span class="o">.</span><span class="n">DURATION</span> <span class="ow">or</span> <span class="n">d2</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="n">Mode</span><span class="o">.</span><span class="n">DURATION</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">d1</span> <span class="ow">in</span> <span class="n">seen</span> <span class="ow">or</span> <span class="n">d1</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">d2</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">d1</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">d2</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">PERIOD_PROXIMITY_THRESHOLD</span>
                <span class="ow">and</span> <span class="n">d1</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="n">d2</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span>
            <span class="p">):</span>

                <span class="n">period</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">d1</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">d2</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;period&quot;</span><span class="p">)</span>

                <span class="c1"># If one date is a duration,</span>
                <span class="c1"># the other may not have a registered mode.</span>
                <span class="n">m1</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="ow">or</span> <span class="n">Mode</span><span class="o">.</span><span class="n">FROM</span>
                <span class="n">m2</span> <span class="o">=</span> <span class="n">d2</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="ow">or</span> <span class="n">Mode</span><span class="o">.</span><span class="n">FROM</span>

                <span class="n">period</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">period</span> <span class="o">=</span> <span class="n">Period</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="n">m1</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">d1</span><span class="p">,</span>
                        <span class="n">m2</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">d2</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">)</span>

                <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
                <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>

                <span class="n">periods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">periods</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Tags dates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc : Doc</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc : Doc</span>
<span class="sd">            spaCy Doc object, annotated for dates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="n">dates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;dates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dates</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_periods</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;periods&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_periods</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.dates.Dates.nlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.dates.Dates.on_ents_only" class="doc doc-heading">
<code class="highlight language-python"><span class="n">on_ents_only</span> <span class="o">=</span> <span class="n">on_ents_only</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.dates.Dates.regex_matcher" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.dates.Dates.detect_periods" class="doc doc-heading">
<code class="highlight language-python"><span class="n">detect_periods</span> <span class="o">=</span> <span class="n">detect_periods</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.dates.Dates.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">absolute</span><span class="p">,</span> <span class="n">relative</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">false_positive</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">,</span> <span class="n">detect_periods</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/dates.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">absolute</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">relative</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">false_positive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">detect_periods</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>

    <span class="k">if</span> <span class="n">absolute</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">absolute</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">absolute_pattern</span>
    <span class="k">if</span> <span class="n">relative</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">relative</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">relative_pattern</span>
    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">duration_pattern</span>
    <span class="k">if</span> <span class="n">false_positive</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">false_positive</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">false_positive_pattern</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">absolute</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">absolute</span> <span class="o">=</span> <span class="p">[</span><span class="n">absolute</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">relative</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">relative</span> <span class="o">=</span> <span class="p">[</span><span class="n">relative</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">duration</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">relative</span> <span class="o">=</span> <span class="p">[</span><span class="n">duration</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">false_positive</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">false_positive</span> <span class="o">=</span> <span class="p">[</span><span class="n">false_positive</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="o">=</span> <span class="n">on_ents_only</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="o">=</span><span class="s2">&quot;strict&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;false_positive&quot;</span><span class="p">,</span> <span class="n">false_positive</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;absolute&quot;</span><span class="p">,</span> <span class="n">absolute</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;relative&quot;</span><span class="p">,</span> <span class="n">relative</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">detect_periods</span> <span class="o">=</span> <span class="n">detect_periods</span>

    <span class="k">if</span> <span class="n">detect_periods</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The period extractor is experimental.&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.dates.Dates.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Set extensions for the dates pipeline.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/dates.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set extensions for the dates pipeline.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;period&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.dates.Dates.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Find dates in doc.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>dates</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>list of date spans</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/dates.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find dates in doc.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dates:</span>
<span class="sd">        list of date spans</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="n">ents</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">]</span>
            <span class="n">ents</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
                <span class="n">ents</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>

        <span class="n">dates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="n">ent</span><span class="o">.</span><span class="n">sent</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">]):</span>
            <span class="n">dates</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span>
                <span class="n">dates</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span>
                    <span class="n">sent</span><span class="p">,</span>
                    <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">return_groupdict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">dates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span>
            <span class="n">doc</span><span class="p">,</span>
            <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">return_groupdict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">dates</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">date</span> <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span> <span class="k">if</span> <span class="n">date</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label_</span> <span class="o">!=</span> <span class="s2">&quot;false_positive&quot;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">dates</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.dates.Dates.parse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Parse dates using the groupdict returned by the matcher.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dates</code></td>
          <td class="doc-param-details">
            <p>List of tuples containing the spans and groupdict
returned by the matcher.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Tuple[Span, Dict[str, str]]]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List[Span]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of processed spans, with the date parsed.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/dates.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse dates using the groupdict returned by the matcher.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dates : List[Tuple[Span, Dict[str, str]]]</span>
<span class="sd">        List of tuples containing the spans and groupdict</span>
<span class="sd">        returned by the matcher.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List[Span]</span>
<span class="sd">        List of processed spans, with the date parsed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">span</span><span class="p">,</span> <span class="n">groupdict</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s2">&quot;relative&quot;</span><span class="p">:</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="n">RelativeDate</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span><span class="n">groupdict</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s2">&quot;absolute&quot;</span><span class="p">:</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="n">AbsoluteDate</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span><span class="n">groupdict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parsed</span> <span class="o">=</span> <span class="n">Duration</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span><span class="n">groupdict</span><span class="p">)</span>

        <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">parsed</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">span</span> <span class="k">for</span> <span class="n">span</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.dates.Dates.process_periods" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process_periods</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Experimental period detection.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dates</code></td>
          <td class="doc-param-details">
            <p>List of detected dates.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Span]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List[Span]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of detected periods.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/dates.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process_periods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Experimental period detection.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dates : List[Span]</span>
<span class="sd">        List of detected dates.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List[Span]</span>
<span class="sd">        List of detected periods.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">periods</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="n">dates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">start</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dates</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dates</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>

        <span class="k">if</span> <span class="n">d1</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="n">Mode</span><span class="o">.</span><span class="n">DURATION</span> <span class="ow">or</span> <span class="n">d2</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="n">Mode</span><span class="o">.</span><span class="n">DURATION</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">d1</span> <span class="ow">in</span> <span class="n">seen</span> <span class="ow">or</span> <span class="n">d1</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">d2</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">d1</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">d2</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">PERIOD_PROXIMITY_THRESHOLD</span>
            <span class="ow">and</span> <span class="n">d1</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="n">d2</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span>
        <span class="p">):</span>

            <span class="n">period</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">d1</span><span class="o">.</span><span class="n">doc</span><span class="p">,</span> <span class="n">d1</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">d2</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;period&quot;</span><span class="p">)</span>

            <span class="c1"># If one date is a duration,</span>
            <span class="c1"># the other may not have a registered mode.</span>
            <span class="n">m1</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="ow">or</span> <span class="n">Mode</span><span class="o">.</span><span class="n">FROM</span>
            <span class="n">m2</span> <span class="o">=</span> <span class="n">d2</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">mode</span> <span class="ow">or</span> <span class="n">Mode</span><span class="o">.</span><span class="n">FROM</span>

            <span class="n">period</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">period</span> <span class="o">=</span> <span class="n">Period</span><span class="o">.</span><span class="n">parse_obj</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="n">m1</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">d1</span><span class="p">,</span>
                    <span class="n">m2</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">d2</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>

            <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
            <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>

            <span class="n">periods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">periods</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.dates.Dates.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Tags dates.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>doc</code>
          </td>
          <td class="doc-returns-details">
            <p>spaCy Doc object, annotated for dates</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/dates.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tags dates.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        spaCy Doc object, annotated for dates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;dates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dates</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_periods</span><span class="p">:</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;periods&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_periods</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.dates.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.dates.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">absolute</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">false_positive</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">detect_periods</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;LOWER&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.misc.dates.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">absolute</span><span class="p">,</span> <span class="n">relative</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">false_positive</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">,</span> <span class="n">detect_periods</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;dates&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.dates&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.dates&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">absolute</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">relative</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">false_positive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">detect_periods</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Dates</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">absolute</span><span class="o">=</span><span class="n">absolute</span><span class="p">,</span>
        <span class="n">relative</span><span class="o">=</span><span class="n">relative</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
        <span class="n">false_positive</span><span class="o">=</span><span class="n">false_positive</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
        <span class="n">detect_periods</span><span class="o">=</span><span class="n">detect_periods</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.dates.models" class="doc doc-heading">
        <code>models</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.dates.models.Direction" class="doc doc-heading">
          <code>Direction</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="enum.Enum">Enum</span></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Direction</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>

    <span class="n">FUTURE</span> <span class="o">=</span> <span class="s2">&quot;FUTURE&quot;</span>
    <span class="n">PAST</span> <span class="o">=</span> <span class="s2">&quot;PAST&quot;</span>
    <span class="n">CURRENT</span> <span class="o">=</span> <span class="s2">&quot;CURRENT&quot;</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Direction.FUTURE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">FUTURE</span> <span class="o">=</span> <span class="s1">&#39;FUTURE&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Direction.PAST" class="doc doc-heading">
<code class="highlight language-python"><span class="n">PAST</span> <span class="o">=</span> <span class="s1">&#39;PAST&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Direction.CURRENT" class="doc doc-heading">
<code class="highlight language-python"><span class="n">CURRENT</span> <span class="o">=</span> <span class="s1">&#39;CURRENT&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.dates.models.Mode" class="doc doc-heading">
          <code>Mode</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="enum.Enum">Enum</span></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Mode</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>

    <span class="n">FROM</span> <span class="o">=</span> <span class="s2">&quot;FROM&quot;</span>
    <span class="n">UNTIL</span> <span class="o">=</span> <span class="s2">&quot;UNTIL&quot;</span>
    <span class="n">DURATION</span> <span class="o">=</span> <span class="s2">&quot;DURATION&quot;</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Mode.FROM" class="doc doc-heading">
<code class="highlight language-python"><span class="n">FROM</span> <span class="o">=</span> <span class="s1">&#39;FROM&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Mode.UNTIL" class="doc doc-heading">
<code class="highlight language-python"><span class="n">UNTIL</span> <span class="o">=</span> <span class="s1">&#39;UNTIL&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Mode.DURATION" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DURATION</span> <span class="o">=</span> <span class="s1">&#39;DURATION&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.dates.models.Period" class="doc doc-heading">
          <code>Period</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Period</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">FROM</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">UNTIL</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">DURATION</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">arbitrary_types_allowed</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Period.FROM" class="doc doc-heading">
<code class="highlight language-python"><span class="n">FROM</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Period.UNTIL" class="doc doc-heading">
<code class="highlight language-python"><span class="n">UNTIL</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Period.DURATION" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DURATION</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h8 id="edsnlp.pipelines.misc.dates.models.Period.Config" class="doc doc-heading">
          <code>Config</code>



</h8>


    <div class="doc doc-contents ">




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
    <span class="n">arbitrary_types_allowed</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.models.Period.Config.arbitrary_types_allowed" class="doc doc-heading">
<code class="highlight language-python"><span class="n">arbitrary_types_allowed</span> <span class="o">=</span> <span class="kc">True</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.dates.models.BaseDate" class="doc doc-heading">
          <code>BaseDate</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">BaseDate</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>

    <span class="n">mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@root_validator</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_strings</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;_&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.BaseDate.mode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mode</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.models.BaseDate.validate_strings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_strings</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@root_validator</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate_strings</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;_&quot;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.dates.models.AbsoluteDate" class="doc doc-heading">
          <code>AbsoluteDate</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.misc.dates.models.BaseDate" href="pipelines/misc/dates/models/#edsnlp.pipelines.misc.dates.models.BaseDate">BaseDate</a></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">AbsoluteDate</span><span class="p">(</span><span class="n">BaseDate</span><span class="p">):</span>

    <span class="n">year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">month</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">day</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">hour</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">minute</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">second</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tz</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">tz</span><span class="o">.</span><span class="n">timezone</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Europe/Paris&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pendulum</span><span class="o">.</span><span class="n">datetime</span><span class="p">]:</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">:</span>

            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

        <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="k">else</span> <span class="s2">&quot;????&quot;</span>
        <span class="n">month</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="k">else</span> <span class="s2">&quot;??&quot;</span>
        <span class="n">day</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="k">else</span> <span class="s2">&quot;??&quot;</span>

        <span class="n">norm</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hour</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hour</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">h&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">minute</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">minute</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">m&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">s&quot;</span>

        <span class="k">return</span> <span class="n">norm</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_year</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>

        <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2000</span> <span class="o">+</span> <span class="n">v</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.AbsoluteDate.year" class="doc doc-heading">
<code class="highlight language-python"><span class="n">year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.AbsoluteDate.month" class="doc doc-heading">
<code class="highlight language-python"><span class="n">month</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.AbsoluteDate.day" class="doc doc-heading">
<code class="highlight language-python"><span class="n">day</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.AbsoluteDate.hour" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hour</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.AbsoluteDate.minute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">minute</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.AbsoluteDate.second" class="doc doc-heading">
<code class="highlight language-python"><span class="n">second</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.models.AbsoluteDate.to_datetime" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_datetime</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="s1">&#39;Europe/Paris&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">tz</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">tz</span><span class="o">.</span><span class="n">timezone</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Europe/Paris&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pendulum</span><span class="o">.</span><span class="n">datetime</span><span class="p">]:</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="p">:</span>

        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.models.AbsoluteDate.norm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">norm</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

    <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="k">else</span> <span class="s2">&quot;????&quot;</span>
    <span class="n">month</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">month</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="k">else</span> <span class="s2">&quot;??&quot;</span>
    <span class="n">day</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">day</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="k">else</span> <span class="s2">&quot;??&quot;</span>

    <span class="n">norm</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">])</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hour</span><span class="p">:</span>
        <span class="n">norm</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hour</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">h&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">minute</span><span class="p">:</span>
        <span class="n">norm</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">minute</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">m&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">:</span>
        <span class="n">norm</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="si">:</span><span class="s2">02</span><span class="si">}</span><span class="s2">s&quot;</span>

    <span class="k">return</span> <span class="n">norm</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.models.AbsoluteDate.validate_year" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_year</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate_year</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2000</span> <span class="o">+</span> <span class="n">v</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.dates.models.Relative" class="doc doc-heading">
          <code>Relative</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.misc.dates.models.BaseDate" href="pipelines/misc/dates/models/#edsnlp.pipelines.misc.dates.models.BaseDate">BaseDate</a></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Relative</span><span class="p">(</span><span class="n">BaseDate</span><span class="p">):</span>

    <span class="n">year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">month</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">week</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">day</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">hour</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">minute</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">second</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@root_validator</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">parse_unit</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Units need to be handled separately.</span>

<span class="sd">        This validator modifies the key corresponding to the unit</span>
<span class="sd">        with the detected value</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        d : Dict[str, str]</span>
<span class="sd">            Original data</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict[str, str]</span>
<span class="sd">            Transformed data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">unit</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">unit</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">d</span>

    <span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">direction</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;direction&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="nb">dir</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">PAST</span> <span class="k">else</span> <span class="mi">1</span>

        <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="n">td</span> <span class="o">=</span> <span class="nb">dir</span> <span class="o">*</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">td</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Relative.year" class="doc doc-heading">
<code class="highlight language-python"><span class="n">year</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Relative.month" class="doc doc-heading">
<code class="highlight language-python"><span class="n">month</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Relative.week" class="doc doc-heading">
<code class="highlight language-python"><span class="n">week</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Relative.day" class="doc doc-heading">
<code class="highlight language-python"><span class="n">day</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Relative.hour" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hour</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Relative.minute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">minute</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Relative.second" class="doc doc-heading">
<code class="highlight language-python"><span class="n">second</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.models.Relative.parse_unit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse_unit</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Units need to be handled separately.</p>
<p>This validator modifies the key corresponding to the unit
with the detected value</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>d</code></td>
          <td class="doc-param-details">
            <p>Original data</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Dict[str, str]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Dict[str, str]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Transformed data</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@root_validator</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">parse_unit</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Units need to be handled separately.</span>

<span class="sd">    This validator modifies the key corresponding to the unit</span>
<span class="sd">    with the detected value</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    d : Dict[str, str]</span>
<span class="sd">        Original data</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Dict[str, str]</span>
<span class="sd">        Transformed data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unit</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unit&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">unit</span><span class="p">:</span>
        <span class="n">d</span><span class="p">[</span><span class="n">unit</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">d</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.models.Relative.to_datetime" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_datetime</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
    <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">direction</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;direction&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="nb">dir</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">PAST</span> <span class="k">else</span> <span class="mi">1</span>

    <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

    <span class="n">td</span> <span class="o">=</span> <span class="nb">dir</span> <span class="o">*</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">duration</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">td</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.dates.models.RelativeDate" class="doc doc-heading">
          <code>RelativeDate</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.misc.dates.models.Relative" href="pipelines/misc/dates/models/#edsnlp.pipelines.misc.dates.models.Relative">Relative</a></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">RelativeDate</span><span class="p">(</span><span class="n">Relative</span><span class="p">):</span>
    <span class="n">direction</span><span class="p">:</span> <span class="n">Direction</span> <span class="o">=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">CURRENT</span>

    <span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">note_datetime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
        <span class="n">td</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">RelativeDate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">note_datetime</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">note_datetime</span> <span class="o">+</span> <span class="n">td</span>

        <span class="k">return</span> <span class="n">td</span>

    <span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">CURRENT</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;direction&quot;</span><span class="p">)</span>

            <span class="p">(</span><span class="n">key</span><span class="p">,)</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

            <span class="n">norm</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;~0 </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">()</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">td</span><span class="o">.</span><span class="n">in_seconds</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;+</span><span class="si">{</span><span class="n">norm</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">norm</span>

    <span class="nd">@root_validator</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">handle_specifics</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Specific patterns such as `aujourd&#39;hui`, `hier`, etc,</span>
<span class="sd">        need to be handled separately.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        d : Dict[str, str]</span>
<span class="sd">            Original data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict[str, str]</span>
<span class="sd">            Modified data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">specific</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;specific&quot;</span><span class="p">)</span>
        <span class="n">specific</span> <span class="o">=</span> <span class="n">specific_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">specific</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">specific</span><span class="p">:</span>
            <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">specific</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">d</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.RelativeDate.direction" class="doc doc-heading">
<code class="highlight language-python"><span class="n">direction</span><span class="p">:</span> <span class="n">Direction</span> <span class="o">=</span> <span class="n">Direction</span><span class="o">.</span><span class="n">CURRENT</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.models.RelativeDate.to_datetime" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_datetime</span><span class="p">(</span><span class="n">note_datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">note_datetime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">Duration</span><span class="p">:</span>
    <span class="n">td</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">RelativeDate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">note_datetime</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">note_datetime</span> <span class="o">+</span> <span class="n">td</span>

    <span class="k">return</span> <span class="n">td</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.models.RelativeDate.norm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">norm</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="n">Direction</span><span class="o">.</span><span class="n">CURRENT</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;direction&quot;</span><span class="p">)</span>

        <span class="p">(</span><span class="n">key</span><span class="p">,)</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="n">norm</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;~0 </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">()</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">td</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">td</span><span class="o">.</span><span class="n">in_seconds</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">norm</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;+</span><span class="si">{</span><span class="n">norm</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">norm</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.models.RelativeDate.handle_specifics" class="doc doc-heading">
<code class="highlight language-python"><span class="n">handle_specifics</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Specific patterns such as <code>aujourd'hui</code>, <code>hier</code>, etc,
need to be handled separately.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>d</code></td>
          <td class="doc-param-details">
            <p>Original data.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Dict[str, str]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Dict[str, str]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Modified data.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@root_validator</span><span class="p">(</span><span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handle_specifics</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Specific patterns such as `aujourd&#39;hui`, `hier`, etc,</span>
<span class="sd">    need to be handled separately.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    d : Dict[str, str]</span>
<span class="sd">        Original data.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Dict[str, str]</span>
<span class="sd">        Modified data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">specific</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;specific&quot;</span><span class="p">)</span>
    <span class="n">specific</span> <span class="o">=</span> <span class="n">specific_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">specific</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">specific</span><span class="p">:</span>
        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">specific</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">d</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.dates.models.Duration" class="doc doc-heading">
          <code>Duration</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.misc.dates.models.Relative" href="pipelines/misc/dates/models/#edsnlp.pipelines.misc.dates.models.Relative">Relative</a></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Duration</span><span class="p">(</span><span class="n">Relative</span><span class="p">):</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">=</span> <span class="n">Mode</span><span class="o">.</span><span class="n">DURATION</span>

    <span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

        <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">()</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;during </span><span class="si">{</span><span class="n">td</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.models.Duration.mode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mode</span><span class="p">:</span> <span class="n">Mode</span> <span class="o">=</span> <span class="n">Mode</span><span class="o">.</span><span class="n">DURATION</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.models.Duration.norm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">norm</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/models.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>

    <span class="n">td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">()</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;during </span><span class="si">{</span><span class="n">td</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.dates.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.misc.dates.patterns.absolute" class="doc doc-heading">
        <code>absolute</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.absolute.no_year_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">no_year_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="n">day</span> <span class="o">+</span> <span class="n">raw_delimiter_with_spaces_pattern</span> <span class="o">+</span> <span class="n">month</span> <span class="o">+</span> <span class="n">time_pattern</span> <span class="o">+</span> <span class="n">post_num_pattern</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ante_num_pattern</span> <span class="o">+</span> <span class="n">numeric_day_pattern</span><span class="p">,</span> <span class="n">letter_day_pattern</span><span class="p">]</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="p">[</span><span class="n">numeric_month_pattern</span> <span class="o">+</span> <span class="n">post_num_pattern</span><span class="p">,</span> <span class="n">letter_month_pattern</span><span class="p">]]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.absolute.no_day_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">no_day_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="n">letter_month_pattern</span> <span class="o">+</span> <span class="n">raw_delimiter_with_spaces_pattern</span> <span class="o">+</span> <span class="n">year_pattern</span> <span class="o">+</span> <span class="n">post_num_pattern</span><span class="p">,</span> <span class="n">ante_num_pattern</span> <span class="o">+</span> <span class="n">lz_numeric_month_pattern</span> <span class="o">+</span> <span class="n">raw_delimiter_with_spaces_pattern</span> <span class="o">+</span> <span class="n">year_pattern</span> <span class="o">+</span> <span class="n">post_num_pattern</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.absolute.full_year_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">full_year_pattern</span> <span class="o">=</span> <span class="n">ante_num_pattern</span> <span class="o">+</span> <span class="n">fy_pattern</span> <span class="o">+</span> <span class="n">post_num_pattern</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.absolute.absolute_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">absolute_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(?&lt;=&#39;</span> <span class="o">+</span> <span class="n">mode_pattern</span> <span class="o">+</span> <span class="s1">&#39;.{,3})?&#39;</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">absolute_pattern</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.misc.dates.patterns.current" class="doc doc-heading">
        <code>current</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.current.current_patterns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">current_patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(?P&lt;year_0&gt;cette</span><span class="se">\\</span><span class="s1">s+ann[ée]e)(?![-</span><span class="se">\\</span><span class="s1">s]l[àa])&#39;</span><span class="p">,</span> <span class="s2">&quot;(?P&lt;day_0&gt;ce</span><span class="se">\\</span><span class="s2">s+jour|aujourd[&#39;</span><span class="se">\\</span><span class="s2">s]?hui)&quot;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;week_0&gt;cette</span><span class="se">\\</span><span class="s1">s+semaine|ces</span><span class="se">\\</span><span class="s1">sjours[-</span><span class="se">\\</span><span class="s1">s]ci)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_0&gt;ce</span><span class="se">\\</span><span class="s1">smois([-</span><span class="se">\\</span><span class="s1">s]ci)?)&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.current.current_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">current_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">current_patterns</span><span class="p">,</span> <span class="n">with_breaks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.misc.dates.patterns.false_positive" class="doc doc-heading">
        <code>false_positive</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.false_positive.false_positive_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">false_positive_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">([</span><span class="s1">&#39;(</span><span class="se">\\</span><span class="s1">d+&#39;</span> <span class="o">+</span> <span class="n">delimiter_pattern</span> <span class="o">+</span> <span class="s1">&#39;){3,}</span><span class="se">\\</span><span class="s1">d+(?!:</span><span class="se">\\</span><span class="s1">d</span><span class="se">\\</span><span class="s1">d)</span><span class="se">\\</span><span class="s1">b&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">d</span><span class="se">\\</span><span class="s1">/</span><span class="se">\\</span><span class="s1">d&#39;</span><span class="p">])</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.misc.dates.patterns.relative" class="doc doc-heading">
        <code>relative</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.relative.specific" class="doc doc-heading">
<code class="highlight language-python"><span class="n">specific</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;minus1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;hier&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;PAST&#39;</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;minus2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;avant[-</span><span class="se">\\</span><span class="s1">s]hier&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;PAST&#39;</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">2</span><span class="p">)),</span> <span class="s1">&#39;plus1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;demain&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;FUTURE&#39;</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="s1">&#39;plus2&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;après[-</span><span class="se">\\</span><span class="s1">s]demain&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;FUTURE&#39;</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">2</span><span class="p">))}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.relative.specific_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">specific_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">([</span><span class="s1">&#39;(?P&lt;specific_</span><span class="si">{k}</span><span class="s1">&gt;</span><span class="si">{p}</span><span class="s1">)&#39;</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">_</span><span class="p">))</span> <span class="ow">in</span> <span class="n">specific</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.relative.specific_dict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">specific_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span> <span class="ow">in</span> <span class="n">specific</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.relative.relative_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">relative_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(?&lt;=&#39;</span> <span class="o">+</span> <span class="n">mode_pattern</span> <span class="o">+</span> <span class="s1">&#39;.{,3})?&#39;</span> <span class="o">+</span> <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">relative_pattern</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.dates.patterns.relative.make_specific_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_specific_pattern</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/dates/patterns/relative.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_specific_pattern</span><span class="p">(</span><span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">directions</span><span class="o">.</span><span class="n">preceding_direction_pattern</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="sa">r</span><span class="s2">&quot;\s+&quot;</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">numbers</span><span class="o">.</span><span class="n">number_pattern</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="sa">r</span><span class="s2">&quot;\s*&quot;</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">units</span><span class="o">.</span><span class="n">unit_pattern</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;backward&quot;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="n">number_pattern</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="sa">r</span><span class="s2">&quot;\s*&quot;</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">units</span><span class="o">.</span><span class="n">unit_pattern</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="sa">r</span><span class="s2">&quot;\s+&quot;</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">directions</span><span class="o">.</span><span class="n">following_direction_pattern</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">directions</span><span class="o">.</span><span class="n">preceding_direction_pattern</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="sa">r</span><span class="s2">&quot;\s+&quot;</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">numbers</span><span class="o">.</span><span class="n">number_pattern</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="sa">r</span><span class="s2">&quot;\s*&quot;</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">units</span><span class="o">.</span><span class="n">unit_pattern</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="sa">r</span><span class="s2">&quot;\s+&quot;</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">directions</span><span class="o">.</span><span class="n">following_direction_pattern</span>

    <span class="k">return</span> <span class="n">p</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.misc.dates.patterns.duration" class="doc doc-heading">
        <code>duration</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.duration.cue_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cue_pattern</span> <span class="o">=</span> <span class="s1">&#39;(pendant|durant|pdt)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.dates.patterns.duration.duration_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">duration_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="n">cue_pattern</span> <span class="o">+</span> <span class="s1">&#39;.{,3}&#39;</span> <span class="o">+</span> <span class="n">numbers</span><span class="o">.</span><span class="n">number_pattern</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">s*&#39;</span> <span class="o">+</span> <span class="n">units</span><span class="o">.</span><span class="n">unit_pattern</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h7 id="edsnlp.pipelines.misc.dates.patterns.atomic" class="doc doc-heading">
        <code>atomic</code>



</h7>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.misc.dates.patterns.atomic.units" class="doc doc-heading">
        <code>units</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.units.units" class="doc doc-heading">
<code class="highlight language-python"><span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(?P&lt;unit_year&gt;ans?|ann[ée]es?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;unit_semester&gt;semestres?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;unit_trimester&gt;trimestres?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;unit_month&gt;mois)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;unit_week&gt;semaines?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;unit_day&gt;jours?|journ[ée]es?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;unit_hour&gt;h|heures?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;unit_minute&gt;min|minutes?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;unit_second&gt;sec|secondes?|s)&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.units.unit_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unit_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">with_breaks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.misc.dates.patterns.atomic.numbers" class="doc doc-heading">
        <code>numbers</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.numbers.letter_numbers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">letter_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;(?P&lt;number_01&gt;l&#39;|le|la|une?|ce|cette|cet)&quot;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_02&gt;deux)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_03&gt;trois)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_04&gt;quatre)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_05&gt;cinq)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_06&gt;six)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_07&gt;sept)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_08&gt;huit)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_09&gt;neuf)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_10&gt;dix)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_11&gt;onze)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_12&gt;douze)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_12&gt;treize)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_13&gt;quatorze)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_14&gt;quinze)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_15&gt;seize)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_16&gt;dix[-</span><span class="se">\\</span><span class="s1">s]sept)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_17&gt;dix[-</span><span class="se">\\</span><span class="s1">s]huit)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_18&gt;dix[-</span><span class="se">\\</span><span class="s1">s]neuf)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_20&gt;vingt)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_21&gt;vingt[-</span><span class="se">\\</span><span class="s1">s]et[-</span><span class="se">\\</span><span class="s1">s]un)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_22&gt;vingt[-</span><span class="se">\\</span><span class="s1">s]deux)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_23&gt;vingt[-</span><span class="se">\\</span><span class="s1">s]trois)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_24&gt;vingt[-</span><span class="se">\\</span><span class="s1">s]quatre)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_25&gt;vingt[-</span><span class="se">\\</span><span class="s1">s]cinq)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_26&gt;vingt[-</span><span class="se">\\</span><span class="s1">s]six)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_27&gt;vingt[-</span><span class="se">\\</span><span class="s1">s]sept)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_28&gt;vingt[-</span><span class="se">\\</span><span class="s1">s]huit)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_29&gt;vingt[-</span><span class="se">\\</span><span class="s1">s]neuf)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;number_30&gt;trente)&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.numbers.numeric_numbers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">numeric_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.numbers.letter_number_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">letter_number_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">letter_numbers</span><span class="p">,</span> <span class="n">with_breaks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.numbers.numeric_number_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">numeric_number_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">numeric_numbers</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.numbers.number_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">number_pattern</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{letter_number_pattern}</span><span class="s1">|</span><span class="si">{numeric_number_pattern}</span><span class="s1">)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.misc.dates.patterns.atomic.days" class="doc doc-heading">
        <code>days</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.days.letter_days" class="doc doc-heading">
<code class="highlight language-python"><span class="n">letter_days</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(?P&lt;day_01&gt;premier|1</span><span class="se">\\</span><span class="s1">s*er)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_02&gt;deux)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_03&gt;trois)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_04&gt;quatre)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_05&gt;cinq)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_06&gt;six)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_07&gt;sept)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_08&gt;huit)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_09&gt;neuf)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_10&gt;dix)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_11&gt;onze)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_12&gt;douze)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_13&gt;treize)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_14&gt;quatorze)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_15&gt;quinze)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_16&gt;seize)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_17&gt;dix</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*sept)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_18&gt;dix</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*huit)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_19&gt;dix</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*neuf)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_20&gt;vingt)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_21&gt;vingt</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*et</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*un)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_22&gt;vingt</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*deux)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_23&gt;vingt</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*trois)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_24&gt;vingt</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*quatre)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_25&gt;vingt</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*cinq)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_26&gt;vingt</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*six)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_27&gt;vingt</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*sept)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_28&gt;vingt</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*huit)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_29&gt;vingt</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*neuf)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_30&gt;trente)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;day_31&gt;trente</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*et</span><span class="se">\\</span><span class="s1">-?</span><span class="se">\\</span><span class="s1">s*un)&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.days.letter_day_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">letter_day_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">letter_days</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.days.nlz_numeric_day_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nlz_numeric_day_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?&lt;!</span><span class="se">\\</span><span class="s1">d)([1-9]|[12]</span><span class="se">\\</span><span class="s1">d|3[01])(?!</span><span class="se">\\</span><span class="s1">d)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.days.numeric_day_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">numeric_day_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?P&lt;day&gt;</span><span class="si">{numeric_day_pattern}</span><span class="s1">)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.days.lz_numeric_day_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lz_numeric_day_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?P&lt;day&gt;</span><span class="si">{lz_numeric_day_pattern}</span><span class="s1">)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.days.day_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">day_pattern</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{letter_day_pattern}</span><span class="s1">|</span><span class="si">{numeric_day_pattern}</span><span class="s1">)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.misc.dates.patterns.atomic.months" class="doc doc-heading">
        <code>months</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.months.letter_months" class="doc doc-heading">
<code class="highlight language-python"><span class="n">letter_months</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(?P&lt;month_01&gt;janvier|janv</span><span class="se">\\</span><span class="s1">.?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_02&gt;f[ée]vrier|f[ée]v</span><span class="se">\\</span><span class="s1">.?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_03&gt;mars|mar</span><span class="se">\\</span><span class="s1">.?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_04&gt;avril|avr</span><span class="se">\\</span><span class="s1">.?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_05&gt;mai)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_06&gt;juin)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_07&gt;juillet|juill?</span><span class="se">\\</span><span class="s1">.?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_08&gt;ao[uû]t)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_09&gt;septembre|sept?</span><span class="se">\\</span><span class="s1">.?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_10&gt;octobre|oct</span><span class="se">\\</span><span class="s1">.?)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_11&gt;novembre|nov</span><span class="se">\\</span><span class="s1">.)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;month_12&gt;d[ée]cembre|d[ée]c</span><span class="se">\\</span><span class="s1">.?)&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.months.letter_month_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">letter_month_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">letter_months</span><span class="p">,</span> <span class="n">with_breaks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.months.numeric_month_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">numeric_month_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?P&lt;month&gt;</span><span class="si">{numeric_month_pattern}</span><span class="s1">)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.months.lz_numeric_month_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lz_numeric_month_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?P&lt;month&gt;</span><span class="si">{lz_numeric_month_pattern}</span><span class="s1">)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.months.month_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">month_pattern</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{letter_month_pattern}</span><span class="s1">|</span><span class="si">{numeric_month_pattern}</span><span class="s1">)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.misc.dates.patterns.atomic.years" class="doc doc-heading">
        <code>years</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.years.year_patterns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">year_patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;19</span><span class="se">\\</span><span class="s1">d</span><span class="se">\\</span><span class="s1">d&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.years.full_year_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">full_year_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?&lt;!</span><span class="se">\\</span><span class="s1">d)&#39;</span> <span class="o">+</span> <span class="n">full_year_pattern</span> <span class="o">+</span> <span class="s1">&#39;(?!</span><span class="se">\\</span><span class="s1">d)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.years.year_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">year_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?&lt;!</span><span class="se">\\</span><span class="s1">d)&#39;</span> <span class="o">+</span> <span class="n">year_pattern</span> <span class="o">+</span> <span class="s1">&#39;(?!</span><span class="se">\\</span><span class="s1">d)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.misc.dates.patterns.atomic.directions" class="doc doc-heading">
        <code>directions</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.directions.preceding_directions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">preceding_directions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(?P&lt;direction_PAST&gt;depuis|depuis</span><span class="se">\\</span><span class="s1">s+le|il</span><span class="se">\\</span><span class="s1">s+y</span><span class="se">\\</span><span class="s1">s+a)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;direction_FUTURE&gt;dans)&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.directions.following_directions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">following_directions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(?P&lt;direction_FUTURE&gt;prochaine?s?|suivante?s?|plus</span><span class="se">\\</span><span class="s1">s+tard)&#39;</span><span class="p">,</span> <span class="s1">&#39;(?P&lt;direction_PAST&gt;derni[eè]re?s?|passée?s?|pr[ée]c[ée]dente?s?|plus</span><span class="se">\\</span><span class="s1">s+t[ôo]t)&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.directions.preceding_direction_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">preceding_direction_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">preceding_directions</span><span class="p">,</span> <span class="n">with_breaks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.directions.following_direction_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">following_direction_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">following_directions</span><span class="p">,</span> <span class="n">with_breaks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.misc.dates.patterns.atomic.delimiters" class="doc doc-heading">
        <code>delimiters</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.delimiters.raw_delimiters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">raw_delimiters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">/&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">-&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.delimiters.delimiters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delimiters</span> <span class="o">=</span> <span class="n">raw_delimiters</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">.&#39;</span><span class="p">,</span> <span class="s1">&#39;[^</span><span class="se">\\</span><span class="s1">S</span><span class="se">\\</span><span class="s1">r</span><span class="se">\\</span><span class="s1">n]+&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.delimiters.raw_delimiter_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">raw_delimiter_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">raw_delimiters</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.delimiters.raw_delimiter_with_spaces_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">raw_delimiter_with_spaces_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">raw_delimiters</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;[^</span><span class="se">\\</span><span class="s1">S</span><span class="se">\\</span><span class="s1">r</span><span class="se">\\</span><span class="s1">n]+&#39;</span><span class="p">])</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.delimiters.delimiter_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delimiter_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">delimiters</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.delimiters.ante_num_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ante_num_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?&lt;!.(?:</span><span class="si">{raw_delimiter_pattern}</span><span class="s1">)|[0-9][.,])&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.delimiters.post_num_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">post_num_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?!</span><span class="si">{raw_delimiter_pattern}</span><span class="s1">)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.misc.dates.patterns.atomic.modes" class="doc doc-heading">
        <code>modes</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.modes.modes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">modes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;(?P&lt;mode_FROM&gt;depuis|depuis</span><span class="se">\\</span><span class="s1">s+le|[àa]</span><span class="se">\\</span><span class="s1">s+partir</span><span class="se">\\</span><span class="s1">s+d[eu]|du)&#39;</span><span class="p">,</span> <span class="s2">&quot;(?P&lt;mode_UNTIL&gt;jusqu&#39;[àa]u?|au)&quot;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.modes.mode_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mode_pattern</span> <span class="o">=</span> <span class="n">make_pattern</span><span class="p">(</span><span class="n">modes</span><span class="p">,</span> <span class="n">with_breaks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h8 id="edsnlp.pipelines.misc.dates.patterns.atomic.time" class="doc doc-heading">
        <code>time</code>



</h8>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.time.hour_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hour_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?&lt;!</span><span class="se">\\</span><span class="s1">d)(?P&lt;hour&gt;0?[1-9]|1</span><span class="se">\\</span><span class="s1">d|2[0-3])(?!</span><span class="se">\\</span><span class="s1">d)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.time.lz_hour_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lz_hour_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?&lt;!</span><span class="se">\\</span><span class="s1">d)(?P&lt;hour&gt;0[1-9]|[12]</span><span class="se">\\</span><span class="s1">d|3[01])(?!</span><span class="se">\\</span><span class="s1">d)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.time.minute_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">minute_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?&lt;!</span><span class="se">\\</span><span class="s1">d)(?P&lt;minute&gt;0?[1-9]|[1-5]</span><span class="se">\\</span><span class="s1">d)(?!</span><span class="se">\\</span><span class="s1">d)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.time.lz_minute_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lz_minute_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?&lt;!</span><span class="se">\\</span><span class="s1">d)(?P&lt;minute&gt;0[1-9]|[1-5]</span><span class="se">\\</span><span class="s1">d)(?!</span><span class="se">\\</span><span class="s1">d)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.time.second_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">second_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?&lt;!</span><span class="se">\\</span><span class="s1">d)(?P&lt;second&gt;0?[1-9]|[1-5]</span><span class="se">\\</span><span class="s1">d)(?!</span><span class="se">\\</span><span class="s1">d)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.time.lz_second_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lz_second_pattern</span> <span class="o">=</span> <span class="s1">&#39;(?&lt;!</span><span class="se">\\</span><span class="s1">d)(?P&lt;second&gt;0[1-9]|[1-5]</span><span class="se">\\</span><span class="s1">d)(?!</span><span class="se">\\</span><span class="s1">d)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h9 id="edsnlp.pipelines.misc.dates.patterns.atomic.time.time_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">time_pattern</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="se">\\</span><span class="s1">s.{,3}&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="si">{hour_pattern}</span><span class="s1">[h:](</span><span class="si">{lz_minute_pattern}</span><span class="s1">)?&#39;</span> <span class="o">+</span> <span class="s1">&#39;((:|m|min)</span><span class="si">{lz_second_pattern}</span><span class="s1">)?&#39;</span> <span class="o">+</span> <span class="s1">&#39;)?&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h9>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.misc.measures" class="doc doc-heading">
        <code>measures</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.measures.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.misc.measures.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">measures</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eds.measures.size&#39;</span><span class="p">,</span> <span class="s1">&#39;eds.measures.weight&#39;</span><span class="p">,</span> <span class="s1">&#39;eds.measures.angle&#39;</span><span class="p">])</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.misc.measures.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">measures</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.measures&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">measures</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Measures</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">measures</span><span class="o">=</span><span class="n">measures</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.measures.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.measures.patterns.CompositeSize" class="doc doc-heading">
          <code>CompositeSize</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.misc.measures.measures.CompositeMeasure" href="pipelines/misc/measures/measures/#edsnlp.pipelines.misc.measures.measures.CompositeMeasure">CompositeMeasure</a></code></p>


      <p>Composite size measure. Supports the following units:
- mm
- cm
- dm
- m</p>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/measures/patterns.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CompositeSize</span><span class="p">(</span><span class="n">CompositeMeasure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Composite size measure. Supports the following units:</span>
<span class="sd">    - mm</span>
<span class="sd">    - cm</span>
<span class="sd">    - dm</span>
<span class="sd">    - m</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">mm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_multi_getter</span><span class="p">(</span><span class="s2">&quot;mm&quot;</span><span class="p">))</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_multi_getter</span><span class="p">(</span><span class="s2">&quot;cm&quot;</span><span class="p">))</span>
    <span class="n">dm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_multi_getter</span><span class="p">(</span><span class="s2">&quot;dm&quot;</span><span class="p">))</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_multi_getter</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.CompositeSize.mm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_multi_getter</span><span class="p">(</span><span class="s1">&#39;mm&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.CompositeSize.cm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_multi_getter</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.CompositeSize.dm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_multi_getter</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.CompositeSize.m" class="doc doc-heading">
<code class="highlight language-python"><span class="n">m</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_multi_getter</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.measures.patterns.Size" class="doc doc-heading">
          <code>Size</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.misc.measures.measures.SimpleMeasure" href="pipelines/misc/measures/measures/#edsnlp.pipelines.misc.measures.measures.SimpleMeasure">SimpleMeasure</a></code></p>


      <p>Size measure. Supports the following units:
- mm
- cm
- dm
- m</p>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/measures/patterns.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">misc</span><span class="p">(</span><span class="s2">&quot;eds.measures.size&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Size</span><span class="p">(</span><span class="n">SimpleMeasure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Size measure. Supports the following units:</span>
<span class="sd">    - mm</span>
<span class="sd">    - cm</span>
<span class="sd">    - dm</span>
<span class="sd">    - m</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPOSITE</span> <span class="o">=</span> <span class="n">CompositeSize</span>
    <span class="n">UNITS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;mm&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;mill?im&quot;</span><span class="p">,</span> <span class="s2">&quot;abbr&quot;</span><span class="p">:</span> <span class="s2">&quot;mm&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="s2">&quot;cm&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;centim&quot;</span><span class="p">,</span> <span class="s2">&quot;abbr&quot;</span><span class="p">:</span> <span class="s2">&quot;cm&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
        <span class="s2">&quot;dm&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;decim&quot;</span><span class="p">,</span> <span class="s2">&quot;abbr&quot;</span><span class="p">:</span> <span class="s2">&quot;dm&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
        <span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;metre&quot;</span><span class="p">,</span> <span class="s2">&quot;abbr&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">},</span>
    <span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">infix</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

    <span class="n">mm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s2">&quot;mm&quot;</span><span class="p">))</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s2">&quot;cm&quot;</span><span class="p">))</span>
    <span class="n">dm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s2">&quot;dm&quot;</span><span class="p">))</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Size.COMPOSITE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">COMPOSITE</span> <span class="o">=</span> <span class="n">CompositeSize</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Size.UNITS" class="doc doc-heading">
<code class="highlight language-python"><span class="n">UNITS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mm&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;mill?im&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;mm&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="s1">&#39;cm&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;centim&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;cm&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span> <span class="s1">&#39;dm&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;decim&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;dm&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;metre&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">}}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Size.mm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s1">&#39;mm&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Size.cm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s1">&#39;cm&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Size.dm" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Size.m" class="doc doc-heading">
<code class="highlight language-python"><span class="n">m</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Size.parse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse</span><span class="p">(</span><span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">infix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/patterns.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">infix</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.measures.patterns.Weight" class="doc doc-heading">
          <code>Weight</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.misc.measures.measures.SimpleMeasure" href="pipelines/misc/measures/measures/#edsnlp.pipelines.misc.measures.measures.SimpleMeasure">SimpleMeasure</a></code></p>


      <p>Weight measure. Supports the following units:
- mg
- cg
- dg
- g
- kg</p>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/measures/patterns.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">misc</span><span class="p">(</span><span class="s2">&quot;eds.measures.weight&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Weight</span><span class="p">(</span><span class="n">SimpleMeasure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Weight measure. Supports the following units:</span>
<span class="sd">    - mg</span>
<span class="sd">    - cg</span>
<span class="sd">    - dg</span>
<span class="sd">    - g</span>
<span class="sd">    - kg</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPOSITE</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">UNITS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;mg&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;mill?ig&quot;</span><span class="p">,</span> <span class="s2">&quot;abbr&quot;</span><span class="p">:</span> <span class="s2">&quot;mg&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="s2">&quot;cg&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;centig&quot;</span><span class="p">,</span> <span class="s2">&quot;abbr&quot;</span><span class="p">:</span> <span class="s2">&quot;cg&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
        <span class="s2">&quot;dg&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;decig&quot;</span><span class="p">,</span> <span class="s2">&quot;abbr&quot;</span><span class="p">:</span> <span class="s2">&quot;dg&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span>
        <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;gram&quot;</span><span class="p">,</span> <span class="s2">&quot;abbr&quot;</span><span class="p">:</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">},</span>
        <span class="s2">&quot;kg&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;kilo&quot;</span><span class="p">,</span> <span class="s2">&quot;abbr&quot;</span><span class="p">:</span> <span class="s2">&quot;kg&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1000000</span><span class="p">},</span>
    <span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">infix</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

    <span class="n">mg</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s2">&quot;mg&quot;</span><span class="p">))</span>
    <span class="n">cg</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s2">&quot;cg&quot;</span><span class="p">))</span>
    <span class="n">dg</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s2">&quot;dg&quot;</span><span class="p">))</span>
    <span class="n">g</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">))</span>
    <span class="n">kg</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s2">&quot;kg&quot;</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Weight.COMPOSITE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">COMPOSITE</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Weight.UNITS" class="doc doc-heading">
<code class="highlight language-python"><span class="n">UNITS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mg&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;mill?ig&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;mg&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="s1">&#39;cg&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;centig&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;cg&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span> <span class="s1">&#39;dg&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;decig&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;dg&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">},</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;gram&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">},</span> <span class="s1">&#39;kg&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;kilo&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;kg&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1000000</span><span class="p">}}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Weight.mg" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mg</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s1">&#39;mg&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Weight.cg" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cg</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s1">&#39;cg&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Weight.dg" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dg</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s1">&#39;dg&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Weight.g" class="doc doc-heading">
<code class="highlight language-python"><span class="n">g</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Weight.kg" class="doc doc-heading">
<code class="highlight language-python"><span class="n">kg</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s1">&#39;kg&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Weight.parse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse</span><span class="p">(</span><span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">infix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/patterns.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">infix</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.measures.patterns.Angle" class="doc doc-heading">
          <code>Angle</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.misc.measures.measures.SimpleMeasure" href="pipelines/misc/measures/measures/#edsnlp.pipelines.misc.measures.measures.SimpleMeasure">SimpleMeasure</a></code></p>


      <p>Angle measure. Supports the following units:
- h</p>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/measures/patterns.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">misc</span><span class="p">(</span><span class="s2">&quot;eds.measures.angle&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Angle</span><span class="p">(</span><span class="n">SimpleMeasure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Angle measure. Supports the following units:</span>
<span class="sd">    - h</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">COMPOSITE</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">UNITS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;heur&quot;</span><span class="p">,</span> <span class="s2">&quot;abbr&quot;</span><span class="p">:</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">infix</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">infix</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">int_part</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">dec_part</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.0</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s2">&quot;h&quot;</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Angle.COMPOSITE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">COMPOSITE</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Angle.UNITS" class="doc doc-heading">
<code class="highlight language-python"><span class="n">UNITS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;heur&#39;</span><span class="p">,</span> <span class="s1">&#39;abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Angle.h" class="doc doc-heading">
<code class="highlight language-python"><span class="n">h</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">make_simple_getter</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">))</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.patterns.Angle.parse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse</span><span class="p">(</span><span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">infix</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/patterns.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">infix</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">infix</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">int_part</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">dec_part</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.0</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.misc.measures.measures" class="doc doc-heading">
        <code>measures</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.measures.measures.Measure" class="doc doc-heading">
          <code>Measure</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code>abc.<span title="abc.ABC">ABC</span></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Measure</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="n">INTEGER</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;(?:[0-9]+)&quot;</span>
    <span class="n">CONJUNCTIONS</span> <span class="o">=</span> <span class="s2">&quot;et|ou&quot;</span>
    <span class="n">COMPOSERS</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[x*]|par&quot;</span>

    <span class="n">UNITS</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">COMPOSITE</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iter over items of the measure (only one for SimpleMeasure)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        iterable : Iterable[&quot;SimpleMeasure&quot;]</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Access items of the measure (only one for SimpleMeasure)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : int</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        measure : SimpleMeasure</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measure.INTEGER" class="doc doc-heading">
<code class="highlight language-python"><span class="n">INTEGER</span> <span class="o">=</span> <span class="s1">&#39;(?:[0-9]+)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measure.CONJUNCTIONS" class="doc doc-heading">
<code class="highlight language-python"><span class="n">CONJUNCTIONS</span> <span class="o">=</span> <span class="s1">&#39;et|ou&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measure.COMPOSERS" class="doc doc-heading">
<code class="highlight language-python"><span class="n">COMPOSERS</span> <span class="o">=</span> <span class="s1">&#39;[x*]|par&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measure.UNITS" class="doc doc-heading">
<code class="highlight language-python"><span class="n">UNITS</span> <span class="o">=</span> <span class="p">{}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measure.COMPOSITE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">COMPOSITE</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measure.__iter__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Iter over items of the measure (only one for SimpleMeasure)</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>iterable</code>
          </td>
          <td class="doc-returns-details">
            
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>Iterable[&#34;SimpleMeasure&#34;]</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iter over items of the measure (only one for SimpleMeasure)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    iterable : Iterable[&quot;SimpleMeasure&quot;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measure.__getitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Access items of the measure (only one for SimpleMeasure)</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>item</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>measure</code>
          </td>
          <td class="doc-returns-details">
            
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>SimpleMeasure</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Access items of the measure (only one for SimpleMeasure)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    item : int</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    measure : SimpleMeasure</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure" class="doc doc-heading">
          <code>SimpleMeasure</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.misc.measures.measures.Measure" href="pipelines/misc/measures/measures/#edsnlp.pipelines.misc.measures.measures.Measure">Measure</a></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">SimpleMeasure</span><span class="p">(</span><span class="n">Measure</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The SimpleMeasure class contains the value and unit</span>
<span class="sd">        for a single non-composite measure</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">        unit : str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">int_part</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">infix</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class method to create an instance from the match groups</span>

<span class="sd">        int_part : str</span>
<span class="sd">            The integer part of the match (eg 12 in 12 metres 50 or 12.50metres)</span>
<span class="sd">        dec_part : str</span>
<span class="sd">            The decimal part of the match (eg 50 in 12 metres 50 or 12.50metres)</span>
<span class="sd">        unit : str</span>
<span class="sd">            The normalized variant of the unit (eg &quot;m&quot; for 12 metre 50)</span>
<span class="sd">        infix : bool</span>
<span class="sd">            Whether the unit was in the before (True) or after (False) the decimal part</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_get_scale_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNITS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNITS</span><span class="p">[</span><span class="n">unit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">((</span><span class="bp">self</span><span class="p">,))</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">][</span><span class="n">item</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.value" class="doc doc-heading">
<code class="highlight language-python"><span class="n">value</span> <span class="o">=</span> <span class="n">value</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.unit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>The SimpleMeasure class contains the value and unit
for a single non-composite measure</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>value</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>float</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>unit</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The SimpleMeasure class contains the value and unit</span>
<span class="sd">    for a single non-composite measure</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    value : float</span>
<span class="sd">    unit : str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.parse" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse</span><span class="p">(</span><span class="n">int_part</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">infix</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Class method to create an instance from the match groups</p>
<p>int_part : str
    The integer part of the match (eg 12 in 12 metres 50 or 12.50metres)
dec_part : str
    The decimal part of the match (eg 50 in 12 metres 50 or 12.50metres)
unit : str
    The normalized variant of the unit (eg "m" for 12 metre 50)
infix : bool
    Whether the unit was in the before (True) or after (False) the decimal part</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">int_part</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dec_part</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">infix</span><span class="p">:</span> <span class="nb">bool</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class method to create an instance from the match groups</span>

<span class="sd">    int_part : str</span>
<span class="sd">        The integer part of the match (eg 12 in 12 metres 50 or 12.50metres)</span>
<span class="sd">    dec_part : str</span>
<span class="sd">        The decimal part of the match (eg 50 in 12 metres 50 or 12.50metres)</span>
<span class="sd">    unit : str</span>
<span class="sd">        The normalized variant of the unit (eg &quot;m&quot; for 12 metre 50)</span>
<span class="sd">    infix : bool</span>
<span class="sd">        Whether the unit was in the before (True) or after (False) the decimal part</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure._get_scale_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_get_scale_to</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_get_scale_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNITS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNITS</span><span class="p">[</span><span class="n">unit</span><span class="p">][</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.__iter__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">((</span><span class="bp">self</span><span class="p">,))</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.__getitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">][</span><span class="n">item</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.__eq__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.__lt__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__lt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.SimpleMeasure.__le__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__le__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.measures.measures.CompositeMeasure" class="doc doc-heading">
          <code>CompositeMeasure</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.misc.measures.measures.Measure" href="pipelines/misc/measures/measures/#edsnlp.pipelines.misc.measures.measures.Measure">Measure</a></code></p>


      <p>The CompositeMeasure class contains a sequence
of multiple SimpleMeasure instances</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>measures</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[SimpleMeasure]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CompositeMeasure</span><span class="p">(</span><span class="n">Measure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The CompositeMeasure class contains a sequence</span>
<span class="sd">    of multiple SimpleMeasure instances</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    measures : List[SimpleMeasure]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measures</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">]):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measures</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">measures</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot; x &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.CompositeMeasure.measures" class="doc doc-heading">
<code class="highlight language-python"><span class="n">measures</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">measures</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.CompositeMeasure.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">measures</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measures</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;SimpleMeasure&quot;</span><span class="p">]):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">measures</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">measures</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.CompositeMeasure.__iter__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.CompositeMeasure.__getitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.CompositeMeasure.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot; x &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.CompositeMeasure.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.misc.measures.measures.Measures" class="doc doc-heading">
          <code>Measures</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.base.BaseComponent" href="pipelines/base/#edsnlp.pipelines.base.BaseComponent">BaseComponent</a></code></p>


      <p>Matcher component to extract measures.
A measures is most often composed of a number and a unit like</p>
<blockquote>
<p>1,26 cm
The unit can also be positioned in place of the decimal dot/comma
1 cm 26
Some measures can be composite
1,26 cm x 2,34 mm
And sometimes they are factorized
Les trois kystes mesurent 1, 2 et 3cm.</p>
</blockquote>
<p>The recognized measures are stored in the "measures" SpanGroup.
Each span has a <code>Measure</code> object stored in the "value" extension attribute.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>The SpaCy object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>measures</code></td>
          <td class="doc-param-details">
            <p>The registry names of the measures to extract</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>Whether to match on the text ('TEXT') or on the normalized text ('NORM')</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether to exclude pollution patterns when matching in the text</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Measures</span><span class="p">(</span><span class="n">BaseComponent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Matcher component to extract measures.</span>
<span class="sd">    A measures is most often composed of a number and a unit like</span>
<span class="sd">    &gt; 1,26 cm</span>
<span class="sd">    The unit can also be positioned in place of the decimal dot/comma</span>
<span class="sd">    &gt; 1 cm 26</span>
<span class="sd">    Some measures can be composite</span>
<span class="sd">    &gt; 1,26 cm x 2,34 mm</span>
<span class="sd">    And sometimes they are factorized</span>
<span class="sd">    &gt; Les trois kystes mesurent 1, 2 et 3cm.</span>

<span class="sd">    The recognized measures are stored in the &quot;measures&quot; SpanGroup.</span>
<span class="sd">    Each span has a `Measure` object stored in the &quot;value&quot; extension attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        The SpaCy object.</span>
<span class="sd">    measures : List[str]</span>
<span class="sd">        The registry names of the measures to extract</span>
<span class="sd">    attr : str</span>
<span class="sd">        Whether to match on the text (&#39;TEXT&#39;) or on the normalized text (&#39;NORM&#39;)</span>
<span class="sd">    ignore_excluded : bool</span>
<span class="sd">        Whether to exclude pollution patterns when matching in the text</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">measures</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">extraction_regexes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Measure</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">measures</span><span class="p">:</span>
            <span class="bp">cls</span><span class="p">:</span> <span class="n">Measure</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>
            <span class="n">regexes</span> <span class="o">=</span> <span class="n">make_patterns</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">regexes</span><span class="p">[</span><span class="s2">&quot;trigger&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extraction_regexes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">regexes</span><span class="p">[</span><span class="s2">&quot;extraction&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Measures</span><span class="p">,</span> <span class="n">Measures</span><span class="p">)</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds measures to document&#39;s &quot;measures&quot; SpanGroup.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object, annotated for extracted terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_groupdict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="c1"># Filter spans by rightmost, largest spans first to handle cases like 1 m 50 kg</span>
        <span class="c1"># while keeping the corresponding groupdicts</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">match</span><span class="p">:</span> <span class="n">matches</span><span class="p">[</span><span class="n">match</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">sort_key</span><span class="o">=</span><span class="n">rightmost_largest_sort_key</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">measures</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">match</span><span class="p">,</span> <span class="n">groupdict</span> <span class="ow">in</span> <span class="n">matches</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">measure_name</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">label_</span>
            <span class="n">extraction_regex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extraction_regexes</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span>

            <span class="n">parsed_values</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">shared_unit_part</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                <span class="p">(</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">groupdict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">),</span> <span class="kc">None</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">sub_match</span> <span class="ow">in</span> <span class="n">regex</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">extraction_regex</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">text</span><span class="p">):</span>
                <span class="n">sub_groupdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sub_match</span><span class="o">.</span><span class="n">groupdict</span><span class="p">())</span>

                <span class="c1"># Integer part of the match</span>
                <span class="n">int_part</span> <span class="o">=</span> <span class="n">sub_groupdict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;int_part&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

                <span class="c1"># Decimal part of the match, if any</span>
                <span class="n">dec_part</span> <span class="o">=</span> <span class="n">sub_groupdict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;dec_part&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>

                <span class="c1"># If the unit was not postfix (in cases like 1cm, or 1 et 2cm)</span>
                <span class="c1"># the unit must be infix: we extract it now using non empty groupdict</span>
                <span class="c1"># entries</span>
                <span class="n">infix_unit_part</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">sub_groupdict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="kc">None</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">unit_part</span> <span class="o">=</span> <span class="n">infix_unit_part</span> <span class="ow">or</span> <span class="n">shared_unit_part</span>

                <span class="c1"># Create one SimpleMeasure per submatch inside each match...</span>
                <span class="n">parsed_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span>
                        <span class="n">int_part</span><span class="o">=</span><span class="n">int_part</span><span class="p">,</span>
                        <span class="n">dec_part</span><span class="o">=</span><span class="n">dec_part</span><span class="p">,</span>
                        <span class="n">unit</span><span class="o">=</span><span class="n">unit_part</span><span class="p">,</span>
                        <span class="n">infix</span><span class="o">=</span><span class="n">infix_unit_part</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="c1"># ... and compose theses measures together if there are more than one</span>
            <span class="n">measure</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">measure_name</span><span class="p">)</span>
            <span class="n">measure</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">parsed_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">COMPOSITE</span><span class="p">(</span><span class="n">parsed_values</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">COMPOSITE</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="n">parsed_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">measures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;measures&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">measures</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measures.regex_matcher" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measures.extraction_regexes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extraction_regexes</span> <span class="o">=</span> <span class="p">{}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measures.measures" class="doc doc-heading">
<code class="highlight language-python"><span class="n">measures</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Measure</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measures.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">measures</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">measures</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">extraction_regexes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Measure</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">measures</span><span class="p">:</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="n">Measure</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>
        <span class="n">regexes</span> <span class="o">=</span> <span class="n">make_patterns</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">regexes</span><span class="p">[</span><span class="s2">&quot;trigger&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extraction_regexes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">regexes</span><span class="p">[</span><span class="s2">&quot;extraction&quot;</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measures.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">Measures</span><span class="p">,</span> <span class="n">Measures</span><span class="p">)</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.misc.measures.measures.Measures.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Adds measures to document's "measures" SpanGroup.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>spaCy Doc object, annotated for extracted terms.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds measures to document&#39;s &quot;measures&quot; SpanGroup.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object, annotated for extracted terms.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_groupdict</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="c1"># Filter spans by rightmost, largest spans first to handle cases like 1 m 50 kg</span>
    <span class="c1"># while keeping the corresponding groupdicts</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">match</span><span class="p">:</span> <span class="n">matches</span><span class="p">[</span><span class="n">match</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">sort_key</span><span class="o">=</span><span class="n">rightmost_largest_sort_key</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">measures</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">match</span><span class="p">,</span> <span class="n">groupdict</span> <span class="ow">in</span> <span class="n">matches</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">measure_name</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">label_</span>
        <span class="n">extraction_regex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extraction_regexes</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span>

        <span class="n">parsed_values</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">shared_unit_part</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
            <span class="p">(</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">groupdict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">),</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">sub_match</span> <span class="ow">in</span> <span class="n">regex</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">extraction_regex</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">text</span><span class="p">):</span>
            <span class="n">sub_groupdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">sub_match</span><span class="o">.</span><span class="n">groupdict</span><span class="p">())</span>

            <span class="c1"># Integer part of the match</span>
            <span class="n">int_part</span> <span class="o">=</span> <span class="n">sub_groupdict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;int_part&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Decimal part of the match, if any</span>
            <span class="n">dec_part</span> <span class="o">=</span> <span class="n">sub_groupdict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;dec_part&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>

            <span class="c1"># If the unit was not postfix (in cases like 1cm, or 1 et 2cm)</span>
            <span class="c1"># the unit must be infix: we extract it now using non empty groupdict</span>
            <span class="c1"># entries</span>
            <span class="n">infix_unit_part</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                <span class="p">(</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">sub_groupdict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">),</span>
                <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">unit_part</span> <span class="o">=</span> <span class="n">infix_unit_part</span> <span class="ow">or</span> <span class="n">shared_unit_part</span>

            <span class="c1"># Create one SimpleMeasure per submatch inside each match...</span>
            <span class="n">parsed_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span>
                    <span class="n">int_part</span><span class="o">=</span><span class="n">int_part</span><span class="p">,</span>
                    <span class="n">dec_part</span><span class="o">=</span><span class="n">dec_part</span><span class="p">,</span>
                    <span class="n">unit</span><span class="o">=</span><span class="n">unit_part</span><span class="p">,</span>
                    <span class="n">infix</span><span class="o">=</span><span class="n">infix_unit_part</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># ... and compose theses measures together if there are more than one</span>
        <span class="n">measure</span> <span class="o">=</span> <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">measure_name</span><span class="p">)</span>
        <span class="n">measure</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">parsed_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">COMPOSITE</span><span class="p">(</span><span class="n">parsed_values</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">[</span><span class="n">measure_name</span><span class="p">]</span><span class="o">.</span><span class="n">COMPOSITE</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">parsed_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">measures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="p">)</span>

    <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;measures&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">measures</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.misc.measures.measures.disj_capture" class="doc doc-heading">
<code class="highlight language-python"><span class="n">disj_capture</span><span class="p">(</span><span class="n">regexes</span><span class="p">,</span> <span class="n">capture</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">disj_capture</span><span class="p">(</span><span class="n">regexes</span><span class="p">,</span> <span class="n">capture</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;(?P&lt;</span><span class="si">{key}</span><span class="s2">&gt;</span><span class="si">{forms}</span><span class="s2">)&quot;</span> <span class="k">if</span> <span class="n">capture</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="si">{forms}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">forms</span><span class="o">=</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">forms</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">forms</span> <span class="ow">in</span> <span class="n">regexes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.misc.measures.measures.rightmost_largest_sort_key" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rightmost_largest_sort_key</span><span class="p">(</span><span class="n">span</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rightmost_largest_sort_key</span><span class="p">(</span><span class="n">span</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">span</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.misc.measures.measures.make_patterns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_patterns</span><span class="p">(</span><span class="n">measure</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">

      <p>Build recognition and extraction patterns for a given Measure class</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>measure</code></td>
          <td class="doc-param-details">
            <p>The measure to build recognition and extraction patterns for</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>&#39;Measure&#39;</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>trigger</code>
          </td>
          <td class="doc-returns-details">
            
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
              </p>
          </td>
        </tr>
        <tr>
          <td>
              <code>extraction</code>
          </td>
          <td class="doc-returns-details">
            
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_patterns</span><span class="p">(</span><span class="n">measure</span><span class="p">:</span> <span class="s2">&quot;Measure&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build recognition and extraction patterns for a given Measure class</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    measure: Measure class</span>
<span class="sd">        The measure to build recognition and extraction patterns for</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    trigger : List[str]</span>
<span class="sd">    extraction : str</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unit_prefix_reg</span> <span class="o">=</span> <span class="n">disj_capture</span><span class="p">(</span>
        <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="p">[</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;prefix&quot;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">measure</span><span class="o">.</span><span class="n">UNITS</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
        <span class="n">capture</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">unit_abbreviation_reg</span> <span class="o">=</span> <span class="n">disj_capture</span><span class="p">(</span>
        <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="p">[</span><span class="n">entry</span><span class="p">[</span><span class="s2">&quot;abbr&quot;</span><span class="p">]]</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">measure</span><span class="o">.</span><span class="n">UNITS</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
        <span class="n">capture</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">unit_reg</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;(?:(?:</span><span class="si">{</span><span class="n">unit_prefix_reg</span><span class="si">}</span><span class="s2">)[a-z]*|(?:</span><span class="si">{</span><span class="n">unit_abbreviation_reg</span><span class="si">}</span><span class="s2">)(?![a-z]))&quot;</span>

    <span class="n">number_reg</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;(?:</span><span class="si">{</span><span class="n">measure</span><span class="o">.</span><span class="n">INTEGER</span><span class="si">}</span><span class="s2">(?:[,.]</span><span class="si">{</span><span class="n">measure</span><span class="o">.</span><span class="n">INTEGER</span><span class="si">}</span><span class="s2">)?)&quot;</span>
    <span class="n">infix_measure_reg</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;(?:</span><span class="si">{</span><span class="n">measure</span><span class="o">.</span><span class="n">INTEGER</span><span class="si">}{</span><span class="n">unit_reg</span><span class="si">}{</span><span class="n">measure</span><span class="o">.</span><span class="n">INTEGER</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="c1"># Simple measure</span>
    <span class="n">simple_measure_reg</span> <span class="o">=</span> <span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">number_reg</span><span class="si">}</span><span class="s2">\s*</span><span class="si">{</span><span class="n">unit_reg</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">trigger</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">simple_measure_reg</span><span class="p">,</span>
        <span class="n">infix_measure_reg</span><span class="p">,</span>
        <span class="c1"># Factorized measures separated by a conjunction</span>
        <span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">number_reg</span><span class="si">}</span><span class="s2">(?=(?:\s*[,]\s*</span><span class="si">{</span><span class="n">number_reg</span><span class="si">}</span><span class="s2">)*\s*&quot;</span>
        <span class="sa">rf</span><span class="s2">&quot;(?:</span><span class="si">{</span><span class="n">measure</span><span class="o">.</span><span class="n">CONJUNCTIONS</span><span class="si">}</span><span class="s2">)\s*</span><span class="si">{</span><span class="n">number_reg</span><span class="si">}</span><span class="s2">\s*</span><span class="si">{</span><span class="n">unit_reg</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">measure</span><span class="o">.</span><span class="n">COMPOSITE</span><span class="p">:</span>
        <span class="c1"># Factorized composite measures (3 x 2cm)</span>
        <span class="n">trigger</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">rf</span><span class="s2">&quot;(?&lt;![a-z])</span><span class="si">{</span><span class="n">number_reg</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="sa">rf</span><span class="s2">&quot;(?:\s*(?:</span><span class="si">{</span><span class="n">measure</span><span class="o">.</span><span class="n">COMPOSERS</span><span class="si">}</span><span class="s2">)\s*</span><span class="si">{</span><span class="n">number_reg</span><span class="si">}</span><span class="s2">)*\s*</span><span class="si">{</span><span class="n">unit_reg</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Expanded composite measures (3cm x 2cm)</span>
        <span class="n">trigger</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="sa">rf</span><span class="s2">&quot;(?&lt;![a-z])(?:</span><span class="si">{</span><span class="n">infix_measure_reg</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">simple_measure_reg</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="sa">rf</span><span class="s2">&quot;(\s*(?:</span><span class="si">{</span><span class="n">measure</span><span class="o">.</span><span class="n">COMPOSERS</span><span class="si">}</span><span class="s2">)\s*&quot;</span>
            <span class="sa">rf</span><span class="s2">&quot;(?:</span><span class="si">{</span><span class="n">infix_measure_reg</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">simple_measure_reg</span><span class="si">}</span><span class="s2">))*&quot;</span>
        <span class="p">)</span>

    <span class="n">unit_reg_capture</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">rf</span><span class="s2">&quot;(?:(?:</span><span class="si">{</span><span class="n">unit_prefix_reg</span><span class="si">}</span><span class="s2">)[a-z]*|(?:</span><span class="si">{</span><span class="n">unit_abbreviation_reg</span><span class="si">}</span><span class="s2">)(?![a-z]))&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;trigger&quot;</span><span class="p">:</span> <span class="n">trigger</span><span class="p">,</span>
        <span class="s2">&quot;extraction&quot;</span><span class="p">:</span> <span class="sa">rf</span><span class="s2">&quot;(?P&lt;int_part&gt;</span><span class="si">{</span><span class="n">measure</span><span class="o">.</span><span class="n">INTEGER</span><span class="si">}</span><span class="s2">)\s*(?:[,.]|&quot;</span>
        <span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">unit_reg_capture</span><span class="si">}</span><span class="s2">)?\s*(?P&lt;dec_part&gt;</span><span class="si">{</span><span class="n">measure</span><span class="o">.</span><span class="n">INTEGER</span><span class="si">}</span><span class="s2">)?&quot;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.misc.measures.measures.make_simple_getter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_simple_getter</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_simple_getter</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a scaled numerical value of a measure</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        self</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_scale_to</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">getter</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.misc.measures.measures.make_multi_getter" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_multi_getter</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/misc/measures/measures.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_multi_getter</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="s2">&quot;CompositeMeasure&quot;</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
    <span class="k">def</span> <span class="nf">getter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a scaled numerical values of a multi-measure</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        self</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">measure</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">measures</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">getter</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.pipelines.qualifiers" class="doc doc-heading">
        <code>qualifiers</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.qualifiers.base" class="doc doc-heading">
        <code>base</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h6 id="edsnlp.pipelines.qualifiers.base.Qualifier" class="doc doc-heading">
          <code>Qualifier</code>



</h6>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.base.BaseComponent" href="pipelines/base/#edsnlp.pipelines.base.BaseComponent">BaseComponent</a></code></p>


      <p>Implements the NegEx algorithm.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy nlp pipeline to use for matching.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>spaCy's attribute to use:
a string with the value "TEXT" or "NORM", or a dict with the key 'term_attr'
we can also add a key for each regex.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>on_ents_only</code></td>
          <td class="doc-param-details">
            <p>Whether to look for matches around detected entities only.
Useful for faster inference in downstream tasks.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>explain</code></td>
          <td class="doc-param-details">
            <p>Whether to keep track of cues for each entity.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>**terms</code></td>
          <td class="doc-param-details">
            <p>Terms to look for.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Dict[str, Optional[List[str]]]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/qualifiers/base.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Qualifier</span><span class="p">(</span><span class="n">BaseComponent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements the NegEx algorithm.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy nlp pipeline to use for matching.</span>
<span class="sd">    attr : str</span>
<span class="sd">        spaCy&#39;s attribute to use:</span>
<span class="sd">        a string with the value &quot;TEXT&quot; or &quot;NORM&quot;, or a dict with the key &#39;term_attr&#39;</span>
<span class="sd">        we can also add a key for each regex.</span>
<span class="sd">    on_ents_only : bool</span>
<span class="sd">        Whether to look for matches around detected entities only.</span>
<span class="sd">        Useful for faster inference in downstream tasks.</span>
<span class="sd">    explain : bool</span>
<span class="sd">        Whether to keep track of cues for each entity.</span>
<span class="sd">    **terms : Dict[str, Optional[List[str]]]</span>
<span class="sd">        Terms to look for.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="o">**</span><span class="n">terms</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span>
    <span class="p">):</span>

        <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;NORM&quot;</span><span class="p">:</span>
            <span class="n">check_normalizer</span><span class="p">(</span><span class="n">nlp</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span> <span class="o">=</span> <span class="n">EDSPhraseMatcher</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span><span class="o">.</span><span class="n">build_patterns</span><span class="p">(</span><span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="n">terms</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="o">=</span> <span class="n">on_ents_only</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">explain</span> <span class="o">=</span> <span class="n">explain</span>

    <span class="k">def</span> <span class="nf">get_defaults</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Merge terms with their defaults. Null keys are replaced with defaults.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict[str, List[str]]</span>
<span class="sd">            Merged dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Filter out empty keys</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>

        <span class="c1"># Update defaults</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">terms</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">terms</span>

    <span class="k">def</span> <span class="nf">get_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract matches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc : Doc</span>
<span class="sd">            spaCy `Doc` object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List[Span]</span>
<span class="sd">            List of detected spans</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>

            <span class="n">sents</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">ent</span><span class="o">.</span><span class="n">sent</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">])</span>
            <span class="n">match_iterator</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">sent</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">sents</span>
            <span class="p">)</span>

            <span class="n">matches</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">match_iterator</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.base.Qualifier.defaults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.base.Qualifier.phrase_matcher" class="doc doc-heading">
<code class="highlight language-python"><span class="n">phrase_matcher</span> <span class="o">=</span> <span class="n">EDSPhraseMatcher</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.base.Qualifier.on_ents_only" class="doc doc-heading">
<code class="highlight language-python"><span class="n">on_ents_only</span> <span class="o">=</span> <span class="n">on_ents_only</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.base.Qualifier.explain" class="doc doc-heading">
<code class="highlight language-python"><span class="n">explain</span> <span class="o">=</span> <span class="n">explain</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.qualifiers.base.Qualifier.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">,</span> <span class="n">explain</span><span class="p">,</span> <span class="o">**</span><span class="n">terms</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/base.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="o">**</span><span class="n">terms</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]],</span>
<span class="p">):</span>

    <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;NORM&quot;</span><span class="p">:</span>
        <span class="n">check_normalizer</span><span class="p">(</span><span class="n">nlp</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span> <span class="o">=</span> <span class="n">EDSPhraseMatcher</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="n">nlp</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span><span class="o">.</span><span class="n">build_patterns</span><span class="p">(</span><span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span> <span class="n">terms</span><span class="o">=</span><span class="n">terms</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="o">=</span> <span class="n">on_ents_only</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">explain</span> <span class="o">=</span> <span class="n">explain</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.qualifiers.base.Qualifier.get_defaults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_defaults</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">

      <p>Merge terms with their defaults. Null keys are replaced with defaults.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Dict[str, List[str]]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Merged dictionary</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/base.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_defaults</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merge terms with their defaults. Null keys are replaced with defaults.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Dict[str, List[str]]</span>
<span class="sd">        Merged dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Filter out empty keys</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>

    <span class="c1"># Update defaults</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaults</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">terms</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">terms</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.qualifiers.base.Qualifier.get_matches" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">

      <p>Extract matches.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy <code>Doc</code> object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List[Span]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of detected spans</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/base.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract matches.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        spaCy `Doc` object.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List[Span]</span>
<span class="sd">        List of detected spans</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>

        <span class="n">sents</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">ent</span><span class="o">.</span><span class="n">sent</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">])</span>
        <span class="n">match_iterator</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">sent</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span><span class="p">(</span><span class="n">sent</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">sents</span>
        <span class="p">)</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">match_iterator</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phrase_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.qualifiers.base.Qualifier.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/base.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h6 id="edsnlp.pipelines.qualifiers.base.check_normalizer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_normalizer</span><span class="p">(</span><span class="n">nlp</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/base.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_normalizer</span><span class="p">(</span><span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">components</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">component</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipeline</span><span class="p">}</span>
    <span class="n">normalizer</span> <span class="o">=</span> <span class="n">components</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;normalizer&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">normalizer</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">lowercase</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;You have chosen the NORM attribute, but disabled lowercasing &quot;</span>
            <span class="s2">&quot;in your normalisation pipeline. &quot;</span>
            <span class="s2">&quot;This WILL hurt performance : you might want to use the &quot;</span>
            <span class="s2">&quot;LOWER attribute instead.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.qualifiers.factories" class="doc doc-heading">
        <code>factories</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">










  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.qualifiers.hypothesis" class="doc doc-heading">
        <code>hypothesis</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.hypothesis.hypothesis" class="doc doc-heading">
        <code>hypothesis</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.qualifiers.hypothesis.hypothesis.Hypothesis" class="doc doc-heading">
          <code>Hypothesis</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.qualifiers.base.Qualifier" href="pipelines/qualifiers/base/#edsnlp.pipelines.qualifiers.base.Qualifier">Qualifier</a></code></p>


      <p>Hypothesis detection with spaCy.</p>
<p>The component looks for five kinds of expressions in the text :</p>
<ul>
<li>preceding hypothesis, ie cues that precede a hypothetic expression</li>
<li>following hypothesis, ie cues that follow a hypothetic expression</li>
<li>pseudo hypothesis : contain a hypothesis cue, but are not hypothesis
  (eg "pas de doute"/"no doubt")</li>
<li>hypothetic verbs : verbs indicating hypothesis (eg "douter")</li>
<li>classic verbs conjugated to the conditional, thus indicating hypothesis</li>
</ul>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy nlp pipeline to use for matching.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>pseudo</code></td>
          <td class="doc-param-details">
            <p>List of pseudo hypothesis cues.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>preceding</code></td>
          <td class="doc-param-details">
            <p>List of preceding hypothesis cues</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>following</code></td>
          <td class="doc-param-details">
            <p>List of following hypothesis cues.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>verbs_hyp</code></td>
          <td class="doc-param-details">
            <p>List of hypothetic verbs.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>verbs_eds</code></td>
          <td class="doc-param-details">
            <p>List of mainstream verbs.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>filter_matches</code></td>
          <td class="doc-param-details">
            <p>Whether to filter out overlapping matches.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>spaCy's attribute to use:
a string with the value "TEXT" or "NORM", or a dict with the key 'term_attr'
we can also add a key for each regex.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>on_ents_only</code></td>
          <td class="doc-param-details">
            <p>Whether to look for matches around detected entities only.
Useful for faster inference in downstream tasks.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>within_ents</code></td>
          <td class="doc-param-details">
            <p>Whether to consider cues within entities.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>explain</code></td>
          <td class="doc-param-details">
            <p>Whether to keep track of cues for each entity.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>regex</code></td>
          <td class="doc-param-details">
            <p>A dictionnary of regex patterns.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Dict[str, Union[List[str], str]]]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/qualifiers/hypothesis/hypothesis.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Hypothesis</span><span class="p">(</span><span class="n">Qualifier</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hypothesis detection with spaCy.</span>

<span class="sd">    The component looks for five kinds of expressions in the text :</span>

<span class="sd">    - preceding hypothesis, ie cues that precede a hypothetic expression</span>
<span class="sd">    - following hypothesis, ie cues that follow a hypothetic expression</span>
<span class="sd">    - pseudo hypothesis : contain a hypothesis cue, but are not hypothesis</span>
<span class="sd">      (eg &quot;pas de doute&quot;/&quot;no doubt&quot;)</span>
<span class="sd">    - hypothetic verbs : verbs indicating hypothesis (eg &quot;douter&quot;)</span>
<span class="sd">    - classic verbs conjugated to the conditional, thus indicating hypothesis</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy nlp pipeline to use for matching.</span>
<span class="sd">    pseudo : Optional[List[str]]</span>
<span class="sd">        List of pseudo hypothesis cues.</span>
<span class="sd">    preceding : Optional[List[str]]</span>
<span class="sd">        List of preceding hypothesis cues</span>
<span class="sd">    following : Optional[List[str]]</span>
<span class="sd">        List of following hypothesis cues.</span>
<span class="sd">    verbs_hyp : Optional[List[str]]</span>
<span class="sd">        List of hypothetic verbs.</span>
<span class="sd">    verbs_eds : Optional[List[str]]</span>
<span class="sd">        List of mainstream verbs.</span>
<span class="sd">    filter_matches : bool</span>
<span class="sd">        Whether to filter out overlapping matches.</span>
<span class="sd">    attr : str</span>
<span class="sd">        spaCy&#39;s attribute to use:</span>
<span class="sd">        a string with the value &quot;TEXT&quot; or &quot;NORM&quot;, or a dict with the key &#39;term_attr&#39;</span>
<span class="sd">        we can also add a key for each regex.</span>
<span class="sd">    on_ents_only : bool</span>
<span class="sd">        Whether to look for matches around detected entities only.</span>
<span class="sd">        Useful for faster inference in downstream tasks.</span>
<span class="sd">    within_ents : bool</span>
<span class="sd">        Whether to consider cues within entities.</span>
<span class="sd">    explain : bool</span>
<span class="sd">        Whether to keep track of cues for each entity.</span>
<span class="sd">    regex : Optional[Dict[str, Union[List[str], str]]]</span>
<span class="sd">        A dictionnary of regex patterns.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
        <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
        <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
        <span class="n">verbs_eds</span><span class="o">=</span><span class="n">verbs_eds</span><span class="p">,</span>
        <span class="n">verbs_hyp</span><span class="o">=</span><span class="n">verbs_hyp</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">pseudo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">preceding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">following</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">verbs_eds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">verbs_hyp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">within_ents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defaults</span><span class="p">(</span>
            <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
            <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
            <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
            <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
            <span class="n">verbs_eds</span><span class="o">=</span><span class="n">verbs_eds</span><span class="p">,</span>
            <span class="n">verbs_hyp</span><span class="o">=</span><span class="n">verbs_hyp</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">terms</span><span class="p">[</span><span class="s2">&quot;verbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_verbs</span><span class="p">(</span>
            <span class="n">verbs_hyp</span><span class="o">=</span><span class="n">terms</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;verbs_hyp&quot;</span><span class="p">),</span>
            <span class="n">verbs_eds</span><span class="o">=</span><span class="n">terms</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;verbs_eds&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
            <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
            <span class="o">**</span><span class="n">terms</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span> <span class="o">=</span> <span class="n">within_ents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis_&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;hypothesis_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">token</span><span class="p">:</span> <span class="s2">&quot;HYP&quot;</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="k">else</span> <span class="s2">&quot;CERT&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis_&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;hypothesis_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">span</span><span class="p">:</span> <span class="s2">&quot;HYP&quot;</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="k">else</span> <span class="s2">&quot;CERT&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis_cues&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis_cues&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">):</span>
            <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">def</span> <span class="nf">load_verbs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">verbs_hyp</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">verbs_eds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conjugate &quot;classic&quot; verbs to conditional, and add hypothesis</span>
<span class="sd">        verbs conjugated to all tenses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbs_hyp: List of verbs that specifically imply an hypothesis.</span>
<span class="sd">        verbs_eds: List of general verbs.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of hypothesis verbs conjugated at all tenses and classic</span>
<span class="sd">        verbs conjugated to conditional.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">classic_verbs</span> <span class="o">=</span> <span class="n">get_verbs</span><span class="p">(</span><span class="n">verbs_eds</span><span class="p">)</span>
        <span class="n">classic_verbs</span> <span class="o">=</span> <span class="n">classic_verbs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">classic_verbs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Conditionnel&quot;</span><span class="p">]</span>
        <span class="n">list_classic_verbs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">classic_verbs</span><span class="p">[</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

        <span class="n">hypo_verbs</span> <span class="o">=</span> <span class="n">get_verbs</span><span class="p">(</span><span class="n">verbs_hyp</span><span class="p">)</span>
        <span class="n">list_hypo_verbs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hypo_verbs</span><span class="p">[</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">list_hypo_verbs</span> <span class="o">+</span> <span class="n">list_classic_verbs</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds entities related to hypothesis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc: spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc: spaCy Doc object, annotated for hypothesis</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="n">terminations</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;termination&quot;</span><span class="p">)</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">terminations</span><span class="p">)</span>

        <span class="c1"># Removes duplicate matches and pseudo-expressions in one statement</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span><span class="p">)</span>

        <span class="n">entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discarded&quot;</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>

            <span class="n">ents</span><span class="p">,</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
                <span class="n">entities</span><span class="p">,</span>
                <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
                <span class="n">second_chance</span><span class="o">=</span><span class="n">ents</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">sub_matches</span><span class="p">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
                <span class="n">matches</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ents</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">sub_preceding</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;preceding&quot;</span><span class="p">)</span>
            <span class="n">sub_following</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;following&quot;</span><span class="p">)</span>
            <span class="n">sub_verbs</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;verbs&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_following</span> <span class="o">+</span> <span class="n">sub_verbs</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                        <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span>
                    <span class="p">)</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span><span class="p">:</span>
                    <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
                    <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
                    <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>

                <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="ow">or</span> <span class="nb">bool</span><span class="p">(</span><span class="n">cues</span><span class="p">)</span>

                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="o">=</span> <span class="n">hypothesis</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain</span> <span class="ow">and</span> <span class="n">hypothesis</span><span class="p">:</span>
                    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis_cues</span> <span class="o">+=</span> <span class="n">cues</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="n">hypothesis</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">:</span>
                        <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.hypothesis.hypothesis.Hypothesis.defaults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span> <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span> <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span> <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span> <span class="n">verbs_eds</span><span class="o">=</span><span class="n">verbs_eds</span><span class="p">,</span> <span class="n">verbs_hyp</span><span class="o">=</span><span class="n">verbs_hyp</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.hypothesis.hypothesis.Hypothesis.within_ents" class="doc doc-heading">
<code class="highlight language-python"><span class="n">within_ents</span> <span class="o">=</span> <span class="n">within_ents</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.hypothesis.hypothesis.Hypothesis.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">pseudo</span><span class="p">,</span> <span class="n">preceding</span><span class="p">,</span> <span class="n">following</span><span class="p">,</span> <span class="n">termination</span><span class="p">,</span> <span class="n">verbs_eds</span><span class="p">,</span> <span class="n">verbs_hyp</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">,</span> <span class="n">within_ents</span><span class="p">,</span> <span class="n">explain</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/hypothesis/hypothesis.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pseudo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">preceding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">following</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">verbs_eds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">verbs_hyp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">within_ents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defaults</span><span class="p">(</span>
        <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
        <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
        <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
        <span class="n">verbs_eds</span><span class="o">=</span><span class="n">verbs_eds</span><span class="p">,</span>
        <span class="n">verbs_hyp</span><span class="o">=</span><span class="n">verbs_hyp</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">terms</span><span class="p">[</span><span class="s2">&quot;verbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_verbs</span><span class="p">(</span>
        <span class="n">verbs_hyp</span><span class="o">=</span><span class="n">terms</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;verbs_hyp&quot;</span><span class="p">),</span>
        <span class="n">verbs_eds</span><span class="o">=</span><span class="n">terms</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;verbs_eds&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
        <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
        <span class="o">**</span><span class="n">terms</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span> <span class="o">=</span> <span class="n">within_ents</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.hypothesis.hypothesis.Hypothesis.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/hypothesis/hypothesis.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis_&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;hypothesis_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">token</span><span class="p">:</span> <span class="s2">&quot;HYP&quot;</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="k">else</span> <span class="s2">&quot;CERT&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis_&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;hypothesis_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">span</span><span class="p">:</span> <span class="s2">&quot;HYP&quot;</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="k">else</span> <span class="s2">&quot;CERT&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis_cues&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis_cues&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">):</span>
        <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.hypothesis.hypothesis.Hypothesis.load_verbs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_verbs</span><span class="p">(</span><span class="n">verbs_hyp</span><span class="p">,</span> <span class="n">verbs_eds</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Conjugate "classic" verbs to conditional, and add hypothesis
verbs conjugated to all tenses.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>verbs_hyp</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.List">List</span>[str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>verbs_eds</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.List">List</span>[str]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>list of hypothesis verbs conjugated at all tenses and classic</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>verbs conjugated to conditional.</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/hypothesis/hypothesis.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load_verbs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">verbs_hyp</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">verbs_eds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conjugate &quot;classic&quot; verbs to conditional, and add hypothesis</span>
<span class="sd">    verbs conjugated to all tenses.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    verbs_hyp: List of verbs that specifically imply an hypothesis.</span>
<span class="sd">    verbs_eds: List of general verbs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list of hypothesis verbs conjugated at all tenses and classic</span>
<span class="sd">    verbs conjugated to conditional.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">classic_verbs</span> <span class="o">=</span> <span class="n">get_verbs</span><span class="p">(</span><span class="n">verbs_eds</span><span class="p">)</span>
    <span class="n">classic_verbs</span> <span class="o">=</span> <span class="n">classic_verbs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">classic_verbs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Conditionnel&quot;</span><span class="p">]</span>
    <span class="n">list_classic_verbs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">classic_verbs</span><span class="p">[</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

    <span class="n">hypo_verbs</span> <span class="o">=</span> <span class="n">get_verbs</span><span class="p">(</span><span class="n">verbs_hyp</span><span class="p">)</span>
    <span class="n">list_hypo_verbs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hypo_verbs</span><span class="p">[</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">list_hypo_verbs</span> <span class="o">+</span> <span class="n">list_classic_verbs</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.hypothesis.hypothesis.Hypothesis.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Finds entities related to hypothesis.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/hypothesis/hypothesis.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds entities related to hypothesis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc: spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc: spaCy Doc object, annotated for hypothesis</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="n">terminations</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;termination&quot;</span><span class="p">)</span>
    <span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">terminations</span><span class="p">)</span>

    <span class="c1"># Removes duplicate matches and pseudo-expressions in one statement</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span><span class="p">)</span>

    <span class="n">entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discarded&quot;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>

        <span class="n">ents</span><span class="p">,</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
            <span class="n">entities</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
            <span class="n">second_chance</span><span class="o">=</span><span class="n">ents</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">sub_matches</span><span class="p">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
            <span class="n">matches</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ents</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">sub_preceding</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;preceding&quot;</span><span class="p">)</span>
        <span class="n">sub_following</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;following&quot;</span><span class="p">)</span>
        <span class="n">sub_verbs</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;verbs&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_following</span> <span class="o">+</span> <span class="n">sub_verbs</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                    <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span>
                <span class="p">)</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span><span class="p">:</span>
                <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
                <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
                <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>

            <span class="n">hypothesis</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="ow">or</span> <span class="nb">bool</span><span class="p">(</span><span class="n">cues</span><span class="p">)</span>

            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="o">=</span> <span class="n">hypothesis</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain</span> <span class="ow">and</span> <span class="n">hypothesis</span><span class="p">:</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis_cues</span> <span class="o">+=</span> <span class="n">cues</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="n">hypothesis</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">hypothesis</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.hypothesis.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.hypothesis.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">pseudo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preceding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">following</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">termination</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbs_hyp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbs_eds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">within_ents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explain</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.qualifiers.hypothesis.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">pseudo</span><span class="p">,</span> <span class="n">preceding</span><span class="p">,</span> <span class="n">following</span><span class="p">,</span> <span class="n">termination</span><span class="p">,</span> <span class="n">verbs_eds</span><span class="p">,</span> <span class="n">verbs_hyp</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">,</span> <span class="n">within_ents</span><span class="p">,</span> <span class="n">explain</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/hypothesis/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;hypothesis&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.hypothesis&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.hypothesis&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pseudo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">preceding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">following</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">verbs_eds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">verbs_hyp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">within_ents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">Hypothesis</span><span class="p">(</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
        <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
        <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
        <span class="n">verbs_eds</span><span class="o">=</span><span class="n">verbs_eds</span><span class="p">,</span>
        <span class="n">verbs_hyp</span><span class="o">=</span><span class="n">verbs_hyp</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
        <span class="n">within_ents</span><span class="o">=</span><span class="n">within_ents</span><span class="p">,</span>
        <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.hypothesis.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.hypothesis.patterns.pseudo" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pseudo</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;aucun doute&#39;</span><span class="p">,</span> <span class="s1">&#39;même si&#39;</span><span class="p">,</span> <span class="s1">&#39;pas de condition&#39;</span><span class="p">,</span> <span class="s1">&#39;pas de doute&#39;</span><span class="p">,</span> <span class="s1">&#39;sans aucun doute&#39;</span><span class="p">,</span> <span class="s1">&#39;sans condition&#39;</span><span class="p">,</span> <span class="s1">&#39;sans risque&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.hypothesis.patterns.confirmation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">confirmation</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;certain&#39;</span><span class="p">,</span> <span class="s1">&#39;certaine&#39;</span><span class="p">,</span> <span class="s1">&#39;certainement&#39;</span><span class="p">,</span> <span class="s1">&#39;certaines&#39;</span><span class="p">,</span> <span class="s1">&#39;certains&#39;</span><span class="p">,</span> <span class="s1">&#39;confirmer&#39;</span><span class="p">,</span> <span class="s1">&#39;évidemment&#39;</span><span class="p">,</span> <span class="s1">&#39;évident&#39;</span><span class="p">,</span> <span class="s1">&#39;évidente&#39;</span><span class="p">,</span> <span class="s1">&#39;montrer que&#39;</span><span class="p">,</span> <span class="s1">&#39;visiblement&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.hypothesis.patterns.preceding" class="doc doc-heading">
<code class="highlight language-python"><span class="n">preceding</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;à condition&#39;</span><span class="p">,</span> <span class="s1">&#39;à la condition que&#39;</span><span class="p">,</span> <span class="s1">&#39;à moins que&#39;</span><span class="p">,</span> <span class="s1">&#39;au cas où&#39;</span><span class="p">,</span> <span class="s1">&#39;conditionnellement&#39;</span><span class="p">,</span> <span class="s1">&#39;doute&#39;</span><span class="p">,</span> <span class="s1">&#39;en admettant que&#39;</span><span class="p">,</span> <span class="s1">&#39;en cas&#39;</span><span class="p">,</span> <span class="s1">&#39;en considérant que&#39;</span><span class="p">,</span> <span class="s1">&#39;en supposant que&#39;</span><span class="p">,</span> <span class="s1">&#39;éventuellement&#39;</span><span class="p">,</span> <span class="s1">&#39;faudrait&#39;</span><span class="p">,</span> <span class="s1">&#39;hypothèse&#39;</span><span class="p">,</span> <span class="s1">&#39;hypothèses&#39;</span><span class="p">,</span> <span class="s1">&#39;idée depas confirmer&#39;</span><span class="p">,</span> <span class="s1">&#39;pas sûr&#39;</span><span class="p">,</span> <span class="s1">&#39;pas sûre&#39;</span><span class="p">,</span> <span class="s1">&#39;peut correspondre&#39;</span><span class="p">,</span> <span class="s1">&#39;peut-être&#39;</span><span class="p">,</span> <span class="s1">&#39;peuvent correspondre&#39;</span><span class="p">,</span> <span class="s1">&#39;possible&#39;</span><span class="p">,</span> <span class="s1">&#39;possiblement&#39;</span><span class="p">,</span> <span class="s1">&#39;potentiel&#39;</span><span class="p">,</span> <span class="s1">&#39;potentielle&#39;</span><span class="p">,</span> <span class="s1">&#39;potentiellement&#39;</span><span class="p">,</span> <span class="s1">&#39;potentielles&#39;</span><span class="p">,</span> <span class="s1">&#39;potentiels&#39;</span><span class="p">,</span> <span class="s1">&#39;prédisposant à&#39;</span><span class="p">,</span> <span class="s1">&#39;probable&#39;</span><span class="p">,</span> <span class="s1">&#39;probablement&#39;</span><span class="p">,</span> <span class="s1">&#39;probables&#39;</span><span class="p">,</span> <span class="s2">&quot;recherche d&#39;recherche de&quot;</span><span class="p">,</span> <span class="s1">&#39;recherche des&#39;</span><span class="p">,</span> <span class="s1">&#39;risque&#39;</span><span class="p">,</span> <span class="s1">&#39;sauf si&#39;</span><span class="p">,</span> <span class="s1">&#39;selon&#39;</span><span class="p">,</span> <span class="s1">&#39;si&#39;</span><span class="p">,</span> <span class="s2">&quot;s&#39;il&quot;</span><span class="p">,</span> <span class="s1">&#39;soit&#39;</span><span class="p">,</span> <span class="s1">&#39;sous condition&#39;</span><span class="p">,</span> <span class="s1">&#39;sous réserve&#39;</span><span class="p">,</span> <span class="s1">&#39;suspicion&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.hypothesis.patterns.following" class="doc doc-heading">
<code class="highlight language-python"><span class="n">following</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;envisagé&#39;</span><span class="p">,</span> <span class="s1">&#39;envisageable&#39;</span><span class="p">,</span> <span class="s1">&#39;envisageables&#39;</span><span class="p">,</span> <span class="s1">&#39;envisagées&#39;</span><span class="p">,</span> <span class="s1">&#39;envisagés&#39;</span><span class="p">,</span> <span class="s1">&#39;hypothétique&#39;</span><span class="p">,</span> <span class="s1">&#39;hypothétiquement&#39;</span><span class="p">,</span> <span class="s1">&#39;hypothétiques&#39;</span><span class="p">,</span> <span class="s1">&#39;pas certain&#39;</span><span class="p">,</span> <span class="s1">&#39;pas certaine&#39;</span><span class="p">,</span> <span class="s1">&#39;pas clair&#39;</span><span class="p">,</span> <span class="s1">&#39;pas claire&#39;</span><span class="p">,</span> <span class="s1">&#39;pas confirmé&#39;</span><span class="p">,</span> <span class="s1">&#39;pas confirmée&#39;</span><span class="p">,</span> <span class="s1">&#39;pas confirmées&#39;</span><span class="p">,</span> <span class="s1">&#39;pas confirmés&#39;</span><span class="p">,</span> <span class="s1">&#39;pas évident&#39;</span><span class="p">,</span> <span class="s1">&#39;pas évidente&#39;</span><span class="p">,</span> <span class="s1">&#39;pas sûr&#39;</span><span class="p">,</span> <span class="s1">&#39;pas sûre&#39;</span><span class="p">,</span> <span class="s1">&#39;possible&#39;</span><span class="p">,</span> <span class="s1">&#39;potentiel&#39;</span><span class="p">,</span> <span class="s1">&#39;potentielle&#39;</span><span class="p">,</span> <span class="s1">&#39;potentiels&#39;</span><span class="p">,</span> <span class="s1">&#39;probable&#39;</span><span class="p">,</span> <span class="s1">&#39;probables&#39;</span><span class="p">,</span> <span class="s1">&#39;: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.hypothesis.patterns.verbs_hyp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verbs_hyp</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;douter&#39;</span><span class="p">,</span> <span class="s1">&#39;envisager&#39;</span><span class="p">,</span> <span class="s2">&quot;s&#39;apparenter&quot;</span><span class="p">,</span> <span class="s1">&#39;sembler&#39;</span><span class="p">,</span> <span class="s1">&#39;soupçonner&#39;</span><span class="p">,</span> <span class="s1">&#39;suggérer&#39;</span><span class="p">,</span> <span class="s1">&#39;suspecter&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.hypothesis.patterns.verbs_eds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verbs_eds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;abandonner&#39;</span><span class="p">,</span> <span class="s1">&#39;abolir&#39;</span><span class="p">,</span> <span class="s1">&#39;aborder&#39;</span><span class="p">,</span> <span class="s1">&#39;accepter&#39;</span><span class="p">,</span> <span class="s1">&#39;accidenter&#39;</span><span class="p">,</span> <span class="s1">&#39;accompagnemer&#39;</span><span class="p">,</span> <span class="s1">&#39;accompagner&#39;</span><span class="p">,</span> <span class="s1">&#39;acoller&#39;</span><span class="p">,</span> <span class="s1">&#39;acquérir&#39;</span><span class="p">,</span> <span class="s1">&#39;activer&#39;</span><span class="p">,</span> <span class="s1">&#39;actualiser&#39;</span><span class="p">,</span> <span class="s1">&#39;adapter&#39;</span><span class="p">,</span> <span class="s1">&#39;adhérer&#39;</span><span class="p">,</span> <span class="s1">&#39;adjuver&#39;</span><span class="p">,</span> <span class="s1">&#39;admettre&#39;</span><span class="p">,</span> <span class="s1">&#39;administrer&#39;</span><span class="p">,</span> <span class="s1">&#39;adopter&#39;</span><span class="p">,</span> <span class="s1">&#39;adresser&#39;</span><span class="p">,</span> <span class="s1">&#39;aggraver&#39;</span><span class="p">,</span> <span class="s1">&#39;agir&#39;</span><span class="p">,</span> <span class="s1">&#39;agréer&#39;</span><span class="p">,</span> <span class="s1">&#39;aider&#39;</span><span class="p">,</span> <span class="s1">&#39;aimer&#39;</span><span class="p">,</span> <span class="s1">&#39;alcooliser&#39;</span><span class="p">,</span> <span class="s1">&#39;alerter&#39;</span><span class="p">,</span> <span class="s1">&#39;alimenter&#39;</span><span class="p">,</span> <span class="s1">&#39;aller&#39;</span><span class="p">,</span> <span class="s1">&#39;allonger&#39;</span><span class="p">,</span> <span class="s1">&#39;alléger&#39;</span><span class="p">,</span> <span class="s1">&#39;alterner&#39;</span><span class="p">,</span> <span class="s1">&#39;altérer&#39;</span><span class="p">,</span> <span class="s1">&#39;amender&#39;</span><span class="p">,</span> <span class="s1">&#39;amener&#39;</span><span class="p">,</span> <span class="s1">&#39;améliorer&#39;</span><span class="p">,</span> <span class="s1">&#39;amyotrophier&#39;</span><span class="p">,</span> <span class="s1">&#39;améliorer&#39;</span><span class="p">,</span> <span class="s1">&#39;analyser&#39;</span><span class="p">,</span> <span class="s1">&#39;anesthésier&#39;</span><span class="p">,</span> <span class="s1">&#39;animer&#39;</span><span class="p">,</span> <span class="s1">&#39;annexer&#39;</span><span class="p">,</span> <span class="s1">&#39;annuler&#39;</span><span class="p">,</span> <span class="s1">&#39;anonymiser&#39;</span><span class="p">,</span> <span class="s1">&#39;anticiper&#39;</span><span class="p">,</span> <span class="s1">&#39;anticoaguler&#39;</span><span class="p">,</span> <span class="s1">&#39;apercevoir&#39;</span><span class="p">,</span> <span class="s1">&#39;aplatir&#39;</span><span class="p">,</span> <span class="s1">&#39;apparaître&#39;</span><span class="p">,</span> <span class="s1">&#39;appareiller&#39;</span><span class="p">,</span> <span class="s1">&#39;appeler&#39;</span><span class="p">,</span> <span class="s1">&#39;appliquer&#39;</span><span class="p">,</span> <span class="s1">&#39;apporter&#39;</span><span class="p">,</span> <span class="s1">&#39;apprendre&#39;</span><span class="p">,</span> <span class="s1">&#39;apprécier&#39;</span><span class="p">,</span> <span class="s1">&#39;appuyer&#39;</span><span class="p">,</span> <span class="s1">&#39;argumenter&#39;</span><span class="p">,</span> <span class="s1">&#39;arquer&#39;</span><span class="p">,</span> <span class="s1">&#39;arrêter&#39;</span><span class="p">,</span> <span class="s1">&#39;arriver&#39;</span><span class="p">,</span> <span class="s1">&#39;arrêter&#39;</span><span class="p">,</span> <span class="s1">&#39;articuler&#39;</span><span class="p">,</span> <span class="s1">&#39;aspirer&#39;</span><span class="p">,</span> <span class="s1">&#39;asseoir&#39;</span><span class="p">,</span> <span class="s1">&#39;assister&#39;</span><span class="p">,</span> <span class="s1">&#39;associer&#39;</span><span class="p">,</span> <span class="s1">&#39;assurer&#39;</span><span class="p">,</span> <span class="s1">&#39;assécher&#39;</span><span class="p">,</span> <span class="s1">&#39;attacher&#39;</span><span class="p">,</span> <span class="s1">&#39;atteindre&#39;</span><span class="p">,</span> <span class="s1">&#39;attendre&#39;</span><span class="p">,</span> <span class="s1">&#39;attribuer&#39;</span><span class="p">,</span> <span class="s1">&#39;augmenter&#39;</span><span class="p">,</span> <span class="s1">&#39;autonomiser&#39;</span><span class="p">,</span> <span class="s1">&#39;autoriser&#39;</span><span class="p">,</span> <span class="s1">&#39;avaler&#39;</span><span class="p">,</span> <span class="s1">&#39;avancer&#39;</span><span class="p">,</span> <span class="s1">&#39;avertir&#39;</span><span class="p">,</span> <span class="s1">&#39;avoir&#39;</span><span class="p">,</span> <span class="s1">&#39;avérer&#39;</span><span class="p">,</span> <span class="s1">&#39;aérer&#39;</span><span class="p">,</span> <span class="s1">&#39;baisser&#39;</span><span class="p">,</span> <span class="s1">&#39;ballonner&#39;</span><span class="p">,</span> <span class="s1">&#39;blesser&#39;</span><span class="p">,</span> <span class="s1">&#39;bloquer&#39;</span><span class="p">,</span> <span class="s1">&#39;boire&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">,</span> <span class="s1">&#39;brancher&#39;</span><span class="p">,</span> <span class="s1">&#39;brûler&#39;</span><span class="p">,</span> <span class="s1">&#39;bénéficier&#39;</span><span class="p">,</span> <span class="s1">&#39;cadrer&#39;</span><span class="p">,</span> <span class="s1">&#39;calcifier&#39;</span><span class="p">,</span> <span class="s1">&#39;calculer&#39;</span><span class="p">,</span> <span class="s1">&#39;calmer&#39;</span><span class="p">,</span> <span class="s1">&#39;canaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;capter&#39;</span><span class="p">,</span> <span class="s1">&#39;carencer&#39;</span><span class="p">,</span> <span class="s1">&#39;casser&#39;</span><span class="p">,</span> <span class="s1">&#39;centrer&#39;</span><span class="p">,</span> <span class="s1">&#39;cerner&#39;</span><span class="p">,</span> <span class="s1">&#39;certifier&#39;</span><span class="p">,</span> <span class="s1">&#39;changer&#39;</span><span class="p">,</span> <span class="s1">&#39;charger&#39;</span><span class="p">,</span> <span class="s1">&#39;chevaucher&#39;</span><span class="p">,</span> <span class="s1">&#39;choisir&#39;</span><span class="p">,</span> <span class="s1">&#39;chronomoduler&#39;</span><span class="p">,</span> <span class="s1">&#39;chuter&#39;</span><span class="p">,</span> <span class="s1">&#39;cicatriser&#39;</span><span class="p">,</span> <span class="s1">&#39;circoncire&#39;</span><span class="p">,</span> <span class="s1">&#39;circuler&#39;</span><span class="p">,</span> <span class="s1">&#39;classer&#39;</span><span class="p">,</span> <span class="s1">&#39;codéiner&#39;</span><span class="p">,</span> <span class="s1">&#39;coincer&#39;</span><span class="p">,</span> <span class="s1">&#39;colorer&#39;</span><span class="p">,</span> <span class="s1">&#39;combler&#39;</span><span class="p">,</span> <span class="s1">&#39;commander&#39;</span><span class="p">,</span> <span class="s1">&#39;commencer&#39;</span><span class="p">,</span> <span class="s1">&#39;communiquer&#39;</span><span class="p">,</span> <span class="s1">&#39;comparer&#39;</span><span class="p">,</span> <span class="s1">&#39;compliquer&#39;</span><span class="p">,</span> <span class="s1">&#39;compléter&#39;</span><span class="p">,</span> <span class="s1">&#39;comporter&#39;</span><span class="p">,</span> <span class="s1">&#39;comprendre&#39;</span><span class="p">,</span> <span class="s1">&#39;comprimer&#39;</span><span class="p">,</span> <span class="s1">&#39;concerner&#39;</span><span class="p">,</span> <span class="s1">&#39;conclure&#39;</span><span class="p">,</span> <span class="s1">&#39;condamner&#39;</span><span class="p">,</span> <span class="s1">&#39;conditionner&#39;</span><span class="p">,</span> <span class="s1">&#39;conduire&#39;</span><span class="p">,</span> <span class="s1">&#39;confiner&#39;</span><span class="p">,</span> <span class="s1">&#39;confirmer&#39;</span><span class="p">,</span> <span class="s1">&#39;confronter&#39;</span><span class="p">,</span> <span class="s1">&#39;congeler&#39;</span><span class="p">,</span> <span class="s1">&#39;conjoindre&#39;</span><span class="p">,</span> <span class="s1">&#39;conjuguer&#39;</span><span class="p">,</span> <span class="s1">&#39;connaître&#39;</span><span class="p">,</span> <span class="s1">&#39;connecter&#39;</span><span class="p">,</span> <span class="s1">&#39;conseiller&#39;</span><span class="p">,</span> <span class="s1">&#39;conserver&#39;</span><span class="p">,</span> <span class="s1">&#39;considérer&#39;</span><span class="p">,</span> <span class="s1">&#39;consommer&#39;</span><span class="p">,</span> <span class="s1">&#39;constater&#39;</span><span class="p">,</span> <span class="s1">&#39;constituer&#39;</span><span class="p">,</span> <span class="s1">&#39;consulter&#39;</span><span class="p">,</span> <span class="s1">&#39;contacter&#39;</span><span class="p">,</span> <span class="s1">&#39;contaminer&#39;</span><span class="p">,</span> <span class="s1">&#39;contenir&#39;</span><span class="p">,</span> <span class="s1">&#39;contentionner&#39;</span><span class="p">,</span> <span class="s1">&#39;continuer&#39;</span><span class="p">,</span> <span class="s1">&#39;contracter&#39;</span><span class="p">,</span> <span class="s1">&#39;contrarier&#39;</span><span class="p">,</span> <span class="s1">&#39;contribuer&#39;</span><span class="p">,</span> <span class="s1">&#39;contrôler&#39;</span><span class="p">,</span> <span class="s1">&#39;convaincre&#39;</span><span class="p">,</span> <span class="s1">&#39;convenir&#39;</span><span class="p">,</span> <span class="s1">&#39;convier&#39;</span><span class="p">,</span> <span class="s1">&#39;convoquer&#39;</span><span class="p">,</span> <span class="s1">&#39;copier&#39;</span><span class="p">,</span> <span class="s1">&#39;correspondre&#39;</span><span class="p">,</span> <span class="s1">&#39;corriger&#39;</span><span class="p">,</span> <span class="s1">&#39;corréler&#39;</span><span class="p">,</span> <span class="s1">&#39;coucher&#39;</span><span class="p">,</span> <span class="s1">&#39;coupler&#39;</span><span class="p">,</span> <span class="s1">&#39;couvrir&#39;</span><span class="p">,</span> <span class="s1">&#39;crapotter&#39;</span><span class="p">,</span> <span class="s1">&#39;creuser&#39;</span><span class="p">,</span> <span class="s1">&#39;croire&#39;</span><span class="p">,</span> <span class="s1">&#39;croiser&#39;</span><span class="p">,</span> <span class="s1">&#39;créer&#39;</span><span class="p">,</span> <span class="s1">&#39;crémer&#39;</span><span class="p">,</span> <span class="s1">&#39;crépiter&#39;</span><span class="p">,</span> <span class="s1">&#39;cumuler&#39;</span><span class="p">,</span> <span class="s1">&#39;curariser&#39;</span><span class="p">,</span> <span class="s1">&#39;céder&#39;</span><span class="p">,</span> <span class="s1">&#39;dater&#39;</span><span class="p">,</span> <span class="s1">&#39;demander&#39;</span><span class="p">,</span> <span class="s1">&#39;demeurer&#39;</span><span class="p">,</span> <span class="s1">&#39;destiner&#39;</span><span class="p">,</span> <span class="s1">&#39;devenir&#39;</span><span class="p">,</span> <span class="s1">&#39;devoir&#39;</span><span class="p">,</span> <span class="s1">&#39;diagnostiquer&#39;</span><span class="p">,</span> <span class="s1">&#39;dialyser&#39;</span><span class="p">,</span> <span class="s1">&#39;dicter&#39;</span><span class="p">,</span> <span class="s1">&#39;diffuser&#39;</span><span class="p">,</span> <span class="s1">&#39;différencier&#39;</span><span class="p">,</span> <span class="s1">&#39;différer&#39;</span><span class="p">,</span> <span class="s1">&#39;digérer&#39;</span><span class="p">,</span> <span class="s1">&#39;dilater&#39;</span><span class="p">,</span> <span class="s1">&#39;diluer&#39;</span><span class="p">,</span> <span class="s1">&#39;diminuer&#39;</span><span class="p">,</span> <span class="s1">&#39;diner&#39;</span><span class="p">,</span> <span class="s1">&#39;dire&#39;</span><span class="p">,</span> <span class="s1">&#39;diriger&#39;</span><span class="p">,</span> <span class="s1">&#39;discuter&#39;</span><span class="p">,</span> <span class="s1">&#39;disparaître&#39;</span><span class="p">,</span> <span class="s1">&#39;disposer&#39;</span><span class="p">,</span> <span class="s1">&#39;dissocier&#39;</span><span class="p">,</span> <span class="s1">&#39;disséminer&#39;</span><span class="p">,</span> <span class="s1">&#39;disséquer&#39;</span><span class="p">,</span> <span class="s1">&#39;distendre&#39;</span><span class="p">,</span> <span class="s1">&#39;distinguer&#39;</span><span class="p">,</span> <span class="s1">&#39;divorcer&#39;</span><span class="p">,</span> <span class="s1">&#39;documenter&#39;</span><span class="p">,</span> <span class="s1">&#39;donner&#39;</span><span class="p">,</span> <span class="s1">&#39;dorer&#39;</span><span class="p">,</span> <span class="s1">&#39;doser&#39;</span><span class="p">,</span> <span class="s1">&#39;doubler&#39;</span><span class="p">,</span> <span class="s1">&#39;durer&#39;</span><span class="p">,</span> <span class="s1">&#39;dyaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;dyspner&#39;</span><span class="p">,</span> <span class="s1">&#39;débuter&#39;</span><span class="p">,</span> <span class="s1">&#39;décaler&#39;</span><span class="p">,</span> <span class="s1">&#39;déceler&#39;</span><span class="p">,</span> <span class="s1">&#39;décider&#39;</span><span class="p">,</span> <span class="s1">&#39;déclarer&#39;</span><span class="p">,</span> <span class="s1">&#39;déclencher&#39;</span><span class="p">,</span> <span class="s1">&#39;découvrir&#39;</span><span class="p">,</span> <span class="s1">&#39;décrire&#39;</span><span class="p">,</span> <span class="s1">&#39;décroître&#39;</span><span class="p">,</span> <span class="s1">&#39;décurariser&#39;</span><span class="p">,</span> <span class="s1">&#39;décéder&#39;</span><span class="p">,</span> <span class="s1">&#39;dédier&#39;</span><span class="p">,</span> <span class="s1">&#39;définir&#39;</span><span class="p">,</span> <span class="s1">&#39;dégrader&#39;</span><span class="p">,</span> <span class="s1">&#39;délivrer&#39;</span><span class="p">,</span> <span class="s1">&#39;dépasser&#39;</span><span class="p">,</span> <span class="s1">&#39;dépendre&#39;</span><span class="p">,</span> <span class="s1">&#39;déplacer&#39;</span><span class="p">,</span> <span class="s1">&#39;dépolir&#39;</span><span class="p">,</span> <span class="s1">&#39;déposer&#39;</span><span class="p">,</span> <span class="s1">&#39;dériver&#39;</span><span class="p">,</span> <span class="s1">&#39;dérouler&#39;</span><span class="p">,</span> <span class="s1">&#39;désappareiller&#39;</span><span class="p">,</span> <span class="s1">&#39;désigner&#39;</span><span class="p">,</span> <span class="s1">&#39;désinfecter&#39;</span><span class="p">,</span> <span class="s1">&#39;désorienter&#39;</span><span class="p">,</span> <span class="s1">&#39;détecter&#39;</span><span class="p">,</span> <span class="s1">&#39;déterminer&#39;</span><span class="p">,</span> <span class="s1">&#39;détruire&#39;</span><span class="p">,</span> <span class="s1">&#39;développer&#39;</span><span class="p">,</span> <span class="s1">&#39;dévouer&#39;</span><span class="p">,</span> <span class="s1">&#39;dîner&#39;</span><span class="p">,</span> <span class="s1">&#39;écraser&#39;</span><span class="p">,</span> <span class="s1">&#39;effacer&#39;</span><span class="p">,</span> <span class="s1">&#39;effectuer&#39;</span><span class="p">,</span> <span class="s1">&#39;effondrer&#39;</span><span class="p">,</span> <span class="s1">&#39;emboliser&#39;</span><span class="p">,</span> <span class="s1">&#39;emmener&#39;</span><span class="p">,</span> <span class="s1">&#39;empêcher&#39;</span><span class="p">,</span> <span class="s1">&#39;encadrer&#39;</span><span class="p">,</span> <span class="s1">&#39;encourager&#39;</span><span class="p">,</span> <span class="s1">&#39;endormir&#39;</span><span class="p">,</span> <span class="s1">&#39;endurer&#39;</span><span class="p">,</span> <span class="s1">&#39;enlever&#39;</span><span class="p">,</span> <span class="s1">&#39;enregistrer&#39;</span><span class="p">,</span> <span class="s1">&#39;entamer&#39;</span><span class="p">,</span> <span class="s1">&#39;entendre&#39;</span><span class="p">,</span> <span class="s1">&#39;entourer&#39;</span><span class="p">,</span> <span class="s1">&#39;entraîner&#39;</span><span class="p">,</span> <span class="s1">&#39;entreprendre&#39;</span><span class="p">,</span> <span class="s1">&#39;entrer&#39;</span><span class="p">,</span> <span class="s1">&#39;envahir&#39;</span><span class="p">,</span> <span class="s1">&#39;envisager&#39;</span><span class="p">,</span> <span class="s1">&#39;envoyer&#39;</span><span class="p">,</span> <span class="s1">&#39;espérer&#39;</span><span class="p">,</span> <span class="s1">&#39;essayer&#39;</span><span class="p">,</span> <span class="s1">&#39;estimer&#39;</span><span class="p">,</span> <span class="s1">&#39;être&#39;</span><span class="p">,</span> <span class="s1">&#39;examiner&#39;</span><span class="p">,</span> <span class="s1">&#39;excentrer&#39;</span><span class="p">,</span> <span class="s1">&#39;exciser&#39;</span><span class="p">,</span> <span class="s1">&#39;exclure&#39;</span><span class="p">,</span> <span class="s1">&#39;expirer&#39;</span><span class="p">,</span> <span class="s1">&#39;expliquer&#39;</span><span class="p">,</span> <span class="s1">&#39;explorer&#39;</span><span class="p">,</span> <span class="s1">&#39;exposer&#39;</span><span class="p">,</span> <span class="s1">&#39;exprimer&#39;</span><span class="p">,</span> <span class="s1">&#39;extérioriser&#39;</span><span class="p">,</span> <span class="s1">&#39;exécuter&#39;</span><span class="p">,</span> <span class="s1">&#39;faciliter&#39;</span><span class="p">,</span> <span class="s1">&#39;faire&#39;</span><span class="p">,</span> <span class="s1">&#39;fatiguer&#39;</span><span class="p">,</span> <span class="s1">&#39;favoriser&#39;</span><span class="p">,</span> <span class="s1">&#39;faxer&#39;</span><span class="p">,</span> <span class="s1">&#39;fermer&#39;</span><span class="p">,</span> <span class="s1">&#39;figurer&#39;</span><span class="p">,</span> <span class="s1">&#39;fixer&#39;</span><span class="p">,</span> <span class="s1">&#39;focaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;foncer&#39;</span><span class="p">,</span> <span class="s1">&#39;former&#39;</span><span class="p">,</span> <span class="s1">&#39;fournir&#39;</span><span class="p">,</span> <span class="s1">&#39;fractionner&#39;</span><span class="p">,</span> <span class="s1">&#39;fragmenter&#39;</span><span class="p">,</span> <span class="s1">&#39;fuiter&#39;</span><span class="p">,</span> <span class="s1">&#39;fusionner&#39;</span><span class="p">,</span> <span class="s1">&#39;garder&#39;</span><span class="p">,</span> <span class="s1">&#39;graver&#39;</span><span class="p">,</span> <span class="s1">&#39;guider&#39;</span><span class="p">,</span> <span class="s1">&#39;gérer&#39;</span><span class="p">,</span> <span class="s1">&#39;gêner&#39;</span><span class="p">,</span> <span class="s1">&#39;honorer&#39;</span><span class="p">,</span> <span class="s1">&#39;hopsitaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;hospitaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrater&#39;</span><span class="p">,</span> <span class="s1">&#39;hyperartérialiser&#39;</span><span class="p">,</span> <span class="s1">&#39;hyperfixer&#39;</span><span class="p">,</span> <span class="s1">&#39;hypertrophier&#39;</span><span class="p">,</span> <span class="s1">&#39;hésiter&#39;</span><span class="p">,</span> <span class="s1">&#39;identifier&#39;</span><span class="p">,</span> <span class="s1">&#39;illustrer&#39;</span><span class="p">,</span> <span class="s1">&#39;immuniser&#39;</span><span class="p">,</span> <span class="s1">&#39;impacter&#39;</span><span class="p">,</span> <span class="s1">&#39;implanter&#39;</span><span class="p">,</span> <span class="s1">&#39;impliquer&#39;</span><span class="p">,</span> <span class="s1">&#39;importer&#39;</span><span class="p">,</span> <span class="s1">&#39;imposer&#39;</span><span class="p">,</span> <span class="s1">&#39;impregner&#39;</span><span class="p">,</span> <span class="s1">&#39;imprimer&#39;</span><span class="p">,</span> <span class="s1">&#39;inclure&#39;</span><span class="p">,</span> <span class="s1">&#39;indifferencier&#39;</span><span class="p">,</span> <span class="s1">&#39;indiquer&#39;</span><span class="p">,</span> <span class="s1">&#39;infecter&#39;</span><span class="p">,</span> <span class="s1">&#39;infertiliser&#39;</span><span class="p">,</span> <span class="s1">&#39;infiltrer&#39;</span><span class="p">,</span> <span class="s1">&#39;informer&#39;</span><span class="p">,</span> <span class="s1">&#39;inhaler&#39;</span><span class="p">,</span> <span class="s1">&#39;initier&#39;</span><span class="p">,</span> <span class="s1">&#39;injecter&#39;</span><span class="p">,</span> <span class="s1">&#39;inscrire&#39;</span><span class="p">,</span> <span class="s1">&#39;insister&#39;</span><span class="p">,</span> <span class="s1">&#39;installer&#39;</span><span class="p">,</span> <span class="s1">&#39;interdire&#39;</span><span class="p">,</span> <span class="s1">&#39;interpréter&#39;</span><span class="p">,</span> <span class="s1">&#39;interrompre&#39;</span><span class="p">,</span> <span class="s1">&#39;intervenir&#39;</span><span class="p">,</span> <span class="s1">&#39;intituler&#39;</span><span class="p">,</span> <span class="s1">&#39;introduire&#39;</span><span class="p">,</span> <span class="s1">&#39;intéragir&#39;</span><span class="p">,</span> <span class="s1">&#39;inverser&#39;</span><span class="p">,</span> <span class="s1">&#39;inviter&#39;</span><span class="p">,</span> <span class="s1">&#39;ioder&#39;</span><span class="p">,</span> <span class="s1">&#39;ioniser&#39;</span><span class="p">,</span> <span class="s1">&#39;irradier&#39;</span><span class="p">,</span> <span class="s1">&#39;itérativer&#39;</span><span class="p">,</span> <span class="s1">&#39;joindre&#39;</span><span class="p">,</span> <span class="s1">&#39;juger&#39;</span><span class="p">,</span> <span class="s1">&#39;justifier&#39;</span><span class="p">,</span> <span class="s1">&#39;laisser&#39;</span><span class="p">,</span> <span class="s1">&#39;laminer&#39;</span><span class="p">,</span> <span class="s1">&#39;lancer&#39;</span><span class="p">,</span> <span class="s1">&#39;latéraliser&#39;</span><span class="p">,</span> <span class="s1">&#39;laver&#39;</span><span class="p">,</span> <span class="s1">&#39;lever&#39;</span><span class="p">,</span> <span class="s1">&#39;lier&#39;</span><span class="p">,</span> <span class="s1">&#39;ligaturer&#39;</span><span class="p">,</span> <span class="s1">&#39;limiter&#39;</span><span class="p">,</span> <span class="s1">&#39;lire&#39;</span><span class="p">,</span> <span class="s1">&#39;localiser&#39;</span><span class="p">,</span> <span class="s1">&#39;loger&#39;</span><span class="p">,</span> <span class="s1">&#39;louper&#39;</span><span class="p">,</span> <span class="s1">&#39;luire&#39;</span><span class="p">,</span> <span class="s1">&#39;lutter&#39;</span><span class="p">,</span> <span class="s1">&#39;lyricer&#39;</span><span class="p">,</span> <span class="s1">&#39;lyser&#39;</span><span class="p">,</span> <span class="s1">&#39;maculer&#39;</span><span class="p">,</span> <span class="s1">&#39;macérer&#39;</span><span class="p">,</span> <span class="s1">&#39;maintenir&#39;</span><span class="p">,</span> <span class="s1">&#39;majorer&#39;</span><span class="p">,</span> <span class="s1">&#39;malaiser&#39;</span><span class="p">,</span> <span class="s1">&#39;manger&#39;</span><span class="p">,</span> <span class="s1">&#39;manifester&#39;</span><span class="p">,</span> <span class="s1">&#39;manipuler&#39;</span><span class="p">,</span> <span class="s1">&#39;manquer&#39;</span><span class="p">,</span> <span class="s1">&#39;marcher&#39;</span><span class="p">,</span> <span class="s1">&#39;marier&#39;</span><span class="p">,</span> <span class="s1">&#39;marmoner&#39;</span><span class="p">,</span> <span class="s1">&#39;marquer&#39;</span><span class="p">,</span> <span class="s1">&#39;masquer&#39;</span><span class="p">,</span> <span class="s1">&#39;masser&#39;</span><span class="p">,</span> <span class="s1">&#39;mater&#39;</span><span class="p">,</span> <span class="s1">&#39;mener&#39;</span><span class="p">,</span> <span class="s1">&#39;mesurer&#39;</span><span class="p">,</span> <span class="s1">&#39;meteoriser&#39;</span><span class="p">,</span> <span class="s1">&#39;mettre&#39;</span><span class="p">,</span> <span class="s1">&#39;mitiger&#39;</span><span class="p">,</span> <span class="s1">&#39;modifier&#39;</span><span class="p">,</span> <span class="s1">&#39;moduler&#39;</span><span class="p">,</span> <span class="s1">&#39;modérer&#39;</span><span class="p">,</span> <span class="s1">&#39;monter&#39;</span><span class="p">,</span> <span class="s1">&#39;montrer&#39;</span><span class="p">,</span> <span class="s1">&#39;motiver&#39;</span><span class="p">,</span> <span class="s1">&#39;moucheter&#39;</span><span class="p">,</span> <span class="s1">&#39;mouler&#39;</span><span class="p">,</span> <span class="s1">&#39;mourir&#39;</span><span class="p">,</span> <span class="s1">&#39;multiopéréer&#39;</span><span class="p">,</span> <span class="s1">&#39;munir&#39;</span><span class="p">,</span> <span class="s1">&#39;muter&#39;</span><span class="p">,</span> <span class="s1">&#39;médicaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;météoriser&#39;</span><span class="p">,</span> <span class="s1">&#39;naître&#39;</span><span class="p">,</span> <span class="s1">&#39;normaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;noter&#39;</span><span class="p">,</span> <span class="s1">&#39;nuire&#39;</span><span class="p">,</span> <span class="s1">&#39;numériser&#39;</span><span class="p">,</span> <span class="s1">&#39;nécessiter&#39;</span><span class="p">,</span> <span class="s1">&#39;négativer&#39;</span><span class="p">,</span> <span class="s1">&#39;objectiver&#39;</span><span class="p">,</span> <span class="s1">&#39;observer&#39;</span><span class="p">,</span> <span class="s1">&#39;obstruer&#39;</span><span class="p">,</span> <span class="s1">&#39;obtenir&#39;</span><span class="p">,</span> <span class="s1">&#39;occasionner&#39;</span><span class="p">,</span> <span class="s1">&#39;occuper&#39;</span><span class="p">,</span> <span class="s1">&#39;opposer&#39;</span><span class="p">,</span> <span class="s1">&#39;opérer&#39;</span><span class="p">,</span> <span class="s1">&#39;organiser&#39;</span><span class="p">,</span> <span class="s1">&#39;orienter&#39;</span><span class="p">,</span> <span class="s1">&#39;ouvrir&#39;</span><span class="p">,</span> <span class="s1">&#39;palper&#39;</span><span class="p">,</span> <span class="s1">&#39;parasiter&#39;</span><span class="p">,</span> <span class="s1">&#39;paraître&#39;</span><span class="p">,</span> <span class="s1">&#39;parcourir&#39;</span><span class="p">,</span> <span class="s1">&#39;parer&#39;</span><span class="p">,</span> <span class="s1">&#39;paresthésier&#39;</span><span class="p">,</span> <span class="s1">&#39;parfaire&#39;</span><span class="p">,</span> <span class="s1">&#39;partager&#39;</span><span class="p">,</span> <span class="s1">&#39;partir&#39;</span><span class="p">,</span> <span class="s1">&#39;parvenir&#39;</span><span class="p">,</span> <span class="s1">&#39;passer&#39;</span><span class="p">,</span> <span class="s1">&#39;penser&#39;</span><span class="p">,</span> <span class="s1">&#39;percevoir&#39;</span><span class="p">,</span> <span class="s1">&#39;perdre&#39;</span><span class="p">,</span> <span class="s1">&#39;perforer&#39;</span><span class="p">,</span> <span class="s1">&#39;permettre&#39;</span><span class="p">,</span> <span class="s1">&#39;persister&#39;</span><span class="p">,</span> <span class="s1">&#39;personnaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;peser&#39;</span><span class="p">,</span> <span class="s1">&#39;pigmenter&#39;</span><span class="p">,</span> <span class="s1">&#39;piloter&#39;</span><span class="p">,</span> <span class="s1">&#39;placer&#39;</span><span class="p">,</span> <span class="s1">&#39;plaindre&#39;</span><span class="p">,</span> <span class="s1">&#39;planifier&#39;</span><span class="p">,</span> <span class="s1">&#39;plier&#39;</span><span class="p">,</span> <span class="s1">&#39;plonger&#39;</span><span class="p">,</span> <span class="s1">&#39;porter&#39;</span><span class="p">,</span> <span class="s1">&#39;poser&#39;</span><span class="p">,</span> <span class="s1">&#39;positionner&#39;</span><span class="p">,</span> <span class="s1">&#39;posséder&#39;</span><span class="p">,</span> <span class="s1">&#39;poursuivre&#39;</span><span class="p">,</span> <span class="s1">&#39;pousser&#39;</span><span class="p">,</span> <span class="s1">&#39;pouvoir&#39;</span><span class="p">,</span> <span class="s1">&#39;pratiquer&#39;</span><span class="p">,</span> <span class="s1">&#39;preciser&#39;</span><span class="p">,</span> <span class="s1">&#39;prendre&#39;</span><span class="p">,</span> <span class="s1">&#39;prescrire&#39;</span><span class="p">,</span> <span class="s1">&#39;prier&#39;</span><span class="p">,</span> <span class="s1">&#39;produire&#39;</span><span class="p">,</span> <span class="s1">&#39;programmer&#39;</span><span class="p">,</span> <span class="s1">&#39;prolonger&#39;</span><span class="p">,</span> <span class="s1">&#39;prononcer&#39;</span><span class="p">,</span> <span class="s1">&#39;proposer&#39;</span><span class="p">,</span> <span class="s1">&#39;prouver&#39;</span><span class="p">,</span> <span class="s1">&#39;provoquer&#39;</span><span class="p">,</span> <span class="s1">&#39;préciser&#39;</span><span class="p">,</span> <span class="s1">&#39;précéder&#39;</span><span class="p">,</span> <span class="s1">&#39;prédominer&#39;</span><span class="p">,</span> <span class="s1">&#39;préexister&#39;</span><span class="p">,</span> <span class="s1">&#39;préférer&#39;</span><span class="p">,</span> <span class="s1">&#39;prélever&#39;</span><span class="p">,</span> <span class="s1">&#39;préparer&#39;</span><span class="p">,</span> <span class="s1">&#39;présenter&#39;</span><span class="p">,</span> <span class="s1">&#39;préserver&#39;</span><span class="p">,</span> <span class="s1">&#39;prévenir&#39;</span><span class="p">,</span> <span class="s1">&#39;prévoir&#39;</span><span class="p">,</span> <span class="s1">&#39;puruler&#39;</span><span class="p">,</span> <span class="s1">&#39;pénétrer&#39;</span><span class="p">,</span> <span class="s1">&#39;radiofréquencer&#39;</span><span class="p">,</span> <span class="s1">&#39;ralentir&#39;</span><span class="p">,</span> <span class="s1">&#39;ramener&#39;</span><span class="p">,</span> <span class="s1">&#39;rappeler&#39;</span><span class="p">,</span> <span class="s1">&#39;rapporter&#39;</span><span class="p">,</span> <span class="s1">&#39;rapprocher&#39;</span><span class="p">,</span> <span class="s1">&#39;rassurer&#39;</span><span class="p">,</span> <span class="s1">&#39;rattacher&#39;</span><span class="p">,</span> <span class="s1">&#39;rattraper&#39;</span><span class="p">,</span> <span class="s1">&#39;realiser&#39;</span><span class="p">,</span> <span class="s1">&#39;recenser&#39;</span><span class="p">,</span> <span class="s1">&#39;recevoir&#39;</span><span class="p">,</span> <span class="s1">&#39;rechercher&#39;</span><span class="p">,</span> <span class="s1">&#39;recommander&#39;</span><span class="p">,</span> <span class="s1">&#39;reconnaître&#39;</span><span class="p">,</span> <span class="s1">&#39;reconsulter&#39;</span><span class="p">,</span> <span class="s1">&#39;recontacter&#39;</span><span class="p">,</span> <span class="s1">&#39;recontrôler&#39;</span><span class="p">,</span> <span class="s1">&#39;reconvoquer&#39;</span><span class="p">,</span> <span class="s1">&#39;recouvrir&#39;</span><span class="p">,</span> <span class="s1">&#39;recueillir&#39;</span><span class="p">,</span> <span class="s1">&#39;recuperer&#39;</span><span class="p">,</span> <span class="s1">&#39;redescendre&#39;</span><span class="p">,</span> <span class="s1">&#39;rediscuter&#39;</span><span class="p">,</span> <span class="s1">&#39;refaire&#39;</span><span class="p">,</span> <span class="s1">&#39;refouler&#39;</span><span class="p">,</span> <span class="s1">&#39;refuser&#39;</span><span class="p">,</span> <span class="s1">&#39;regarder&#39;</span><span class="p">,</span> <span class="s1">&#39;rehausser&#39;</span><span class="p">,</span> <span class="s1">&#39;relancer&#39;</span><span class="p">,</span> <span class="s1">&#39;relayer&#39;</span><span class="p">,</span> <span class="s1">&#39;relever&#39;</span><span class="p">,</span> <span class="s1">&#39;relire&#39;</span><span class="p">,</span> <span class="s1">&#39;relâcher&#39;</span><span class="p">,</span> <span class="s1">&#39;remanier&#39;</span><span class="p">,</span> <span class="s1">&#39;remarquer&#39;</span><span class="p">,</span> <span class="s1">&#39;remercier&#39;</span><span class="p">,</span> <span class="s1">&#39;remettre&#39;</span><span class="p">,</span> <span class="s1">&#39;remonter&#39;</span><span class="p">,</span> <span class="s1">&#39;remplacer&#39;</span><span class="p">,</span> <span class="s1">&#39;remplir&#39;</span><span class="p">,</span> <span class="s1">&#39;rencontrer&#39;</span><span class="p">,</span> <span class="s1">&#39;rendormir&#39;</span><span class="p">,</span> <span class="s1">&#39;rendre&#39;</span><span class="p">,</span> <span class="s1">&#39;renfermer&#39;</span><span class="p">,</span> <span class="s1">&#39;renforcer&#39;</span><span class="p">,</span> <span class="s1">&#39;renouveler&#39;</span><span class="p">,</span> <span class="s1">&#39;renseigner&#39;</span><span class="p">,</span> <span class="s1">&#39;rentrer&#39;</span><span class="p">,</span> <span class="s1">&#39;reparler&#39;</span><span class="p">,</span> <span class="s1">&#39;repasser&#39;</span><span class="p">,</span> <span class="s1">&#39;reporter&#39;</span><span class="p">,</span> <span class="s1">&#39;reprendre&#39;</span><span class="p">,</span> <span class="s1">&#39;represcrire&#39;</span><span class="p">,</span> <span class="s1">&#39;reproduire&#39;</span><span class="p">,</span> <span class="s1">&#39;reprogrammer&#39;</span><span class="p">,</span> <span class="s1">&#39;représenter&#39;</span><span class="p">,</span> <span class="s1">&#39;repérer&#39;</span><span class="p">,</span> <span class="s1">&#39;requérir&#39;</span><span class="p">,</span> <span class="s1">&#39;respecter&#39;</span><span class="p">,</span> <span class="s1">&#39;ressembler&#39;</span><span class="p">,</span> <span class="s1">&#39;ressentir&#39;</span><span class="p">,</span> <span class="s1">&#39;rester&#39;</span><span class="p">,</span> <span class="s1">&#39;restreindre&#39;</span><span class="p">,</span> <span class="s1">&#39;retarder&#39;</span><span class="p">,</span> <span class="s1">&#39;retenir&#39;</span><span class="p">,</span> <span class="s1">&#39;retirer&#39;</span><span class="p">,</span> <span class="s1">&#39;retrouver&#39;</span><span class="p">,</span> <span class="s1">&#39;revasculariser&#39;</span><span class="p">,</span> <span class="s1">&#39;revenir&#39;</span><span class="p">,</span> <span class="s1">&#39;reverticaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;revoir&#39;</span><span class="p">,</span> <span class="s1">&#39;rompre&#39;</span><span class="p">,</span> <span class="s1">&#39;rouler&#39;</span><span class="p">,</span> <span class="s1">&#39;réadapter&#39;</span><span class="p">,</span> <span class="s1">&#39;réadmettre&#39;</span><span class="p">,</span> <span class="s1">&#39;réadresser&#39;</span><span class="p">,</span> <span class="s1">&#39;réaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;récidiver&#39;</span><span class="p">,</span> <span class="s1">&#39;récupérer&#39;</span><span class="p">,</span> <span class="s1">&#39;rédiger&#39;</span><span class="p">,</span> <span class="s1">&#39;réduire&#39;</span><span class="p">,</span> <span class="s1">&#39;réessayer&#39;</span><span class="p">,</span> <span class="s1">&#39;réexpliquer&#39;</span><span class="p">,</span> <span class="s1">&#39;référer&#39;</span><span class="p">,</span> <span class="s1">&#39;régler&#39;</span><span class="p">,</span> <span class="s1">&#39;régresser&#39;</span><span class="p">,</span> <span class="s1">&#39;réhausser&#39;</span><span class="p">,</span> <span class="s1">&#39;réopérer&#39;</span><span class="p">,</span> <span class="s1">&#39;répartir&#39;</span><span class="p">,</span> <span class="s1">&#39;répondre&#39;</span><span class="p">,</span> <span class="s1">&#39;répéter&#39;</span><span class="p">,</span> <span class="s1">&#39;réserver&#39;</span><span class="p">,</span> <span class="s1">&#39;résorber&#39;</span><span class="p">,</span> <span class="s1">&#39;résoudre&#39;</span><span class="p">,</span> <span class="s1">&#39;réséquer&#39;</span><span class="p">,</span> <span class="s1">&#39;réveiller&#39;</span><span class="p">,</span> <span class="s1">&#39;révéler&#39;</span><span class="p">,</span> <span class="s1">&#39;réévaluer&#39;</span><span class="p">,</span> <span class="s1">&#39;rêver&#39;</span><span class="p">,</span> <span class="s1">&#39;sacrer&#39;</span><span class="p">,</span> <span class="s1">&#39;saisir&#39;</span><span class="p">,</span> <span class="s1">&#39;satisfaire&#39;</span><span class="p">,</span> <span class="s1">&#39;savoir&#39;</span><span class="p">,</span> <span class="s1">&#39;scanner&#39;</span><span class="p">,</span> <span class="s1">&#39;scolariser&#39;</span><span class="p">,</span> <span class="s1">&#39;sembler&#39;</span><span class="p">,</span> <span class="s1">&#39;sensibiliser&#39;</span><span class="p">,</span> <span class="s1">&#39;sentir&#39;</span><span class="p">,</span> <span class="s1">&#39;serrer&#39;</span><span class="p">,</span> <span class="s1">&#39;servir&#39;</span><span class="p">,</span> <span class="s1">&#39;sevrer&#39;</span><span class="p">,</span> <span class="s1">&#39;signaler&#39;</span><span class="p">,</span> <span class="s1">&#39;signer&#39;</span><span class="p">,</span> <span class="s1">&#39;situer&#39;</span><span class="p">,</span> <span class="s1">&#39;siéger&#39;</span><span class="p">,</span> <span class="s1">&#39;soigner&#39;</span><span class="p">,</span> <span class="s1">&#39;sommeiller&#39;</span><span class="p">,</span> <span class="s1">&#39;sonder&#39;</span><span class="p">,</span> <span class="s1">&#39;sortir&#39;</span><span class="p">,</span> <span class="s1">&#39;souffler&#39;</span><span class="p">,</span> <span class="s1">&#39;souhaiter&#39;</span><span class="p">,</span> <span class="s1">&#39;soulager&#39;</span><span class="p">,</span> <span class="s1">&#39;soussigner&#39;</span><span class="p">,</span> <span class="s1">&#39;souvenir&#39;</span><span class="p">,</span> <span class="s1">&#39;spécialiser&#39;</span><span class="p">,</span> <span class="s1">&#39;stabiliser&#39;</span><span class="p">,</span> <span class="s1">&#39;statuer&#39;</span><span class="p">,</span> <span class="s1">&#39;stenter&#39;</span><span class="p">,</span> <span class="s1">&#39;stopper&#39;</span><span class="p">,</span> <span class="s1">&#39;stratifier&#39;</span><span class="p">,</span> <span class="s1">&#39;subir&#39;</span><span class="p">,</span> <span class="s1">&#39;substituer&#39;</span><span class="p">,</span> <span class="s1">&#39;sucrer&#39;</span><span class="p">,</span> <span class="s1">&#39;suggérer&#39;</span><span class="p">,</span> <span class="s1">&#39;suivre&#39;</span><span class="p">,</span> <span class="s1">&#39;supporter&#39;</span><span class="p">,</span> <span class="s1">&#39;supprimer&#39;</span><span class="p">,</span> <span class="s1">&#39;surajouter&#39;</span><span class="p">,</span> <span class="s1">&#39;surmonter&#39;</span><span class="p">,</span> <span class="s1">&#39;surveiller&#39;</span><span class="p">,</span> <span class="s1">&#39;survenir&#39;</span><span class="p">,</span> <span class="s1">&#39;suspecter&#39;</span><span class="p">,</span> <span class="s1">&#39;suspendre&#39;</span><span class="p">,</span> <span class="s1">&#39;suturer&#39;</span><span class="p">,</span> <span class="s1">&#39;synchroniser&#39;</span><span class="p">,</span> <span class="s1">&#39;systématiser&#39;</span><span class="p">,</span> <span class="s1">&#39;sécréter&#39;</span><span class="p">,</span> <span class="s1">&#39;sécuriser&#39;</span><span class="p">,</span> <span class="s1">&#39;sédater&#39;</span><span class="p">,</span> <span class="s1">&#39;séjourner&#39;</span><span class="p">,</span> <span class="s1">&#39;séparer&#39;</span><span class="p">,</span> <span class="s1">&#39;taire&#39;</span><span class="p">,</span> <span class="s1">&#39;taper&#39;</span><span class="p">,</span> <span class="s1">&#39;teinter&#39;</span><span class="p">,</span> <span class="s1">&#39;tendre&#39;</span><span class="p">,</span> <span class="s1">&#39;tenir&#39;</span><span class="p">,</span> <span class="s1">&#39;tenter&#39;</span><span class="p">,</span> <span class="s1">&#39;terminer&#39;</span><span class="p">,</span> <span class="s1">&#39;tester&#39;</span><span class="p">,</span> <span class="s1">&#39;thromboser&#39;</span><span class="p">,</span> <span class="s1">&#39;tirer&#39;</span><span class="p">,</span> <span class="s1">&#39;tiroir&#39;</span><span class="p">,</span> <span class="s1">&#39;tissulaire&#39;</span><span class="p">,</span> <span class="s1">&#39;titulariser&#39;</span><span class="p">,</span> <span class="s1">&#39;tolérer&#39;</span><span class="p">,</span> <span class="s1">&#39;tourner&#39;</span><span class="p">,</span> <span class="s1">&#39;tracer&#39;</span><span class="p">,</span> <span class="s1">&#39;trachéotomiser&#39;</span><span class="p">,</span> <span class="s1">&#39;traduire&#39;</span><span class="p">,</span> <span class="s1">&#39;traiter&#39;</span><span class="p">,</span> <span class="s1">&#39;transcrire&#39;</span><span class="p">,</span> <span class="s1">&#39;transférer&#39;</span><span class="p">,</span> <span class="s1">&#39;transmettre&#39;</span><span class="p">,</span> <span class="s1">&#39;transporter&#39;</span><span class="p">,</span> <span class="s1">&#39;trasnfixer&#39;</span><span class="p">,</span> <span class="s1">&#39;travailler&#39;</span><span class="p">,</span> <span class="s1">&#39;tronquer&#39;</span><span class="p">,</span> <span class="s1">&#39;trouver&#39;</span><span class="p">,</span> <span class="s1">&#39;téléphoner&#39;</span><span class="p">,</span> <span class="s1">&#39;ulcérer&#39;</span><span class="p">,</span> <span class="s1">&#39;uriner&#39;</span><span class="p">,</span> <span class="s1">&#39;utiliser&#39;</span><span class="p">,</span> <span class="s1">&#39;vacciner&#39;</span><span class="p">,</span> <span class="s1">&#39;valider&#39;</span><span class="p">,</span> <span class="s1">&#39;valoir&#39;</span><span class="p">,</span> <span class="s1">&#39;varier&#39;</span><span class="p">,</span> <span class="s1">&#39;vasculariser&#39;</span><span class="p">,</span> <span class="s1">&#39;venir&#39;</span><span class="p">,</span> <span class="s1">&#39;verifier&#39;</span><span class="p">,</span> <span class="s1">&#39;vieillir&#39;</span><span class="p">,</span> <span class="s1">&#39;viser&#39;</span><span class="p">,</span> <span class="s1">&#39;visualiser&#39;</span><span class="p">,</span> <span class="s1">&#39;vivre&#39;</span><span class="p">,</span> <span class="s1">&#39;voir&#39;</span><span class="p">,</span> <span class="s1">&#39;vouloir&#39;</span><span class="p">,</span> <span class="s1">&#39;vérifier&#39;</span><span class="p">,</span> <span class="s1">&#39;ébaucher&#39;</span><span class="p">,</span> <span class="s1">&#39;écarter&#39;</span><span class="p">,</span> <span class="s1">&#39;échographier&#39;</span><span class="p">,</span> <span class="s1">&#39;échoguider&#39;</span><span class="p">,</span> <span class="s1">&#39;échoir&#39;</span><span class="p">,</span> <span class="s1">&#39;échouer&#39;</span><span class="p">,</span> <span class="s1">&#39;éclairer&#39;</span><span class="p">,</span> <span class="s1">&#39;écraser&#39;</span><span class="p">,</span> <span class="s1">&#39;élargir&#39;</span><span class="p">,</span> <span class="s1">&#39;éliminer&#39;</span><span class="p">,</span> <span class="s1">&#39;émousser&#39;</span><span class="p">,</span> <span class="s1">&#39;épaissir&#39;</span><span class="p">,</span> <span class="s1">&#39;épargner&#39;</span><span class="p">,</span> <span class="s1">&#39;épuiser&#39;</span><span class="p">,</span> <span class="s1">&#39;épurer&#39;</span><span class="p">,</span> <span class="s1">&#39;équilibrer&#39;</span><span class="p">,</span> <span class="s1">&#39;établir&#39;</span><span class="p">,</span> <span class="s1">&#39;étager&#39;</span><span class="p">,</span> <span class="s1">&#39;étendre&#39;</span><span class="p">,</span> <span class="s1">&#39;étiqueter&#39;</span><span class="p">,</span> <span class="s1">&#39;étrangler&#39;</span><span class="p">,</span> <span class="s1">&#39;évaluer&#39;</span><span class="p">,</span> <span class="s1">&#39;éviter&#39;</span><span class="p">,</span> <span class="s1">&#39;évoluer&#39;</span><span class="p">,</span> <span class="s1">&#39;évoquer&#39;</span><span class="p">,</span> <span class="s1">&#39;être&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.qualifiers.family" class="doc doc-heading">
        <code>family</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.family.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.family.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">termination</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">use_sections</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explain</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.qualifiers.family.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="n">termination</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">explain</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">,</span> <span class="n">use_sections</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/family/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.family&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.family&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">family</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">use_sections</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">FamilyContext</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">family</span><span class="o">=</span><span class="n">family</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
        <span class="n">use_sections</span><span class="o">=</span><span class="n">use_sections</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.family.family" class="doc doc-heading">
        <code>family</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.qualifiers.family.family.FamilyContext" class="doc doc-heading">
          <code>FamilyContext</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.qualifiers.base.Qualifier" href="pipelines/qualifiers/base/#edsnlp.pipelines.qualifiers.base.Qualifier">Qualifier</a></code></p>


      <p>Implements a family context detection algorithm.</p>
<p>The components looks for terms indicating family references in the text.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy nlp pipeline to use for matching.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>family</code></td>
          <td class="doc-param-details">
            <p>List of terms indicating family reference.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>terminations</code></td>
          <td class="doc-param-details">
            <p>List of termination terms, to separate syntagmas.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>spaCy's attribute to use:
a string with the value "TEXT" or "NORM", or a dict with the key 'term_attr'
we can also add a key for each regex.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>on_ents_only</code></td>
          <td class="doc-param-details">
            <p>Whether to look for matches around detected entities only.
Useful for faster inference in downstream tasks.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>regex</code></td>
          <td class="doc-param-details">
            <p>A dictionnary of regex patterns.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Dict[str, Union[List[str], str]]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>explain</code></td>
          <td class="doc-param-details">
            <p>Whether to keep track of cues for each entity.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>use_sections</code></td>
          <td class="doc-param-details">
            <p>Whether to use annotated sections (namely <code>antécédents familiaux</code>).</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool, by default </code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/qualifiers/family/family.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">FamilyContext</span><span class="p">(</span><span class="n">Qualifier</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements a family context detection algorithm.</span>

<span class="sd">    The components looks for terms indicating family references in the text.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy nlp pipeline to use for matching.</span>
<span class="sd">    family : Optional[List[str]]</span>
<span class="sd">        List of terms indicating family reference.</span>
<span class="sd">    terminations : Optional[List[str]]</span>
<span class="sd">        List of termination terms, to separate syntagmas.</span>
<span class="sd">    attr : str</span>
<span class="sd">        spaCy&#39;s attribute to use:</span>
<span class="sd">        a string with the value &quot;TEXT&quot; or &quot;NORM&quot;, or a dict with the key &#39;term_attr&#39;</span>
<span class="sd">        we can also add a key for each regex.</span>
<span class="sd">    on_ents_only : bool</span>
<span class="sd">        Whether to look for matches around detected entities only.</span>
<span class="sd">        Useful for faster inference in downstream tasks.</span>
<span class="sd">    regex : Optional[Dict[str, Union[List[str], str]]]</span>
<span class="sd">        A dictionnary of regex patterns.</span>
<span class="sd">    explain : bool</span>
<span class="sd">        Whether to keep track of cues for each entity.</span>
<span class="sd">    use_sections : bool, by default `False`</span>
<span class="sd">        Whether to use annotated sections (namely `antécédents familiaux`).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">family</span><span class="o">=</span><span class="n">family</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">family</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">use_sections</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defaults</span><span class="p">(</span>
            <span class="n">family</span><span class="o">=</span><span class="n">family</span><span class="p">,</span>
            <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
            <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
            <span class="o">**</span><span class="n">terms</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="s2">&quot;eds.sections&quot;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span> <span class="ow">or</span> <span class="s2">&quot;sections&quot;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;You have requested that the pipeline use annotations &quot;</span>
                <span class="s2">&quot;provided by the `section` pipeline, but it was not set. &quot;</span>
                <span class="s2">&quot;Skipping that step.&quot;</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family_&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;family_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">token</span><span class="p">:</span> <span class="s2">&quot;FAMILY&quot;</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family</span> <span class="k">else</span> <span class="s2">&quot;PATIENT&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family_&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;family_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">span</span><span class="p">:</span> <span class="s2">&quot;FAMILY&quot;</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family</span> <span class="k">else</span> <span class="s2">&quot;PATIENT&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family_cues&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;family_cues&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">):</span>
            <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds entities related to family context.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc: spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc: spaCy Doc object, annotated for context</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="n">terminations</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;termination&quot;</span><span class="p">)</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">terminations</span><span class="p">)</span>

        <span class="c1"># Removes duplicate matches and pseudo-expressions in one statement</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span><span class="p">)</span>

        <span class="n">entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discarded&quot;</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
            <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FAMILY&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;sections&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s2">&quot;antécédents familiaux&quot;</span>
            <span class="p">]</span>

        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>

            <span class="n">ents</span><span class="p">,</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
                <span class="n">entities</span><span class="p">,</span>
                <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
                <span class="n">second_chance</span><span class="o">=</span><span class="n">ents</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">sub_matches</span><span class="p">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
                <span class="n">matches</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span>
            <span class="p">)</span>

            <span class="n">sub_sections</span><span class="p">,</span> <span class="n">sections</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span><span class="n">sections</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ents</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">cues</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;family&quot;</span><span class="p">)</span>
            <span class="n">cues</span> <span class="o">+=</span> <span class="n">sub_sections</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">cues</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">family</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">cues</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">family</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain</span><span class="p">:</span>
                    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family_cues</span> <span class="o">+=</span> <span class="n">cues</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">:</span>
                        <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.family.family.FamilyContext.defaults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="n">family</span><span class="p">,</span> <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.family.family.FamilyContext.sections" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sections</span> <span class="o">=</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="s1">&#39;eds.sections&#39;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span> <span class="ow">or</span> <span class="s1">&#39;sections&#39;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.family.family.FamilyContext.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">family</span><span class="p">,</span> <span class="n">termination</span><span class="p">,</span> <span class="n">use_sections</span><span class="p">,</span> <span class="n">explain</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/family/family.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">family</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">use_sections</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defaults</span><span class="p">(</span>
        <span class="n">family</span><span class="o">=</span><span class="n">family</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
        <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
        <span class="o">**</span><span class="n">terms</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="s2">&quot;eds.sections&quot;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span> <span class="ow">or</span> <span class="s2">&quot;sections&quot;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;You have requested that the pipeline use annotations &quot;</span>
            <span class="s2">&quot;provided by the `section` pipeline, but it was not set. &quot;</span>
            <span class="s2">&quot;Skipping that step.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.family.family.FamilyContext.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/family/family.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family_&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;family_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">token</span><span class="p">:</span> <span class="s2">&quot;FAMILY&quot;</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family</span> <span class="k">else</span> <span class="s2">&quot;PATIENT&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family_&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;family_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">span</span><span class="p">:</span> <span class="s2">&quot;FAMILY&quot;</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family</span> <span class="k">else</span> <span class="s2">&quot;PATIENT&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family_cues&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;family_cues&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">):</span>
        <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.family.family.FamilyContext.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Finds entities related to family context.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/family/family.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds entities related to family context.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc: spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc: spaCy Doc object, annotated for context</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="n">terminations</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;termination&quot;</span><span class="p">)</span>
    <span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">terminations</span><span class="p">)</span>

    <span class="c1"># Removes duplicate matches and pseudo-expressions in one statement</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span><span class="p">)</span>

    <span class="n">entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discarded&quot;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
        <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FAMILY&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;sections&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s2">&quot;antécédents familiaux&quot;</span>
        <span class="p">]</span>

    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>

        <span class="n">ents</span><span class="p">,</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
            <span class="n">entities</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
            <span class="n">second_chance</span><span class="o">=</span><span class="n">ents</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">sub_matches</span><span class="p">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
            <span class="n">matches</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span>
        <span class="p">)</span>

        <span class="n">sub_sections</span><span class="p">,</span> <span class="n">sections</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span><span class="n">sections</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ents</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">cues</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;family&quot;</span><span class="p">)</span>
        <span class="n">cues</span> <span class="o">+=</span> <span class="n">sub_sections</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">cues</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">family</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">cues</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">family</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain</span><span class="p">:</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family_cues</span> <span class="o">+=</span> <span class="n">cues</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.family.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.family.patterns.family" class="doc doc-heading">
<code class="highlight language-python"><span class="n">family</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;aïeul&#39;</span><span class="p">,</span> <span class="s1">&#39;aïeux&#39;</span><span class="p">,</span> <span class="s1">&#39;antécédent familial&#39;</span><span class="p">,</span> <span class="s1">&#39;antécédents familiaux&#39;</span><span class="p">,</span> <span class="s1">&#39;arrière-grand-mère&#39;</span><span class="p">,</span> <span class="s1">&#39;arrière-grand-père&#39;</span><span class="p">,</span> <span class="s1">&#39;arrière-grands-parents&#39;</span><span class="p">,</span> <span class="s1">&#39;cousin&#39;</span><span class="p">,</span> <span class="s1">&#39;cousine&#39;</span><span class="p">,</span> <span class="s1">&#39;cousines&#39;</span><span class="p">,</span> <span class="s1">&#39;cousins&#39;</span><span class="p">,</span> <span class="s1">&#39;enfant&#39;</span><span class="p">,</span> <span class="s1">&#39;enfants&#39;</span><span class="p">,</span> <span class="s1">&#39;épouse&#39;</span><span class="p">,</span> <span class="s1">&#39;époux&#39;</span><span class="p">,</span> <span class="s1">&#39;familial&#39;</span><span class="p">,</span> <span class="s1">&#39;familiale&#39;</span><span class="p">,</span> <span class="s1">&#39;familiales&#39;</span><span class="p">,</span> <span class="s1">&#39;familiaux&#39;</span><span class="p">,</span> <span class="s1">&#39;famille&#39;</span><span class="p">,</span> <span class="s1">&#39;fiancé&#39;</span><span class="p">,</span> <span class="s1">&#39;fiancée&#39;</span><span class="p">,</span> <span class="s1">&#39;fils&#39;</span><span class="p">,</span> <span class="s1">&#39;frère&#39;</span><span class="p">,</span> <span class="s1">&#39;frères&#39;</span><span class="p">,</span> <span class="s1">&#39;grand-mère&#39;</span><span class="p">,</span> <span class="s1">&#39;grand-père&#39;</span><span class="p">,</span> <span class="s1">&#39;grands-parents&#39;</span><span class="p">,</span> <span class="s1">&#39;maman&#39;</span><span class="p">,</span> <span class="s1">&#39;mari&#39;</span><span class="p">,</span> <span class="s1">&#39;mère&#39;</span><span class="p">,</span> <span class="s1">&#39;oncle&#39;</span><span class="p">,</span> <span class="s1">&#39;papa&#39;</span><span class="p">,</span> <span class="s1">&#39;parent&#39;</span><span class="p">,</span> <span class="s1">&#39;parents&#39;</span><span class="p">,</span> <span class="s1">&#39;père&#39;</span><span class="p">,</span> <span class="s1">&#39;soeur&#39;</span><span class="p">,</span> <span class="s1">&#39;sœur&#39;</span><span class="p">,</span> <span class="s1">&#39;sœurs&#39;</span><span class="p">,</span> <span class="s1">&#39;soeurs&#39;</span><span class="p">,</span> <span class="s1">&#39;tante&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.qualifiers.negation" class="doc doc-heading">
        <code>negation</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.negation.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.negation.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">pseudo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preceding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">following</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">termination</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">within_ents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explain</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.qualifiers.negation.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">pseudo</span><span class="p">,</span> <span class="n">preceding</span><span class="p">,</span> <span class="n">following</span><span class="p">,</span> <span class="n">termination</span><span class="p">,</span> <span class="n">verbs</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">,</span> <span class="n">within_ents</span><span class="p">,</span> <span class="n">explain</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/negation/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;negation&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.negation&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.negation&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pseudo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">preceding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">following</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">verbs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">within_ents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="k">return</span> <span class="n">Negation</span><span class="p">(</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
        <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
        <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
        <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
        <span class="n">within_ents</span><span class="o">=</span><span class="n">within_ents</span><span class="p">,</span>
        <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.negation.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.negation.patterns.pseudo" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pseudo</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;aucun changement&#39;</span><span class="p">,</span> <span class="s1">&#39;aucun doute&#39;</span><span class="p">,</span> <span class="s1">&#39;aucune hésitation&#39;</span><span class="p">,</span> <span class="s1">&#39;aucune diminution&#39;</span><span class="p">,</span> <span class="s1">&#39;ne permet pas d&#39;</span><span class="p">,</span> <span class="s1">&#39;ne permet pas de&#39;</span><span class="p">,</span> <span class="s2">&quot;n&#39;exclut pas&quot;</span><span class="p">,</span> <span class="s1">&#39;non négligeable&#39;</span><span class="p">,</span> <span class="s2">&quot;pas d&#39;amélioration&quot;</span><span class="p">,</span> <span class="s2">&quot;pas d&#39;augmentation&quot;</span><span class="p">,</span> <span class="s2">&quot;pas d&#39;autre&quot;</span><span class="p">,</span> <span class="s1">&#39;pas de changement&#39;</span><span class="p">,</span> <span class="s1">&#39;pas de diminution&#39;</span><span class="p">,</span> <span class="s1">&#39;pas de doute&#39;</span><span class="p">,</span> <span class="s1">&#39;pas exclu&#39;</span><span class="p">,</span> <span class="s1">&#39;pas exclue&#39;</span><span class="p">,</span> <span class="s1">&#39;pas exclues&#39;</span><span class="p">,</span> <span class="s1">&#39;pas exclus&#39;</span><span class="p">,</span> <span class="s1">&#39;pas immunisé&#39;</span><span class="p">,</span> <span class="s1">&#39;pas immunisée&#39;</span><span class="p">,</span> <span class="s1">&#39;pas immunisés&#39;</span><span class="p">,</span> <span class="s1">&#39;pas immunisées&#39;</span><span class="p">,</span> <span class="s1">&#39;sans amélioration&#39;</span><span class="p">,</span> <span class="s1">&#39;sans aucun doute&#39;</span><span class="p">,</span> <span class="s1">&#39;sans augmentation&#39;</span><span class="p">,</span> <span class="s1">&#39;sans certitude&#39;</span><span class="p">,</span> <span class="s1">&#39;sans changement&#39;</span><span class="p">,</span> <span class="s1">&#39;sans diminution&#39;</span><span class="p">,</span> <span class="s1">&#39;sans doute&#39;</span><span class="p">,</span> <span class="s1">&#39;sans être certain&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.negation.patterns.preceding" class="doc doc-heading">
<code class="highlight language-python"><span class="n">preceding</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;à la place de&#39;</span><span class="p">,</span> <span class="s1">&#39;absence&#39;</span><span class="p">,</span> <span class="s1">&#39;absence de signe de&#39;</span><span class="p">,</span> <span class="s1">&#39;absence de&#39;</span><span class="p">,</span> <span class="s1">&#39;aucun signe de&#39;</span><span class="p">,</span> <span class="s1">&#39;aucun&#39;</span><span class="p">,</span> <span class="s1">&#39;aucune preuve&#39;</span><span class="p">,</span> <span class="s1">&#39;aucune&#39;</span><span class="p">,</span> <span class="s1">&#39;aucunes&#39;</span><span class="p">,</span> <span class="s1">&#39;aucuns&#39;</span><span class="p">,</span> <span class="s1">&#39;décline&#39;</span><span class="p">,</span> <span class="s1">&#39;décliné&#39;</span><span class="p">,</span> <span class="s1">&#39;dépourvu&#39;</span><span class="p">,</span> <span class="s1">&#39;dépourvue&#39;</span><span class="p">,</span> <span class="s1">&#39;dépourvues&#39;</span><span class="p">,</span> <span class="s1">&#39;dépourvus&#39;</span><span class="p">,</span> <span class="s1">&#39;disparition de&#39;</span><span class="p">,</span> <span class="s1">&#39;disparition des&#39;</span><span class="p">,</span> <span class="s1">&#39;excluent&#39;</span><span class="p">,</span> <span class="s1">&#39;exclut&#39;</span><span class="p">,</span> <span class="s1">&#39;impossibilité de&#39;</span><span class="p">,</span> <span class="s1">&#39;immunisé&#39;</span><span class="p">,</span> <span class="s1">&#39;immunisée&#39;</span><span class="p">,</span> <span class="s1">&#39;immunisés&#39;</span><span class="p">,</span> <span class="s1">&#39;immunisées&#39;</span><span class="p">,</span> <span class="s1">&#39;incompatible avec&#39;</span><span class="p">,</span> <span class="s1">&#39;incompatibles avec&#39;</span><span class="p">,</span> <span class="s1">&#39;jamais&#39;</span><span class="p">,</span> <span class="s1">&#39;ne manifestaient pas&#39;</span><span class="p">,</span> <span class="s1">&#39;ne manifestait pas&#39;</span><span class="p">,</span> <span class="s1">&#39;ne manifeste pas&#39;</span><span class="p">,</span> <span class="s1">&#39;ne manifestent pas&#39;</span><span class="p">,</span> <span class="s1">&#39;ne pas&#39;</span><span class="p">,</span> <span class="s1">&#39;ne présentaient pas&#39;</span><span class="p">,</span> <span class="s1">&#39;ne présentait pas&#39;</span><span class="p">,</span> <span class="s1">&#39;ne présente pas&#39;</span><span class="p">,</span> <span class="s1">&#39;ne présentent pas&#39;</span><span class="p">,</span> <span class="s1">&#39;ne ressemble pas&#39;</span><span class="p">,</span> <span class="s1">&#39;ne ressemblent pas&#39;</span><span class="p">,</span> <span class="s1">&#39;négatif pour&#39;</span><span class="p">,</span> <span class="s2">&quot;n&#39;est pas&quot;</span><span class="p">,</span> <span class="s2">&quot;n&#39;était pas&quot;</span><span class="p">,</span> <span class="s1">&#39;ni&#39;</span><span class="p">,</span> <span class="s1">&#39;niant&#39;</span><span class="p">,</span> <span class="s1">&#39;nie&#39;</span><span class="p">,</span> <span class="s1">&#39;nié&#39;</span><span class="p">,</span> <span class="s1">&#39;nullement&#39;</span><span class="p">,</span> <span class="s1">&#39;pas d&#39;</span><span class="p">,</span> <span class="s1">&#39;pas de cause de&#39;</span><span class="p">,</span> <span class="s1">&#39;pas de signe de&#39;</span><span class="p">,</span> <span class="s1">&#39;pas de signes de&#39;</span><span class="p">,</span> <span class="s1">&#39;pas de&#39;</span><span class="p">,</span> <span class="s1">&#39;pas nécessaire de&#39;</span><span class="p">,</span> <span class="s1">&#39;pas&#39;</span><span class="p">,</span> <span class="s2">&quot;permet d&#39;exclure&quot;</span><span class="p">,</span> <span class="s2">&quot;plus d&#39;aspect de&quot;</span><span class="p">,</span> <span class="s1">&#39;sans manifester de&#39;</span><span class="p">,</span> <span class="s1">&#39;sans présenter de&#39;</span><span class="p">,</span> <span class="s1">&#39;sans&#39;</span><span class="p">,</span> <span class="s1">&#39;symptôme atypique&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.negation.patterns.following" class="doc doc-heading">
<code class="highlight language-python"><span class="n">following</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;:0&#39;</span><span class="p">,</span> <span class="s1">&#39;: 0&#39;</span><span class="p">,</span> <span class="s1">&#39;:non&#39;</span><span class="p">,</span> <span class="s1">&#39;: non&#39;</span><span class="p">,</span> <span class="s1">&#39;absent&#39;</span><span class="p">,</span> <span class="s1">&#39;absente&#39;</span><span class="p">,</span> <span class="s1">&#39;absentes&#39;</span><span class="p">,</span> <span class="s1">&#39;absents&#39;</span><span class="p">,</span> <span class="s1">&#39;dépourvu&#39;</span><span class="p">,</span> <span class="s1">&#39;dépourvue&#39;</span><span class="p">,</span> <span class="s1">&#39;dépourvues&#39;</span><span class="p">,</span> <span class="s1">&#39;dépourvus&#39;</span><span class="p">,</span> <span class="s1">&#39;disparaissent&#39;</span><span class="p">,</span> <span class="s1">&#39;disparait&#39;</span><span class="p">,</span> <span class="s1">&#39;est exclu&#39;</span><span class="p">,</span> <span class="s1">&#39;est exclue&#39;</span><span class="p">,</span> <span class="s1">&#39;immunisé&#39;</span><span class="p">,</span> <span class="s1">&#39;immunisée&#39;</span><span class="p">,</span> <span class="s1">&#39;immunisés&#39;</span><span class="p">,</span> <span class="s1">&#39;immunisées&#39;</span><span class="p">,</span> <span class="s1">&#39;impossible&#39;</span><span class="p">,</span> <span class="s1">&#39;improbable&#39;</span><span class="p">,</span> <span class="s1">&#39;négatif&#39;</span><span class="p">,</span> <span class="s1">&#39;négatifs&#39;</span><span class="p">,</span> <span class="s1">&#39;négative&#39;</span><span class="p">,</span> <span class="s1">&#39;négatives&#39;</span><span class="p">,</span> <span class="s1">&#39;négligeable&#39;</span><span class="p">,</span> <span class="s1">&#39;négligeables&#39;</span><span class="p">,</span> <span class="s1">&#39;nié&#39;</span><span class="p">,</span> <span class="s1">&#39;niée&#39;</span><span class="p">,</span> <span class="s1">&#39;non&#39;</span><span class="p">,</span> <span class="s1">&#39;pas nécessaire&#39;</span><span class="p">,</span> <span class="s1">&#39;peu probable&#39;</span><span class="p">,</span> <span class="s1">&#39;sont exclues&#39;</span><span class="p">,</span> <span class="s1">&#39;sont exclus&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.negation.patterns.verbs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verbs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;éliminer&#39;</span><span class="p">,</span> <span class="s1">&#39;exclure&#39;</span><span class="p">,</span> <span class="s1">&#39;interdire&#39;</span><span class="p">,</span> <span class="s1">&#39;nier&#39;</span><span class="p">,</span> <span class="s1">&#39;réfuter&#39;</span><span class="p">,</span> <span class="s1">&#39;rejeter&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.negation.negation" class="doc doc-heading">
        <code>negation</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.qualifiers.negation.negation.Negation" class="doc doc-heading">
          <code>Negation</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.qualifiers.base.Qualifier" href="pipelines/qualifiers/base/#edsnlp.pipelines.qualifiers.base.Qualifier">Qualifier</a></code></p>


      <p>Implements the NegEx algorithm.</p>
<p>The component looks for five kinds of expressions in the text :</p>
<ul>
<li>
<p>preceding negations, ie cues that precede a negated expression</p>
</li>
<li>
<p>following negations, ie cues that follow a negated expression</p>
</li>
<li>
<p>pseudo negations : contain a negation cue, but are not negations
  (eg "pas de doute"/"no doubt")</p>
</li>
<li>
<p>negation verbs, ie verbs that indicate a negation</p>
</li>
<li>
<p>terminations, ie words that delimit propositions.
  The negation spans from the preceding cue to the termination.</p>
</li>
</ul>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy nlp pipeline to use for matching.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>spaCy's attribute to use</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>pseudo</code></td>
          <td class="doc-param-details">
            <p>List of pseudo negation terms.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>preceding</code></td>
          <td class="doc-param-details">
            <p>List of preceding negation terms</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>following</code></td>
          <td class="doc-param-details">
            <p>List of following negation terms.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>termination</code></td>
          <td class="doc-param-details">
            <p>List of termination terms.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>verbs</code></td>
          <td class="doc-param-details">
            <p>List of negation verbs.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>on_ents_only</code></td>
          <td class="doc-param-details">
            <p>Whether to look for matches around detected entities only.
Useful for faster inference in downstream tasks.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>within_ents</code></td>
          <td class="doc-param-details">
            <p>Whether to consider cues within entities.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>explain</code></td>
          <td class="doc-param-details">
            <p>Whether to keep track of cues for each entity.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/qualifiers/negation/negation.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Negation</span><span class="p">(</span><span class="n">Qualifier</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements the NegEx algorithm.</span>

<span class="sd">    The component looks for five kinds of expressions in the text :</span>

<span class="sd">    - preceding negations, ie cues that precede a negated expression</span>

<span class="sd">    - following negations, ie cues that follow a negated expression</span>

<span class="sd">    - pseudo negations : contain a negation cue, but are not negations</span>
<span class="sd">      (eg &quot;pas de doute&quot;/&quot;no doubt&quot;)</span>

<span class="sd">    - negation verbs, ie verbs that indicate a negation</span>

<span class="sd">    - terminations, ie words that delimit propositions.</span>
<span class="sd">      The negation spans from the preceding cue to the termination.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy nlp pipeline to use for matching.</span>
<span class="sd">    attr : str</span>
<span class="sd">        spaCy&#39;s attribute to use</span>
<span class="sd">    pseudo : Optional[List[str]]</span>
<span class="sd">        List of pseudo negation terms.</span>
<span class="sd">    preceding : Optional[List[str]]</span>
<span class="sd">        List of preceding negation terms</span>
<span class="sd">    following : Optional[List[str]]</span>
<span class="sd">        List of following negation terms.</span>
<span class="sd">    termination : Optional[List[str]]</span>
<span class="sd">        List of termination terms.</span>
<span class="sd">    verbs : Optional[List[str]]</span>
<span class="sd">        List of negation verbs.</span>
<span class="sd">    on_ents_only : bool</span>
<span class="sd">        Whether to look for matches around detected entities only.</span>
<span class="sd">        Useful for faster inference in downstream tasks.</span>
<span class="sd">    within_ents : bool</span>
<span class="sd">        Whether to consider cues within entities.</span>
<span class="sd">    explain : bool</span>
<span class="sd">        Whether to keep track of cues for each entity.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
        <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
        <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
        <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">pseudo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">preceding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">following</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">verbs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">within_ents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defaults</span><span class="p">(</span>
            <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
            <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
            <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
            <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
            <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">terms</span><span class="p">[</span><span class="s2">&quot;verbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_verbs</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="s2">&quot;verbs&quot;</span><span class="p">])</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
            <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
            <span class="o">**</span><span class="n">terms</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span> <span class="o">=</span> <span class="n">within_ents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negation&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;negation&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negated&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;negated&quot;</span><span class="p">,</span> <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;negated&quot;</span><span class="p">,</span> <span class="s2">&quot;negation&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negation_&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;negation_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">token</span><span class="p">:</span> <span class="s2">&quot;NEG&quot;</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="k">else</span> <span class="s2">&quot;AFF&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;polarity_&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;polarity_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;polarity_&quot;</span><span class="p">,</span> <span class="s2">&quot;negation_&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negation&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;negation&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negated&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;negated&quot;</span><span class="p">,</span> <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;negated&quot;</span><span class="p">,</span> <span class="s2">&quot;negation&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negation_cues&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;negation_cues&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negation_&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;negation_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">span</span><span class="p">:</span> <span class="s2">&quot;NEG&quot;</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="k">else</span> <span class="s2">&quot;AFF&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;polarity_&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;polarity_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;polarity_&quot;</span><span class="p">,</span> <span class="s2">&quot;negation_&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negations&quot;</span><span class="p">):</span>
            <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;negations&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">def</span> <span class="nf">load_verbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conjugate negating verbs to specific tenses.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbs: list of negating verbs to conjugate</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list_neg_verbs: List of negating verbs conjugated to specific tenses.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">neg_verbs</span> <span class="o">=</span> <span class="n">get_verbs</span><span class="p">(</span><span class="n">verbs</span><span class="p">)</span>

        <span class="n">neg_verbs</span> <span class="o">=</span> <span class="n">neg_verbs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">((</span><span class="n">neg_verbs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Indicatif&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">neg_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Présent&quot;</span><span class="p">))</span>
            <span class="o">|</span> <span class="p">(</span><span class="n">neg_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Participe Présent&quot;</span><span class="p">)</span>
            <span class="o">|</span> <span class="p">(</span><span class="n">neg_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Participe Passé&quot;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">list_neg_verbs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">neg_verbs</span><span class="p">[</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">list_neg_verbs</span>

    <span class="k">def</span> <span class="nf">annotate_entity</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ent</span><span class="p">:</span> <span class="n">Span</span><span class="p">,</span>
        <span class="n">sub_preceding</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">],</span>
        <span class="n">sub_following</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Annotate entities using preceding and following negations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ent : Span</span>
<span class="sd">            Entity to annotate</span>
<span class="sd">        sub_preceding : List[Span]</span>
<span class="sd">            List of preceding negations cues</span>
<span class="sd">        sub_following : List[Span]</span>
<span class="sd">            List of following negations cues</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span><span class="p">:</span>
            <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
            <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
            <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>

        <span class="n">negation</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="ow">or</span> <span class="nb">bool</span><span class="p">(</span><span class="n">cues</span><span class="p">)</span>

        <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="o">=</span> <span class="n">negation</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain</span> <span class="ow">and</span> <span class="n">negation</span><span class="p">:</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation_cues</span> <span class="o">+=</span> <span class="n">cues</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="n">negation</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">:</span>
                <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds entities related to negation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc: spaCy `Doc` object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc: spaCy `Doc` object, annotated for negation</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="n">terminations</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;termination&quot;</span><span class="p">)</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">terminations</span><span class="p">)</span>

        <span class="n">entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discarded&quot;</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Removes duplicate matches and pseudo-expressions in one statement</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>

            <span class="n">ents</span><span class="p">,</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
                <span class="n">entities</span><span class="p">,</span>
                <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
                <span class="n">second_chance</span><span class="o">=</span><span class="n">ents</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">sub_matches</span><span class="p">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
                <span class="n">matches</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ents</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">sub_preceding</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;preceding&quot;</span><span class="p">)</span>
            <span class="n">sub_following</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;following&quot;</span><span class="p">)</span>
            <span class="c1"># Verbs precede negated content</span>
            <span class="n">sub_preceding</span> <span class="o">+=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;verbs&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_following</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                        <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span>
                    <span class="p">)</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">annotate_entity</span><span class="p">(</span>
                    <span class="n">ent</span><span class="o">=</span><span class="n">ent</span><span class="p">,</span>
                    <span class="n">sub_preceding</span><span class="o">=</span><span class="n">sub_preceding</span><span class="p">,</span>
                    <span class="n">sub_following</span><span class="o">=</span><span class="n">sub_following</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">doc</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.negation.negation.Negation.defaults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span> <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span> <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span> <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span> <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.negation.negation.Negation.within_ents" class="doc doc-heading">
<code class="highlight language-python"><span class="n">within_ents</span> <span class="o">=</span> <span class="n">within_ents</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.negation.negation.Negation.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">pseudo</span><span class="p">,</span> <span class="n">preceding</span><span class="p">,</span> <span class="n">following</span><span class="p">,</span> <span class="n">termination</span><span class="p">,</span> <span class="n">verbs</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">,</span> <span class="n">within_ents</span><span class="p">,</span> <span class="n">explain</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/negation/negation.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pseudo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">preceding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">following</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">verbs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">within_ents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defaults</span><span class="p">(</span>
        <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
        <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
        <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
        <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">terms</span><span class="p">[</span><span class="s2">&quot;verbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_verbs</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="s2">&quot;verbs&quot;</span><span class="p">])</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
        <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
        <span class="o">**</span><span class="n">terms</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span> <span class="o">=</span> <span class="n">within_ents</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.negation.negation.Negation.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/negation/negation.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negation&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;negation&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negated&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;negated&quot;</span><span class="p">,</span> <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;negated&quot;</span><span class="p">,</span> <span class="s2">&quot;negation&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negation_&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;negation_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">token</span><span class="p">:</span> <span class="s2">&quot;NEG&quot;</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="k">else</span> <span class="s2">&quot;AFF&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;polarity_&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;polarity_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;polarity_&quot;</span><span class="p">,</span> <span class="s2">&quot;negation_&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negation&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;negation&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negated&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;negated&quot;</span><span class="p">,</span> <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;negated&quot;</span><span class="p">,</span> <span class="s2">&quot;negation&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negation_cues&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;negation_cues&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negation_&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;negation_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">span</span><span class="p">:</span> <span class="s2">&quot;NEG&quot;</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="k">else</span> <span class="s2">&quot;AFF&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;polarity_&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;polarity_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;polarity_&quot;</span><span class="p">,</span> <span class="s2">&quot;negation_&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;negations&quot;</span><span class="p">):</span>
        <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;negations&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.negation.negation.Negation.load_verbs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_verbs</span><span class="p">(</span><span class="n">verbs</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Conjugate negating verbs to specific tenses.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>verbs</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.List">List</span>[str]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>list_neg_verbs</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/negation/negation.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load_verbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conjugate negating verbs to specific tenses.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    verbs: list of negating verbs to conjugate</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list_neg_verbs: List of negating verbs conjugated to specific tenses.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">neg_verbs</span> <span class="o">=</span> <span class="n">get_verbs</span><span class="p">(</span><span class="n">verbs</span><span class="p">)</span>

    <span class="n">neg_verbs</span> <span class="o">=</span> <span class="n">neg_verbs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="p">((</span><span class="n">neg_verbs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Indicatif&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">neg_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Présent&quot;</span><span class="p">))</span>
        <span class="o">|</span> <span class="p">(</span><span class="n">neg_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Participe Présent&quot;</span><span class="p">)</span>
        <span class="o">|</span> <span class="p">(</span><span class="n">neg_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Participe Passé&quot;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">list_neg_verbs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">neg_verbs</span><span class="p">[</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">list_neg_verbs</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.negation.negation.Negation.annotate_entity" class="doc doc-heading">
<code class="highlight language-python"><span class="n">annotate_entity</span><span class="p">(</span><span class="n">ent</span><span class="p">,</span> <span class="n">sub_preceding</span><span class="p">,</span> <span class="n">sub_following</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Annotate entities using preceding and following negations.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ent</code></td>
          <td class="doc-param-details">
            <p>Entity to annotate</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Span</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>sub_preceding</code></td>
          <td class="doc-param-details">
            <p>List of preceding negations cues</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Span]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>sub_following</code></td>
          <td class="doc-param-details">
            <p>List of following negations cues</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Span]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/negation/negation.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">annotate_entity</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ent</span><span class="p">:</span> <span class="n">Span</span><span class="p">,</span>
    <span class="n">sub_preceding</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">],</span>
    <span class="n">sub_following</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Annotate entities using preceding and following negations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ent : Span</span>
<span class="sd">        Entity to annotate</span>
<span class="sd">    sub_preceding : List[Span]</span>
<span class="sd">        List of preceding negations cues</span>
<span class="sd">    sub_following : List[Span]</span>
<span class="sd">        List of following negations cues</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span><span class="p">:</span>
        <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
        <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
        <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>

    <span class="n">negation</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="ow">or</span> <span class="nb">bool</span><span class="p">(</span><span class="n">cues</span><span class="p">)</span>

    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="o">=</span> <span class="n">negation</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain</span> <span class="ow">and</span> <span class="n">negation</span><span class="p">:</span>
        <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation_cues</span> <span class="o">+=</span> <span class="n">cues</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="n">negation</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">:</span>
            <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.negation.negation.Negation.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Finds entities related to negation.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/negation/negation.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds entities related to negation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc: spaCy `Doc` object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc: spaCy `Doc` object, annotated for negation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="n">terminations</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;termination&quot;</span><span class="p">)</span>
    <span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">terminations</span><span class="p">)</span>

    <span class="n">entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discarded&quot;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Removes duplicate matches and pseudo-expressions in one statement</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>

        <span class="n">ents</span><span class="p">,</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
            <span class="n">entities</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
            <span class="n">second_chance</span><span class="o">=</span><span class="n">ents</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">sub_matches</span><span class="p">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
            <span class="n">matches</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ents</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">sub_preceding</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;preceding&quot;</span><span class="p">)</span>
        <span class="n">sub_following</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;following&quot;</span><span class="p">)</span>
        <span class="c1"># Verbs precede negated content</span>
        <span class="n">sub_preceding</span> <span class="o">+=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;verbs&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_following</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">negation</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                    <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span>
                <span class="p">)</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">annotate_entity</span><span class="p">(</span>
                <span class="n">ent</span><span class="o">=</span><span class="n">ent</span><span class="p">,</span>
                <span class="n">sub_preceding</span><span class="o">=</span><span class="n">sub_preceding</span><span class="p">,</span>
                <span class="n">sub_following</span><span class="o">=</span><span class="n">sub_following</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.negation.negation.Negation.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/negation/negation.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.qualifiers.history" class="doc doc-heading">
        <code>history</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.history.history" class="doc doc-heading">
        <code>history</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.qualifiers.history.history.History" class="doc doc-heading">
          <code>History</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.qualifiers.base.Qualifier" href="pipelines/qualifiers/base/#edsnlp.pipelines.qualifiers.base.Qualifier">Qualifier</a></code></p>


      <p>Implements an history detection algorithm.</p>
<p>The components looks for terms indicating history in the text.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy nlp pipeline to use for matching.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>history</code></td>
          <td class="doc-param-details">
            <p>List of terms indicating medical history reference.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>termination</code></td>
          <td class="doc-param-details">
            <p>List of syntagme termination terms.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>use_sections</code></td>
          <td class="doc-param-details">
            <p>Whether to use section pipeline to detect medical history section.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>spaCy's attribute to use:
a string with the value "TEXT" or "NORM", or a dict with the key 'term_attr'
we can also add a key for each regex.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>on_ents_only</code></td>
          <td class="doc-param-details">
            <p>Whether to look for matches around detected entities only.
Useful for faster inference in downstream tasks.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>regex</code></td>
          <td class="doc-param-details">
            <p>A dictionnary of regex patterns.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Dict[str, Union[List[str], str]]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>explain</code></td>
          <td class="doc-param-details">
            <p>Whether to keep track of cues for each entity.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/qualifiers/history/history.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">History</span><span class="p">(</span><span class="n">Qualifier</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements an history detection algorithm.</span>

<span class="sd">    The components looks for terms indicating history in the text.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy nlp pipeline to use for matching.</span>
<span class="sd">    history : Optional[List[str]]</span>
<span class="sd">        List of terms indicating medical history reference.</span>
<span class="sd">    termination : Optional[List[str]]</span>
<span class="sd">        List of syntagme termination terms.</span>
<span class="sd">    use_sections : bool</span>
<span class="sd">        Whether to use section pipeline to detect medical history section.</span>
<span class="sd">    attr : str</span>
<span class="sd">        spaCy&#39;s attribute to use:</span>
<span class="sd">        a string with the value &quot;TEXT&quot; or &quot;NORM&quot;, or a dict with the key &#39;term_attr&#39;</span>
<span class="sd">        we can also add a key for each regex.</span>
<span class="sd">    on_ents_only : bool</span>
<span class="sd">        Whether to look for matches around detected entities only.</span>
<span class="sd">        Useful for faster inference in downstream tasks.</span>
<span class="sd">    regex : Optional[Dict[str, Union[List[str], str]]]</span>
<span class="sd">        A dictionnary of regex patterns.</span>
<span class="sd">    explain : bool</span>
<span class="sd">        Whether to keep track of cues for each entity.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">use_sections</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defaults</span><span class="p">(</span>
            <span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span>
            <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
            <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
            <span class="o">**</span><span class="n">terms</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="s2">&quot;eds.sections&quot;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span> <span class="ow">or</span> <span class="s2">&quot;sections&quot;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;You have requested that the pipeline use annotations &quot;</span>
                <span class="s2">&quot;provided by the `section` pipeline, but it was not set. &quot;</span>
                <span class="s2">&quot;Skipping that step.&quot;</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;history&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;history&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedents&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;antecedents&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedents&quot;</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedent&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;antecedent&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedent&quot;</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;history_&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;history_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">token</span><span class="p">:</span> <span class="s2">&quot;ATCD&quot;</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="k">else</span> <span class="s2">&quot;CURRENT&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedents_&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;antecedents_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedents_&quot;</span><span class="p">,</span> <span class="s2">&quot;history_&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedent_&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;antecedent_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedent_&quot;</span><span class="p">,</span> <span class="s2">&quot;history_&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;history&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;history&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedents&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;antecedents&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedents&quot;</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedent&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;antecedent&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedent&quot;</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;history_&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;history_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">span</span><span class="p">:</span> <span class="s2">&quot;ATCD&quot;</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="k">else</span> <span class="s2">&quot;CURRENT&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedents_&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;antecedents_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedents_&quot;</span><span class="p">,</span> <span class="s2">&quot;history_&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedent_&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;antecedent_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedent_&quot;</span><span class="p">,</span> <span class="s2">&quot;history_&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;history_cues&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;history_cues&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedents_cues&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;antecedents_cues&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedents_cues&quot;</span><span class="p">,</span> <span class="s2">&quot;history_cues&quot;</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedent_cues&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;antecedent_cues&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedent_cues&quot;</span><span class="p">,</span> <span class="s2">&quot;history_cues&quot;</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds entities related to history.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object, annotated for history</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="n">terminations</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;termination&quot;</span><span class="p">)</span>
        <span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">terminations</span><span class="p">)</span>

        <span class="c1"># Removes duplicate matches and pseudo-expressions in one statement</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span><span class="p">)</span>

        <span class="n">entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discarded&quot;</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
            <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ATCD&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;sections&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s2">&quot;antécédents&quot;</span>
            <span class="p">]</span>

        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>
            <span class="n">ents</span><span class="p">,</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
                <span class="n">entities</span><span class="p">,</span>
                <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
                <span class="n">second_chance</span><span class="o">=</span><span class="n">ents</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">sub_matches</span><span class="p">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
                <span class="n">matches</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span>
            <span class="p">)</span>

            <span class="n">sub_sections</span><span class="p">,</span> <span class="n">sections</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span><span class="n">sections</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ents</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">cues</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">)</span>
            <span class="n">cues</span> <span class="o">+=</span> <span class="n">sub_sections</span>

            <span class="n">history</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">cues</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="n">history</span>

            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="ow">or</span> <span class="n">history</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain</span><span class="p">:</span>
                    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history_cues</span> <span class="o">+=</span> <span class="n">cues</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">:</span>
                        <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.history.history.History.defaults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span> <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.history.history.History.sections" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sections</span> <span class="o">=</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="s1">&#39;eds.sections&#39;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span> <span class="ow">or</span> <span class="s1">&#39;sections&#39;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.history.history.History.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">history</span><span class="p">,</span> <span class="n">termination</span><span class="p">,</span> <span class="n">use_sections</span><span class="p">,</span> <span class="n">explain</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/history/history.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">use_sections</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defaults</span><span class="p">(</span>
        <span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
        <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
        <span class="o">**</span><span class="n">terms</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sections</span> <span class="o">=</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="s2">&quot;eds.sections&quot;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span> <span class="ow">or</span> <span class="s2">&quot;sections&quot;</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe_names</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">use_sections</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;You have requested that the pipeline use annotations &quot;</span>
            <span class="s2">&quot;provided by the `section` pipeline, but it was not set. &quot;</span>
            <span class="s2">&quot;Skipping that step.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.history.history.History.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/history/history.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;history&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;history&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedents&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;antecedents&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedents&quot;</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedent&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;antecedent&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedent&quot;</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;history_&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;history_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">token</span><span class="p">:</span> <span class="s2">&quot;ATCD&quot;</span> <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="k">else</span> <span class="s2">&quot;CURRENT&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedents_&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;antecedents_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedents_&quot;</span><span class="p">,</span> <span class="s2">&quot;history_&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedent_&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;antecedent_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedent_&quot;</span><span class="p">,</span> <span class="s2">&quot;history_&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;history&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;history&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedents&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;antecedents&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedents&quot;</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedent&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;antecedent&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedent&quot;</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;history_&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;history_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">span</span><span class="p">:</span> <span class="s2">&quot;ATCD&quot;</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="k">else</span> <span class="s2">&quot;CURRENT&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedents_&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;antecedents_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedents_&quot;</span><span class="p">,</span> <span class="s2">&quot;history_&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedent_&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;antecedent_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedent_&quot;</span><span class="p">,</span> <span class="s2">&quot;history_&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;history_cues&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;history_cues&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedents_cues&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;antecedents_cues&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedents_cues&quot;</span><span class="p">,</span> <span class="s2">&quot;history_cues&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;antecedent_cues&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;antecedent_cues&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="s2">&quot;antecedent_cues&quot;</span><span class="p">,</span> <span class="s2">&quot;history_cues&quot;</span><span class="p">),</span>
        <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.history.history.History.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Finds entities related to history.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>spaCy Doc object, annotated for history</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/history/history.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds entities related to history.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object, annotated for history</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="n">terminations</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="s2">&quot;termination&quot;</span><span class="p">)</span>
    <span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">terminations</span><span class="p">)</span>

    <span class="c1"># Removes duplicate matches and pseudo-expressions in one statement</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span><span class="p">)</span>

    <span class="n">entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discarded&quot;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">sections</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sections</span><span class="p">:</span>
        <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Span</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">section</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ATCD&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;sections&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">section</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="s2">&quot;antécédents&quot;</span>
        <span class="p">]</span>

    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>
        <span class="n">ents</span><span class="p">,</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
            <span class="n">entities</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
            <span class="n">second_chance</span><span class="o">=</span><span class="n">ents</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">sub_matches</span><span class="p">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
            <span class="n">matches</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span>
        <span class="p">)</span>

        <span class="n">sub_sections</span><span class="p">,</span> <span class="n">sections</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span><span class="n">sections</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="ow">in</span> <span class="n">s</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ents</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">cues</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;history&quot;</span><span class="p">)</span>
        <span class="n">cues</span> <span class="o">+=</span> <span class="n">sub_sections</span>

        <span class="n">history</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">cues</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="n">history</span>

        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="ow">or</span> <span class="n">history</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain</span><span class="p">:</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history_cues</span> <span class="o">+=</span> <span class="n">cues</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.history.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.history.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="n">patterns</span><span class="o">.</span><span class="n">history</span><span class="p">,</span> <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span> <span class="n">use_sections</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explain</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.qualifiers.history.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">history</span><span class="p">,</span> <span class="n">termination</span><span class="p">,</span> <span class="n">use_sections</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">explain</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/history/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;antecedents&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.history&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;eds.antecedents&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.history&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;history&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.history&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.history&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">termination</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">use_sections</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">History</span><span class="p">(</span>
        <span class="n">nlp</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span>
        <span class="n">termination</span><span class="o">=</span><span class="n">termination</span><span class="p">,</span>
        <span class="n">use_sections</span><span class="o">=</span><span class="n">use_sections</span><span class="p">,</span>
        <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.history.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.history.patterns.history" class="doc doc-heading">
<code class="highlight language-python"><span class="n">history</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;antécédents&#39;</span><span class="p">,</span> <span class="s1">&#39;atcd&#39;</span><span class="p">,</span> <span class="s1">&#39;atcds&#39;</span><span class="p">,</span> <span class="s1">&#39;tacds&#39;</span><span class="p">,</span> <span class="s1">&#39;antécédent&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.pipelines.qualifiers.reported_speech" class="doc doc-heading">
        <code>reported_speech</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.reported_speech.factory" class="doc doc-heading">
        <code>factory</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.reported_speech.factory.DEFAULT_CONFIG" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DEFAULT_CONFIG</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">pseudo</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">preceding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">following</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quotation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;NORM&#39;</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">within_ents</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">explain</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h7 id="edsnlp.pipelines.qualifiers.reported_speech.factory.create_component" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_component</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">pseudo</span><span class="p">,</span> <span class="n">preceding</span><span class="p">,</span> <span class="n">following</span><span class="p">,</span> <span class="n">quotation</span><span class="p">,</span> <span class="n">verbs</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">,</span> <span class="n">within_ents</span><span class="p">,</span> <span class="n">explain</span><span class="p">)</span></code>


</h7>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/reported_speech/factory.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@deprecated_factory</span><span class="p">(</span><span class="s2">&quot;rspeech&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.reported_speech&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="nd">@deprecated_factory</span><span class="p">(</span>
    <span class="s2">&quot;reported_speech&quot;</span><span class="p">,</span> <span class="s2">&quot;eds.reported_speech&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span>
<span class="p">)</span>
<span class="nd">@Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="s2">&quot;eds.reported_speech&quot;</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">DEFAULT_CONFIG</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_component</span><span class="p">(</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pseudo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">preceding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">following</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">quotation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">verbs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">within_ents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">return</span> <span class="n">ReportedSpeech</span><span class="p">(</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
        <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
        <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
        <span class="n">quotation</span><span class="o">=</span><span class="n">quotation</span><span class="p">,</span>
        <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
        <span class="n">within_ents</span><span class="o">=</span><span class="n">within_ents</span><span class="p">,</span>
        <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.reported_speech.patterns" class="doc doc-heading">
        <code>patterns</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.reported_speech.patterns.verbs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">verbs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;affirmer&#39;</span><span class="p">,</span> <span class="s1">&#39;ajouter&#39;</span><span class="p">,</span> <span class="s1">&#39;assurer&#39;</span><span class="p">,</span> <span class="s1">&#39;confirmer&#39;</span><span class="p">,</span> <span class="s1">&#39;demander&#39;</span><span class="p">,</span> <span class="s1">&#39;dire&#39;</span><span class="p">,</span> <span class="s1">&#39;déclarer&#39;</span><span class="p">,</span> <span class="s1">&#39;décrire&#39;</span><span class="p">,</span> <span class="s1">&#39;décrire&#39;</span><span class="p">,</span> <span class="s1">&#39;démontrer&#39;</span><span class="p">,</span> <span class="s1">&#39;expliquer&#39;</span><span class="p">,</span> <span class="s1">&#39;faire remarquer&#39;</span><span class="p">,</span> <span class="s1">&#39;indiquer&#39;</span><span class="p">,</span> <span class="s1">&#39;informer&#39;</span><span class="p">,</span> <span class="s1">&#39;insinuer&#39;</span><span class="p">,</span> <span class="s1">&#39;insister&#39;</span><span class="p">,</span> <span class="s1">&#39;jurer&#39;</span><span class="p">,</span> <span class="s1">&#39;nier&#39;</span><span class="p">,</span> <span class="s1">&#39;nier&#39;</span><span class="p">,</span> <span class="s1">&#39;noter&#39;</span><span class="p">,</span> <span class="s1">&#39;objecter&#39;</span><span class="p">,</span> <span class="s1">&#39;observer&#39;</span><span class="p">,</span> <span class="s1">&#39;parler&#39;</span><span class="p">,</span> <span class="s1">&#39;promettre&#39;</span><span class="p">,</span> <span class="s1">&#39;préciser&#39;</span><span class="p">,</span> <span class="s1">&#39;prétendre&#39;</span><span class="p">,</span> <span class="s1">&#39;prévenir&#39;</span><span class="p">,</span> <span class="s1">&#39;raconter&#39;</span><span class="p">,</span> <span class="s1">&#39;rappeler&#39;</span><span class="p">,</span> <span class="s1">&#39;rapporter&#39;</span><span class="p">,</span> <span class="s1">&#39;reconnaître&#39;</span><span class="p">,</span> <span class="s1">&#39;réfuter&#39;</span><span class="p">,</span> <span class="s1">&#39;répliquer&#39;</span><span class="p">,</span> <span class="s1">&#39;répondre&#39;</span><span class="p">,</span> <span class="s1">&#39;répéter&#39;</span><span class="p">,</span> <span class="s1">&#39;révéler&#39;</span><span class="p">,</span> <span class="s1">&#39;se plaindre&#39;</span><span class="p">,</span> <span class="s1">&#39;souhaiter&#39;</span><span class="p">,</span> <span class="s1">&#39;souligner&#39;</span><span class="p">,</span> <span class="s1">&#39;supplier&#39;</span><span class="p">,</span> <span class="s1">&#39;verbaliser&#39;</span><span class="p">,</span> <span class="s1">&#39;vouloir&#39;</span><span class="p">,</span> <span class="s1">&#39;vouloir&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.reported_speech.patterns.following" class="doc doc-heading">
<code class="highlight language-python"><span class="n">following</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;d&#39;après le patient&quot;</span><span class="p">,</span> <span class="s2">&quot;d&#39;après la patiente&quot;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.reported_speech.patterns.preceding" class="doc doc-heading">
<code class="highlight language-python"><span class="n">preceding</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pas de critique de&#39;</span><span class="p">,</span> <span class="s1">&#39;crainte de&#39;</span><span class="p">,</span> <span class="s1">&#39;menace de&#39;</span><span class="p">,</span> <span class="s1">&#39;insiste sur le fait que&#39;</span><span class="p">,</span> <span class="s2">&quot;d&#39;après le patient&quot;</span><span class="p">,</span> <span class="s2">&quot;d&#39;après la patiente&quot;</span><span class="p">,</span> <span class="s1">&#39;peur de&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="edsnlp.pipelines.qualifiers.reported_speech.patterns.quotation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">quotation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="se">\\</span><span class="s1">&quot;.+</span><span class="se">\\</span><span class="s1">&quot;)|(</span><span class="se">\\</span><span class="s1">«.+</span><span class="se">\\</span><span class="s1">»)&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h7>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h6 id="edsnlp.pipelines.qualifiers.reported_speech.reported_speech" class="doc doc-heading">
        <code>reported_speech</code>



</h6>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h7 id="edsnlp.pipelines.qualifiers.reported_speech.reported_speech.ReportedSpeech" class="doc doc-heading">
          <code>ReportedSpeech</code>



</h7>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><a title="edsnlp.pipelines.qualifiers.base.Qualifier" href="pipelines/qualifiers/base/#edsnlp.pipelines.qualifiers.base.Qualifier">Qualifier</a></code></p>


      <p>Implements a reported speech detection algorithm.</p>
<p>The components looks for terms indicating patient statements,
and quotations to detect patient speech.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy nlp pipeline to use for matching.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>quotation</code></td>
          <td class="doc-param-details">
            <p>String gathering all quotation cues.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>verbs</code></td>
          <td class="doc-param-details">
            <p>List of reported speech verbs.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>following</code></td>
          <td class="doc-param-details">
            <p>List of terms following a reported speech.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>preceding</code></td>
          <td class="doc-param-details">
            <p>List of terms preceding a reported speech.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>filter_matches</code></td>
          <td class="doc-param-details">
            <p>Whether to filter out overlapping matches.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>spaCy's attribute to use:
a string with the value "TEXT" or "NORM",
or a dict with the key 'term_attr'
we can also add a key for each regex.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>on_ents_only</code></td>
          <td class="doc-param-details">
            <p>Whether to look for matches around detected entities only.
Useful for faster inference in downstream tasks.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>within_ents</code></td>
          <td class="doc-param-details">
            <p>Whether to consider cues within entities.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>explain</code></td>
          <td class="doc-param-details">
            <p>Whether to keep track of cues for each entity.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/pipelines/qualifiers/reported_speech/reported_speech.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ReportedSpeech</span><span class="p">(</span><span class="n">Qualifier</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements a reported speech detection algorithm.</span>

<span class="sd">    The components looks for terms indicating patient statements,</span>
<span class="sd">    and quotations to detect patient speech.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy nlp pipeline to use for matching.</span>
<span class="sd">    quotation : str</span>
<span class="sd">        String gathering all quotation cues.</span>
<span class="sd">    verbs : List[str]</span>
<span class="sd">        List of reported speech verbs.</span>
<span class="sd">    following : List[str]</span>
<span class="sd">        List of terms following a reported speech.</span>
<span class="sd">    preceding : List[str]</span>
<span class="sd">        List of terms preceding a reported speech.</span>
<span class="sd">    filter_matches : bool</span>
<span class="sd">        Whether to filter out overlapping matches.</span>
<span class="sd">    attr : str</span>
<span class="sd">        spaCy&#39;s attribute to use:</span>
<span class="sd">        a string with the value &quot;TEXT&quot; or &quot;NORM&quot;,</span>
<span class="sd">        or a dict with the key &#39;term_attr&#39;</span>
<span class="sd">        we can also add a key for each regex.</span>
<span class="sd">    on_ents_only : bool</span>
<span class="sd">        Whether to look for matches around detected entities only.</span>
<span class="sd">        Useful for faster inference in downstream tasks.</span>
<span class="sd">    within_ents : bool</span>
<span class="sd">        Whether to consider cues within entities.</span>
<span class="sd">    explain : bool</span>
<span class="sd">        Whether to keep track of cues for each entity.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
        <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
        <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span>
        <span class="n">quotation</span><span class="o">=</span><span class="n">quotation</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">pseudo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">preceding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">following</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">quotation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">verbs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">within_ents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defaults</span><span class="p">(</span>
            <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
            <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
            <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
            <span class="n">quotation</span><span class="o">=</span><span class="n">quotation</span><span class="p">,</span>
            <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">terms</span><span class="p">[</span><span class="s2">&quot;verbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_verbs</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="s2">&quot;verbs&quot;</span><span class="p">])</span>

        <span class="n">quotation</span> <span class="o">=</span> <span class="n">terms</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;quotation&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
            <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
            <span class="o">**</span><span class="n">terms</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">build_patterns</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">quotation</span><span class="o">=</span><span class="n">quotation</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span> <span class="o">=</span> <span class="n">within_ents</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech_&quot;</span><span class="p">):</span>
            <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;reported_speech_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">token</span><span class="p">:</span> <span class="s2">&quot;REPORTED&quot;</span>
                <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span>
                <span class="k">else</span> <span class="s2">&quot;DIRECT&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech_&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
                <span class="s2">&quot;reported_speech_&quot;</span><span class="p">,</span>
                <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">span</span><span class="p">:</span> <span class="s2">&quot;REPORTED&quot;</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span> <span class="k">else</span> <span class="s2">&quot;DIRECT&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech_cues&quot;</span><span class="p">):</span>
            <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech_cues&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;rspeechs&quot;</span><span class="p">):</span>
            <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;rspeechs&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">def</span> <span class="nf">load_verbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Conjugate reporting verbs to specific tenses (trhid person)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbs: list of reporting verbs to conjugate</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list_rep_verbs: List of reporting verbs conjugated to specific tenses.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rep_verbs</span> <span class="o">=</span> <span class="n">get_verbs</span><span class="p">(</span><span class="n">verbs</span><span class="p">)</span>

        <span class="n">rep_verbs</span> <span class="o">=</span> <span class="n">rep_verbs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="p">(</span>
                <span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Indicatif&quot;</span><span class="p">)</span>
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Présent&quot;</span><span class="p">)</span>
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;person&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;3s&quot;</span><span class="p">,</span> <span class="s2">&quot;3p&quot;</span><span class="p">]))</span>
            <span class="p">)</span>
            <span class="o">|</span> <span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Participe Présent&quot;</span><span class="p">)</span>
            <span class="o">|</span> <span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Participe Passé&quot;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">list_rep_verbs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">list_rep_verbs</span>

    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Finds entities related to reported speech.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc: spaCy Doc object</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        doc: spaCy Doc object, annotated for negation</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
        <span class="n">matches</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="n">entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discarded&quot;</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="n">ents</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Removes duplicate matches and pseudo-expressions in one statement</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>

            <span class="n">ents</span><span class="p">,</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
                <span class="n">entities</span><span class="p">,</span>
                <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
                <span class="n">second_chance</span><span class="o">=</span><span class="n">ents</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">sub_matches</span><span class="p">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
                <span class="n">matches</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ents</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">sub_preceding</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;preceding&quot;</span><span class="p">)</span>
            <span class="n">sub_following</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;following&quot;</span><span class="p">)</span>
            <span class="n">sub_verbs</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;verbs&quot;</span><span class="p">)</span>
            <span class="n">sub_quotation</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;quotation&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_following</span> <span class="o">+</span> <span class="n">sub_verbs</span> <span class="o">+</span> <span class="n">sub_quotation</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="nb">any</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span><span class="p">)</span>
                        <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span><span class="p">)</span>
                        <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span>
                            <span class="p">((</span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_quotation</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span><span class="p">:</span>
                    <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
                    <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
                    <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>

                <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span>
                    <span class="n">m</span>
                    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_quotation</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
                <span class="p">]</span>

                <span class="n">reported_speech</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span> <span class="ow">or</span> <span class="nb">bool</span><span class="p">(</span><span class="n">cues</span><span class="p">)</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span> <span class="o">=</span> <span class="n">reported_speech</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain</span><span class="p">:</span>
                    <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech_cues</span> <span class="o">+=</span> <span class="n">cues</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="n">reported_speech</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">:</span>
                        <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.reported_speech.reported_speech.ReportedSpeech.defaults" class="doc doc-heading">
<code class="highlight language-python"><span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span> <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span> <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span> <span class="n">quotation</span><span class="o">=</span><span class="n">quotation</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.reported_speech.reported_speech.ReportedSpeech.regex_matcher" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h8 id="edsnlp.pipelines.qualifiers.reported_speech.reported_speech.ReportedSpeech.within_ents" class="doc doc-heading">
<code class="highlight language-python"><span class="n">within_ents</span> <span class="o">=</span> <span class="n">within_ents</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.reported_speech.reported_speech.ReportedSpeech.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">pseudo</span><span class="p">,</span> <span class="n">preceding</span><span class="p">,</span> <span class="n">following</span><span class="p">,</span> <span class="n">quotation</span><span class="p">,</span> <span class="n">verbs</span><span class="p">,</span> <span class="n">on_ents_only</span><span class="p">,</span> <span class="n">within_ents</span><span class="p">,</span> <span class="n">explain</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/reported_speech/reported_speech.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">pseudo</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">preceding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">following</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">quotation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">verbs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">on_ents_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">within_ents</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">explain</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>

    <span class="n">terms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defaults</span><span class="p">(</span>
        <span class="n">pseudo</span><span class="o">=</span><span class="n">pseudo</span><span class="p">,</span>
        <span class="n">preceding</span><span class="o">=</span><span class="n">preceding</span><span class="p">,</span>
        <span class="n">following</span><span class="o">=</span><span class="n">following</span><span class="p">,</span>
        <span class="n">quotation</span><span class="o">=</span><span class="n">quotation</span><span class="p">,</span>
        <span class="n">verbs</span><span class="o">=</span><span class="n">verbs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">terms</span><span class="p">[</span><span class="s2">&quot;verbs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_verbs</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="s2">&quot;verbs&quot;</span><span class="p">])</span>

    <span class="n">quotation</span> <span class="o">=</span> <span class="n">terms</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;quotation&quot;</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">on_ents_only</span><span class="o">=</span><span class="n">on_ents_only</span><span class="p">,</span>
        <span class="n">explain</span><span class="o">=</span><span class="n">explain</span><span class="p">,</span>
        <span class="o">**</span><span class="n">terms</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span> <span class="o">=</span> <span class="n">RegexMatcher</span><span class="p">(</span><span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="o">.</span><span class="n">build_patterns</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">quotation</span><span class="o">=</span><span class="n">quotation</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span> <span class="o">=</span> <span class="n">within_ents</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.reported_speech.reported_speech.ReportedSpeech.set_extensions" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_extensions</span><span class="p">()</span></code>


</h8>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/reported_speech/reported_speech.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">set_extensions</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Token</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech_&quot;</span><span class="p">):</span>
        <span class="n">Token</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;reported_speech_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">token</span><span class="p">:</span> <span class="s2">&quot;REPORTED&quot;</span>
            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span>
            <span class="k">else</span> <span class="s2">&quot;DIRECT&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech_&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span>
            <span class="s2">&quot;reported_speech_&quot;</span><span class="p">,</span>
            <span class="n">getter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">span</span><span class="p">:</span> <span class="s2">&quot;REPORTED&quot;</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span> <span class="k">else</span> <span class="s2">&quot;DIRECT&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Span</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech_cues&quot;</span><span class="p">):</span>
        <span class="n">Span</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;reported_speech_cues&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Doc</span><span class="o">.</span><span class="n">has_extension</span><span class="p">(</span><span class="s2">&quot;rspeechs&quot;</span><span class="p">):</span>
        <span class="n">Doc</span><span class="o">.</span><span class="n">set_extension</span><span class="p">(</span><span class="s2">&quot;rspeechs&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.reported_speech.reported_speech.ReportedSpeech.load_verbs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_verbs</span><span class="p">(</span><span class="n">verbs</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Conjugate reporting verbs to specific tenses (trhid person)</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>verbs</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.List">List</span>[str]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>list_rep_verbs</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/reported_speech/reported_speech.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load_verbs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conjugate reporting verbs to specific tenses (trhid person)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    verbs: list of reporting verbs to conjugate</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list_rep_verbs: List of reporting verbs conjugated to specific tenses.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">rep_verbs</span> <span class="o">=</span> <span class="n">get_verbs</span><span class="p">(</span><span class="n">verbs</span><span class="p">)</span>

    <span class="n">rep_verbs</span> <span class="o">=</span> <span class="n">rep_verbs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
        <span class="p">(</span>
            <span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Indicatif&quot;</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Présent&quot;</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;person&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s2">&quot;3s&quot;</span><span class="p">,</span> <span class="s2">&quot;3p&quot;</span><span class="p">]))</span>
        <span class="p">)</span>
        <span class="o">|</span> <span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Participe Présent&quot;</span><span class="p">)</span>
        <span class="o">|</span> <span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;tense&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Participe Passé&quot;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">list_rep_verbs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rep_verbs</span><span class="p">[</span><span class="s2">&quot;term&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">list_rep_verbs</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h8 id="edsnlp.pipelines.qualifiers.reported_speech.reported_speech.ReportedSpeech.process" class="doc doc-heading">
<code class="highlight language-python"><span class="n">process</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h8>


    <div class="doc doc-contents ">

      <p>Finds entities related to reported speech.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>doc</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/pipelines/qualifiers/reported_speech/reported_speech.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Doc</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds entities related to reported speech.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc: spaCy Doc object</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    doc: spaCy Doc object, annotated for negation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matches</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
    <span class="n">matches</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regex_matcher</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="n">boundaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundaries</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="n">entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;discarded&quot;</span><span class="p">,</span> <span class="p">[]))</span>
    <span class="n">ents</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Removes duplicate matches and pseudo-expressions in one statement</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">matches</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="s2">&quot;pseudo&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">boundaries</span><span class="p">:</span>

        <span class="n">ents</span><span class="p">,</span> <span class="n">entities</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
            <span class="n">entities</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">check_inclusion</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">),</span>
            <span class="n">second_chance</span><span class="o">=</span><span class="n">ents</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">sub_matches</span><span class="p">,</span> <span class="n">matches</span> <span class="o">=</span> <span class="n">consume_spans</span><span class="p">(</span>
            <span class="n">matches</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ents</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">sub_preceding</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;preceding&quot;</span><span class="p">)</span>
        <span class="n">sub_following</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;following&quot;</span><span class="p">)</span>
        <span class="n">sub_verbs</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;verbs&quot;</span><span class="p">)</span>
        <span class="n">sub_quotation</span> <span class="o">=</span> <span class="n">get_spans</span><span class="p">(</span><span class="n">sub_matches</span><span class="p">,</span> <span class="s2">&quot;quotation&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_following</span> <span class="o">+</span> <span class="n">sub_verbs</span> <span class="o">+</span> <span class="n">sub_quotation</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="nb">any</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span>
                        <span class="p">((</span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">token</span><span class="o">.</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_quotation</span>
                    <span class="p">)</span>
                <span class="p">)</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">ents</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">within_ents</span><span class="p">:</span>
                <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>
                <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cues</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_preceding</span> <span class="o">+</span> <span class="n">sub_verbs</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">]</span>
                <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_following</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">]</span>

            <span class="n">cues</span> <span class="o">+=</span> <span class="p">[</span>
                <span class="n">m</span>
                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sub_quotation</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">ent</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">ent</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>
            <span class="p">]</span>

            <span class="n">reported_speech</span> <span class="o">=</span> <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span> <span class="ow">or</span> <span class="nb">bool</span><span class="p">(</span><span class="n">cues</span><span class="p">)</span>
            <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span> <span class="o">=</span> <span class="n">reported_speech</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">explain</span><span class="p">:</span>
                <span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech_cues</span> <span class="o">+=</span> <span class="n">cues</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_ents_only</span> <span class="ow">and</span> <span class="n">reported_speech</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">:</span>
                    <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">reported_speech</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">doc</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="edsnlp.matchers" class="doc doc-heading">
        <code>matchers</code>



</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h4 id="edsnlp.matchers.regex" class="doc doc-heading">
        <code>regex</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="edsnlp.matchers.regex.RegexMatcher" class="doc doc-heading">
          <code>RegexMatcher</code>



</h5>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code>object</code></p>


      <p>Simple RegExp matcher.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>alignment_mode</code></td>
          <td class="doc-param-details">
            <p>How spans should be aligned with tokens.
Possible values are <code>strict</code> (character indices must be aligned
with token boundaries), "contract" (span of all tokens completely
within the character span), "expand" (span of all tokens at least
partially covered by the character span).
Defaults to <code>expand</code>.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>Default attribute to match on, by default "TEXT".
Can be overiden in the <code>add</code> method.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether to skip exclusions</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/matchers/regex.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">RegexMatcher</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simple RegExp matcher.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    alignment_mode : str</span>
<span class="sd">        How spans should be aligned with tokens.</span>
<span class="sd">        Possible values are `strict` (character indices must be aligned</span>
<span class="sd">        with token boundaries), &quot;contract&quot; (span of all tokens completely</span>
<span class="sd">        within the character span), &quot;expand&quot; (span of all tokens at least</span>
<span class="sd">        partially covered by the character span).</span>
<span class="sd">        Defaults to `expand`.</span>
<span class="sd">    attr : str</span>
<span class="sd">        Default attribute to match on, by default &quot;TEXT&quot;.</span>
<span class="sd">        Can be overiden in the `add` method.</span>
<span class="sd">    ignore_excluded : bool</span>
<span class="sd">        Whether to skip exclusions</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">alignment_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;expand&quot;</span><span class="p">,</span>
        <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alignment_mode</span> <span class="o">=</span> <span class="n">alignment_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_attr</span> <span class="o">=</span> <span class="n">attr</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_excluded</span> <span class="o">=</span> <span class="n">ignore_excluded</span>

    <span class="k">def</span> <span class="nf">build_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">regex</span><span class="p">:</span> <span class="n">Patterns</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build patterns and adds them for matching.</span>
<span class="sd">        Helper function for pipelines using this matcher.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        regex : Patterns</span>
<span class="sd">            Dictionary of label/terms, or label/dictionary of terms/attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">regex</span><span class="p">:</span>
            <span class="n">regex</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">patterns</span> <span class="ow">in</span> <span class="n">regex</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attr&quot;</span><span class="p">)</span>
                <span class="n">alignment_mode</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alignment_mode&quot;</span><span class="p">)</span>
                <span class="n">patterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;regex&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">attr</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">alignment_mode</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span><span class="n">patterns</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">patterns</span><span class="o">=</span><span class="n">patterns</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="o">=</span><span class="n">alignment_mode</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">attr</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">alignment_mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a pattern to the registry.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            Key of the new/updated pattern.</span>
<span class="sd">        patterns : List[str]</span>
<span class="sd">            List of patterns to add.</span>
<span class="sd">        attr : str, optional</span>
<span class="sd">            Attribute to use for matching.</span>
<span class="sd">            By default uses the `default_attr` attribute</span>
<span class="sd">        ignore_excluded : bool, optional</span>
<span class="sd">            Whether to skip excluded tokens during matching.</span>
<span class="sd">        alignment_mode : str, optional</span>
<span class="sd">            Overwrite alignment mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">attr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_attr</span>

        <span class="k">if</span> <span class="n">ignore_excluded</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ignore_excluded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_excluded</span>

        <span class="k">if</span> <span class="n">alignment_mode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">alignment_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignment_mode</span>

        <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span><span class="n">compile_regex</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span> <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove a pattern for the registry.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : str</span>
<span class="sd">            key of the pattern to remove.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the key is not present in the registered patterns.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">am</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">am</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">key</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">` is not referenced in the matcher&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">regex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">regex</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">match</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">doclike</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Doc</span><span class="p">,</span> <span class="n">Span</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">Match</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterates on the matches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doclike:</span>
<span class="sd">            spaCy Doc or Span object to match on.</span>

<span class="sd">        Yields</span>
<span class="sd">        -------</span>
<span class="sd">        span:</span>
<span class="sd">            A match.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">,</span> <span class="n">alignment_mode</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">get_text</span><span class="p">(</span><span class="n">doclike</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">pattern</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matched a regex from </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="n">span</span> <span class="o">=</span> <span class="n">create_span</span><span class="p">(</span>
                        <span class="n">doclike</span><span class="o">=</span><span class="n">doclike</span><span class="p">,</span>
                        <span class="n">start_char</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span>
                        <span class="n">end_char</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">(),</span>
                        <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
                        <span class="n">alignment_mode</span><span class="o">=</span><span class="n">alignment_mode</span><span class="p">,</span>
                        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="n">span</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="k">yield</span> <span class="n">span</span><span class="p">,</span> <span class="n">match</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">doclike</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Doc</span><span class="p">,</span> <span class="n">Span</span><span class="p">],</span>
        <span class="n">as_spans</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">return_groupdict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs matching. Yields matches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doclike:</span>
<span class="sd">            spaCy Doc or Span object.</span>
<span class="sd">        as_spans:</span>
<span class="sd">            Returns matches as spans.</span>

<span class="sd">        Yields</span>
<span class="sd">        ------</span>
<span class="sd">        span:</span>
<span class="sd">            A match.</span>
<span class="sd">        groupdict:</span>
<span class="sd">            Additional information coming from the named patterns</span>
<span class="sd">            in the regular expression.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">span</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">doclike</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">as_spans</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="n">doclike</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">i</span>
                <span class="n">span</span> <span class="o">=</span> <span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">offset</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">return_groupdict</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">span</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">span</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.matchers.regex.RegexMatcher.alignment_mode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">alignment_mode</span> <span class="o">=</span> <span class="n">alignment_mode</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.matchers.regex.RegexMatcher.regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">regex</span> <span class="o">=</span> <span class="p">[]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.matchers.regex.RegexMatcher.default_attr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">default_attr</span> <span class="o">=</span> <span class="n">attr</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.matchers.regex.RegexMatcher.ignore_excluded" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ignore_excluded</span> <span class="o">=</span> <span class="n">ignore_excluded</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.regex.RegexMatcher.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">alignment_mode</span><span class="o">=</span><span class="s1">&#39;expand&#39;</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;TEXT&#39;</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">alignment_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;expand&quot;</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alignment_mode</span> <span class="o">=</span> <span class="n">alignment_mode</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default_attr</span> <span class="o">=</span> <span class="n">attr</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ignore_excluded</span> <span class="o">=</span> <span class="n">ignore_excluded</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.regex.RegexMatcher.build_patterns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">build_patterns</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Build patterns and adds them for matching.
Helper function for pipelines using this matcher.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>regex</code></td>
          <td class="doc-param-details">
            <p>Dictionary of label/terms, or label/dictionary of terms/attribute.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Patterns</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">build_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">regex</span><span class="p">:</span> <span class="n">Patterns</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build patterns and adds them for matching.</span>
<span class="sd">    Helper function for pipelines using this matcher.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    regex : Patterns</span>
<span class="sd">        Dictionary of label/terms, or label/dictionary of terms/attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">regex</span><span class="p">:</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">patterns</span> <span class="ow">in</span> <span class="n">regex</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attr&quot;</span><span class="p">)</span>
            <span class="n">alignment_mode</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;alignment_mode&quot;</span><span class="p">)</span>
            <span class="n">patterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;regex&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">alignment_mode</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span><span class="n">patterns</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
            <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">patterns</span><span class="o">=</span><span class="n">patterns</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="o">=</span><span class="n">alignment_mode</span>
        <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.regex.RegexMatcher.add" class="doc doc-heading">
<code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Add a pattern to the registry.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td class="doc-param-details">
            <p>Key of the new/updated pattern.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>patterns</code></td>
          <td class="doc-param-details">
            <p>List of patterns to add.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>Attribute to use for matching.
By default uses the <code>default_attr</code> attribute</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether to skip excluded tokens during matching.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>alignment_mode</code></td>
          <td class="doc-param-details">
            <p>Overwrite alignment mode.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">add</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">alignment_mode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a pattern to the registry.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        Key of the new/updated pattern.</span>
<span class="sd">    patterns : List[str]</span>
<span class="sd">        List of patterns to add.</span>
<span class="sd">    attr : str, optional</span>
<span class="sd">        Attribute to use for matching.</span>
<span class="sd">        By default uses the `default_attr` attribute</span>
<span class="sd">    ignore_excluded : bool, optional</span>
<span class="sd">        Whether to skip excluded tokens during matching.</span>
<span class="sd">    alignment_mode : str, optional</span>
<span class="sd">        Overwrite alignment mode.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">attr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_attr</span>

    <span class="k">if</span> <span class="n">ignore_excluded</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ignore_excluded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_excluded</span>

    <span class="k">if</span> <span class="n">alignment_mode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">alignment_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alignment_mode</span>

    <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span><span class="n">compile_regex</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span> <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.regex.RegexMatcher.remove" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Remove a pattern for the registry.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td class="doc-param-details">
            <p>key of the pattern to remove.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code>ValueError</code>
            </span>
          </td>
          <td class="doc-raises-details">
            <p>If the key is not present in the registered patterns.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">remove</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove a pattern for the registry.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : str</span>
<span class="sd">        key of the pattern to remove.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the key is not present in the registered patterns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">am</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">am</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">key</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">` is not referenced in the matcher&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.regex.RegexMatcher.__len__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span></code>


</h6>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">regex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">regex</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="p">]))</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.regex.RegexMatcher.match" class="doc doc-heading">
<code class="highlight language-python"><span class="k">match</span><span class="p">(</span><span class="n">doclike</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Iterates on the matches.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doclike</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc or Span object to match on.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.Union">Union</span>[<span title="spacy.tokens.Doc">Doc</span>, <span title="spacy.tokens.Span">Span</span>]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>YIELDS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-yields-annotation">
                  <code>span</code>
              </span>
          </td>
          <td class="doc-yields-details">
            <p>A match.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">match</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">doclike</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Doc</span><span class="p">,</span> <span class="n">Span</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">Match</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterates on the matches.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doclike:</span>
<span class="sd">        spaCy Doc or Span object to match on.</span>

<span class="sd">    Yields</span>
<span class="sd">    -------</span>
<span class="sd">    span:</span>
<span class="sd">        A match.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">,</span> <span class="n">alignment_mode</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">regex</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">get_text</span><span class="p">(</span><span class="n">doclike</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">patterns</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">pattern</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matched a regex from </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">span</span> <span class="o">=</span> <span class="n">create_span</span><span class="p">(</span>
                    <span class="n">doclike</span><span class="o">=</span><span class="n">doclike</span><span class="p">,</span>
                    <span class="n">start_char</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span>
                    <span class="n">end_char</span><span class="o">=</span><span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">(),</span>
                    <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
                    <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
                    <span class="n">alignment_mode</span><span class="o">=</span><span class="n">alignment_mode</span><span class="p">,</span>
                    <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">span</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">yield</span> <span class="n">span</span><span class="p">,</span> <span class="n">match</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.regex.RegexMatcher.__call__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">doclike</span><span class="p">,</span> <span class="n">as_spans</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_groupdict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Performs matching. Yields matches.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doclike</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc or Span object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.Union">Union</span>[<span title="spacy.tokens.Doc">Doc</span>, <span title="spacy.tokens.Span">Span</span>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>as_spans</code></td>
          <td class="doc-param-details">
            <p>Returns matches as spans.</p>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>YIELDS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-yields-annotation">
                  <code>span</code>
              </span>
          </td>
          <td class="doc-yields-details">
            <p>A match.</p>
          </td>
        </tr>
        <tr>
          <td>
              <span class="doc-yields-annotation">
                  <code>groupdict</code>
              </span>
          </td>
          <td class="doc-yields-details">
            <p>Additional information coming from the named patterns
in the regular expression.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">doclike</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Doc</span><span class="p">,</span> <span class="n">Span</span><span class="p">],</span>
    <span class="n">as_spans</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">return_groupdict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs matching. Yields matches.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doclike:</span>
<span class="sd">        spaCy Doc or Span object.</span>
<span class="sd">    as_spans:</span>
<span class="sd">        Returns matches as spans.</span>

<span class="sd">    Yields</span>
<span class="sd">    ------</span>
<span class="sd">    span:</span>
<span class="sd">        A match.</span>
<span class="sd">    groupdict:</span>
<span class="sd">        Additional information coming from the named patterns</span>
<span class="sd">        in the regular expression.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">span</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">doclike</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">as_spans</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">doclike</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">i</span>
            <span class="n">span</span> <span class="o">=</span> <span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">offset</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">offset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">return_groupdict</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">span</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">span</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h5 id="edsnlp.matchers.regex.get_first_included" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_first_included</span><span class="p">(</span><span class="n">doclike</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@lru_cache</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_first_included</span><span class="p">(</span><span class="n">doclike</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Doc</span><span class="p">,</span> <span class="n">Span</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Token</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doclike</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">excluded</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">token</span>
    <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;The provided Span does not include any token&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.matchers.regex.create_span" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_span</span><span class="p">(</span><span class="n">doclike</span><span class="p">,</span> <span class="n">start_char</span><span class="p">,</span> <span class="n">end_char</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">alignment_mode</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>spaCy only allows strict alignment mode for char_span on Spans.
This method circumvents this.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doclike</code></td>
          <td class="doc-param-details">
            <p><code>Doc</code> or <code>Span</code>.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[Doc, Span]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>start_char</code></td>
          <td class="doc-param-details">
            <p>Character index within the Doc-like object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>end_char</code></td>
          <td class="doc-param-details">
            <p>Character index of the end, within the Doc-like object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>key</code></td>
          <td class="doc-param-details">
            <p>The key used to match.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>alignment_mode</code></td>
          <td class="doc-param-details">
            <p>The alignment mode.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether to skip excluded tokens.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>span</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A span matched on the Doc-like object.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_span</span><span class="p">(</span>
    <span class="n">doclike</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Doc</span><span class="p">,</span> <span class="n">Span</span><span class="p">],</span>
    <span class="n">start_char</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">end_char</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">alignment_mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Span</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    spaCy only allows strict alignment mode for char_span on Spans.</span>
<span class="sd">    This method circumvents this.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doclike : Union[Doc, Span]</span>
<span class="sd">        `Doc` or `Span`.</span>
<span class="sd">    start_char : int</span>
<span class="sd">        Character index within the Doc-like object.</span>
<span class="sd">    end_char : int</span>
<span class="sd">        Character index of the end, within the Doc-like object.</span>
<span class="sd">    key : str</span>
<span class="sd">        The key used to match.</span>
<span class="sd">    alignment_mode : str</span>
<span class="sd">        The alignment mode.</span>
<span class="sd">    ignore_excluded : bool</span>
<span class="sd">        Whether to skip excluded tokens.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    span:</span>
<span class="sd">        A span matched on the Doc-like object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">doc</span> <span class="o">=</span> <span class="n">doclike</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doclike</span><span class="p">,</span> <span class="n">Doc</span><span class="p">)</span> <span class="k">else</span> <span class="n">doclike</span><span class="o">.</span><span class="n">doc</span>

    <span class="c1"># Handle the simple case immediately</span>
    <span class="k">if</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;TEXT&quot;</span><span class="p">,</span> <span class="s2">&quot;LOWER&quot;</span><span class="p">}</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ignore_excluded</span><span class="p">:</span>
        <span class="n">off</span> <span class="o">=</span> <span class="n">doclike</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">idx</span>
        <span class="k">return</span> <span class="n">doc</span><span class="o">.</span><span class="n">char_span</span><span class="p">(</span>
            <span class="n">start_char</span> <span class="o">+</span> <span class="n">off</span><span class="p">,</span>
            <span class="n">end_char</span> <span class="o">+</span> <span class="n">off</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
            <span class="n">alignment_mode</span><span class="o">=</span><span class="n">alignment_mode</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># If doclike is a Span, we need to get the clean</span>
    <span class="c1"># index of the first included token</span>
    <span class="k">if</span> <span class="n">ignore_excluded</span><span class="p">:</span>
        <span class="n">original</span><span class="p">,</span> <span class="n">clean</span> <span class="o">=</span> <span class="n">alignment</span><span class="p">(</span>
            <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">first_included</span> <span class="o">=</span> <span class="n">get_first_included</span><span class="p">(</span><span class="n">doclike</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="n">original</span><span class="p">,</span> <span class="n">first_included</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">first</span> <span class="o">=</span> <span class="n">clean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">first</span> <span class="o">=</span> <span class="n">doclike</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">idx</span>

    <span class="n">start_char</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">first</span>
        <span class="o">+</span> <span class="n">start_char</span>
        <span class="o">+</span> <span class="n">offset</span><span class="p">(</span>
            <span class="n">doc</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">first</span> <span class="o">+</span> <span class="n">start_char</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">end_char</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">first</span>
        <span class="o">+</span> <span class="n">end_char</span>
        <span class="o">+</span> <span class="n">offset</span><span class="p">(</span>
            <span class="n">doc</span><span class="p">,</span>
            <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
            <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">first</span> <span class="o">+</span> <span class="n">end_char</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">char_span</span><span class="p">(</span>
        <span class="n">start_char</span><span class="p">,</span>
        <span class="n">end_char</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
        <span class="n">alignment_mode</span><span class="o">=</span><span class="n">alignment_mode</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">span</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.matchers.utils" class="doc doc-heading">
        <code>utils</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.matchers.utils.ListOrStr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ListOrStr</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.matchers.utils.DictOrPattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DictOrPattern</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ListOrStr</span><span class="p">],</span> <span class="n">ListOrStr</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.matchers.utils.Patterns" class="doc doc-heading">
<code class="highlight language-python"><span class="n">Patterns</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DictOrPattern</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.matchers.utils.ATTRIBUTES" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;LOWER&#39;</span><span class="p">:</span> <span class="s1">&#39;lower_&#39;</span><span class="p">,</span> <span class="s1">&#39;TEXT&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;NORM&#39;</span><span class="p">:</span> <span class="s1">&#39;norm_&#39;</span><span class="p">,</span> <span class="s1">&#39;SHAPE&#39;</span><span class="p">:</span> <span class="s1">&#39;shape_&#39;</span><span class="p">}</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>






  <div class="doc doc-object doc-module">



<h5 id="edsnlp.matchers.utils.offset" class="doc doc-heading">
        <code>offset</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.utils.offset.token_length" class="doc doc-heading">
<code class="highlight language-python"><span class="n">token_length</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">custom</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/utils/offset.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">token_length</span><span class="p">(</span><span class="n">token</span><span class="p">:</span> <span class="n">Token</span><span class="p">,</span> <span class="n">custom</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">custom</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.utils.offset.alignment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">alignment</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;TEXT&#39;</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Align different representations of a <code>Doc</code> or <code>Span</code> object.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy <code>Doc</code> or <code>Span</code> object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>Attribute to use, by default <code>"TEXT"</code></p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;TEXT&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether to remove excluded tokens, by default True</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Tuple[List[int], List[int]]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>An alignment tuple: original and clean lists.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/utils/offset.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">alignment</span><span class="p">(</span>
    <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Align different representations of a `Doc` or `Span` object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        spaCy `Doc` or `Span` object</span>
<span class="sd">    attr : str, optional</span>
<span class="sd">        Attribute to use, by default `&quot;TEXT&quot;`</span>
<span class="sd">    ignore_excluded : bool, optional</span>
<span class="sd">        Whether to remove excluded tokens, by default True</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tuple[List[int], List[int]]</span>
<span class="sd">        An alignment tuple: original and clean lists.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">Doc</span><span class="p">)</span>

    <span class="n">attr</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">attr</span> <span class="o">=</span> <span class="n">ATTRIBUTES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

    <span class="n">custom</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">custom</span><span class="p">:</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="n">attr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="c1"># Define the length function</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">token_length</span><span class="p">,</span> <span class="n">custom</span><span class="o">=</span><span class="n">custom</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">)</span>

    <span class="n">original</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">clean</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">cursor</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_excluded</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">excluded</span><span class="p">:</span>

            <span class="c1"># The token is not excluded, we add its extremities to the list</span>
            <span class="n">original</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span>

            <span class="c1"># We add the cursor</span>
            <span class="n">clean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cursor</span><span class="p">)</span>
            <span class="n">cursor</span> <span class="o">+=</span> <span class="n">length</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">token</span><span class="o">.</span><span class="n">whitespace_</span><span class="p">:</span>
                <span class="n">cursor</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">original</span><span class="p">,</span> <span class="n">clean</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.utils.offset.offset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">offset</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Compute offset between the original text and a given representation
(defined by the couple <code>attr</code>, <code>ignore_excluded</code>).</p>
<p>The alignment itself is computed with
<a href="matchers/utils/offset/#edsnlp.matchers.utils.offset.alignment"><code>alignment</code></a>.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>The spaCy <code>Doc</code> object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Doc</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>The attribute used by the <a href="matchers/regex/#edsnlp.matchers.regex.RegexMatcher"><code>RegexMatcher</code></a>
(eg <code>NORM</code>)</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether the RegexMatcher ignores excluded tokens.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>index</code></td>
          <td class="doc-param-details">
            <p>The index in the pre-processed text.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>int</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The offset. To get the character index in the original document,
just do: <code class="highlight"><span class="n">original</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="n">offset</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></code></p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/utils/offset.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">offset</span><span class="p">(</span>
    <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute offset between the original text and a given representation</span>
<span class="sd">    (defined by the couple `attr`, `ignore_excluded`).</span>

<span class="sd">    The alignment itself is computed with</span>
<span class="sd">    [`alignment`][edsnlp.matchers.utils.offset.alignment].</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc : Doc</span>
<span class="sd">        The spaCy `Doc` object</span>
<span class="sd">    attr : str</span>
<span class="sd">        The attribute used by the [`RegexMatcher`][edsnlp.matchers.regex.RegexMatcher]</span>
<span class="sd">        (eg `NORM`)</span>
<span class="sd">    ignore_excluded : bool</span>
<span class="sd">        Whether the RegexMatcher ignores excluded tokens.</span>
<span class="sd">    index : int</span>
<span class="sd">        The index in the pre-processed text.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    int</span>
<span class="sd">        The offset. To get the character index in the original document,</span>
<span class="sd">        just do: `#!python original = index + offset(doc, attr, ignore_excluded, index)`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">original</span><span class="p">,</span> <span class="n">clean</span> <span class="o">=</span> <span class="n">alignment</span><span class="p">(</span>
        <span class="n">doc</span><span class="o">=</span><span class="n">doc</span><span class="p">,</span>
        <span class="n">attr</span><span class="o">=</span><span class="n">attr</span><span class="p">,</span>
        <span class="n">ignore_excluded</span><span class="o">=</span><span class="n">ignore_excluded</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># We use bisect to efficiently find the correct rightmost-lower index</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="n">clean</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">original</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">original</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">clean</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h5 id="edsnlp.matchers.utils.text" class="doc doc-heading">
        <code>text</code>



</h5>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h6 id="edsnlp.matchers.utils.text.get_text" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_text</span><span class="p">(</span><span class="n">doclike</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">ignore_excluded</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Get text using a custom attribute, possibly ignoring excluded tokens.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doclike</code></td>
          <td class="doc-param-details">
            <p>Doc or Span to get text from.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[Doc, Span]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>Attribute to use.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>ignore_excluded</code></td>
          <td class="doc-param-details">
            <p>Whether to skip excluded tokens, by default False</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>str</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Extracted text.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/matchers/utils/text.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@lru_cache</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_text</span><span class="p">(</span>
    <span class="n">doclike</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Doc</span><span class="p">,</span> <span class="n">Span</span><span class="p">],</span>
    <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">ignore_excluded</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get text using a custom attribute, possibly ignoring excluded tokens.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doclike : Union[Doc, Span]</span>
<span class="sd">        Doc or Span to get text from.</span>
<span class="sd">    attr : str</span>
<span class="sd">        Attribute to use.</span>
<span class="sd">    ignore_excluded : bool</span>
<span class="sd">        Whether to skip excluded tokens, by default False</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Extracted text.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">attr</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ignore_excluded</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s2">&quot;TEXT&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">doclike</span><span class="o">.</span><span class="n">text</span>
        <span class="k">elif</span> <span class="n">attr</span> <span class="o">==</span> <span class="s2">&quot;LOWER&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">doclike</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tokens</span> <span class="o">=</span> <span class="n">doclike</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">doclike</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">t</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">excluded</span><span class="p">]</span>

    <span class="n">attr</span> <span class="o">=</span> <span class="n">ATTRIBUTES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
        <span class="n">attr</span> <span class="o">=</span> <span class="n">attr</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">getattr</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="n">whitespace_</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">getattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="n">whitespace_</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="edsnlp.connectors" class="doc doc-heading">
        <code>connectors</code>



</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h4 id="edsnlp.connectors.brat" class="doc doc-heading">
        <code>brat</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="edsnlp.connectors.brat.BratConnector" class="doc doc-heading">
          <code>BratConnector</code>



</h5>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code>object</code></p>


      <p>Two-way connector with BRAT. Supports entities only.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>directory</code></td>
          <td class="doc-param-details">
            <p>Directory containing the BRAT files.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>n_jobs</code></td>
          <td class="doc-param-details">
            <p>Number of jobs for multiprocessing, by default 1</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int, optional</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">BratConnector</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Two-way connector with BRAT. Supports entities only.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    directory : str</span>
<span class="sd">        Directory containing the BRAT files.</span>
<span class="sd">    n_jobs : int, optional</span>
<span class="sd">        Number of jobs for multiprocessing, by default 1</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>

        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">full_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a file within the BRAT directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename:</span>
<span class="sd">            The path to the file within the BRAT directory.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        text:</span>
<span class="sd">            The text content of the file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_path</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">read_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads all texts from the BRAT folder.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        texts:</span>
<span class="sd">            DataFrame containing all texts in the BRAT directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">)</span>
        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.txt&quot;</span><span class="p">)]</span>

        <span class="k">assert</span> <span class="n">filenames</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;BRAT directory </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="si">}</span><span class="s2"> is empty!&quot;</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The BRAT directory contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span><span class="si">}</span><span class="s2"> annotated documents.&quot;</span>
        <span class="p">)</span>

        <span class="n">texts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">note_id</span><span class="o">=</span><span class="n">filenames</span><span class="p">))</span>

        <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span>
            <span class="n">texts</span><span class="o">.</span><span class="n">note_id</span><span class="p">,</span> <span class="n">ascii</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Text extraction&quot;</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">iterator</span><span class="p">:</span>
            <span class="n">texts</span><span class="p">[</span><span class="s2">&quot;note_text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">note_id</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">note_id</span> <span class="ow">in</span> <span class="n">iterator</span>
            <span class="p">]</span>

        <span class="k">return</span> <span class="n">texts</span>

    <span class="k">def</span> <span class="nf">read_brat_annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">note_id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads BRAT annotation inside the BRAT directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        note_id:</span>
<span class="sd">            Note ID within the BRAT directory.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        annotations:</span>
<span class="sd">            DataFrame containing the annotations for the given note.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_id</span><span class="si">}</span><span class="s2">.ann&quot;</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="n">read_brat_annotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_path</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">annotations</span>

    <span class="k">def</span> <span class="nf">read_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span>
            <span class="n">texts</span><span class="o">.</span><span class="n">note_id</span><span class="p">,</span> <span class="n">ascii</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Annotation extraction&quot;</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">iterator</span><span class="p">:</span>
            <span class="n">dfs</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
                <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_brat_annotation</span><span class="p">)(</span><span class="n">note_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">note_id</span> <span class="ow">in</span> <span class="n">iterator</span>
            <span class="p">)</span>
            <span class="c1"># for note_id in iterator:</span>
            <span class="c1">#     dfs.append(self.read_brat_annotation(note_id))</span>

        <span class="n">annotations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">texts</span><span class="o">.</span><span class="n">note_id</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;note_id&quot;</span><span class="p">])</span>

        <span class="n">annotations</span> <span class="o">=</span> <span class="n">annotations</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">annotations</span>

    <span class="k">def</span> <span class="nf">get_brat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads texts and annotations, and returns two DataFrame objects.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        texts:</span>
<span class="sd">            A DataFrame containing two fields, `note_id` and `note_text`</span>
<span class="sd">        annotations:</span>
<span class="sd">            A DataFrame containing the annotations.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_texts</span><span class="p">()</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_annotations</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">texts</span><span class="p">,</span> <span class="n">annotations</span>

    <span class="k">def</span> <span class="nf">brat2docs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transforms a BRAT folder to a list of spaCy documents.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nlp:</span>
<span class="sd">            A spaCy pipeline.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        docs:</span>
<span class="sd">            List of spaCy documents, with annotations in the `ents` attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">texts</span><span class="p">,</span> <span class="n">annotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brat</span><span class="p">()</span>

        <span class="n">docs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span>
                <span class="n">texts</span><span class="o">.</span><span class="n">note_id</span><span class="p">,</span>
                <span class="n">nlp</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">texts</span><span class="o">.</span><span class="n">note_text</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n_process</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">ascii</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">ncols</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;spaCy conversion&quot;</span><span class="p">,</span>
            <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">),</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">iterator</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">note_id</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>

                <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">note_id</span> <span class="o">=</span> <span class="n">note_id</span>

                <span class="n">ann</span> <span class="o">=</span> <span class="n">annotations</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;note_id == @note_id&quot;</span><span class="p">)</span>

                <span class="n">spans</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ann</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                    <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">char_span</span><span class="p">(</span>
                        <span class="n">row</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
                        <span class="n">row</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
                        <span class="n">label</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
                        <span class="n">alignment_mode</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">spans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

                <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">spans</span><span class="p">)</span>

                <span class="n">docs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">docs</span>

    <span class="k">def</span> <span class="nf">doc2brat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a spaCy document to file in the BRAT directory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        doc:</span>
<span class="sd">            spaCy Doc object. The spans in `ents` will populate the `note_id.ann` file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">note_id</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

        <span class="n">annotations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">ann</span><span class="o">.</span><span class="n">label_</span><span class="p">,</span>
                    <span class="n">lexical_variant</span><span class="o">=</span><span class="n">ann</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                    <span class="n">start</span><span class="o">=</span><span class="n">ann</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
                    <span class="n">end</span><span class="o">=</span><span class="n">ann</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">ann</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">annotations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;annot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">annotations</span><span class="o">.</span><span class="n">label</span>
                <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="o">+</span> <span class="n">annotations</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="o">+</span> <span class="n">annotations</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;T</span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">annotations</span><span class="p">))]</span>

            <span class="n">annotations</span> <span class="o">=</span> <span class="n">annotations</span><span class="p">[[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;annot&quot;</span><span class="p">,</span> <span class="s2">&quot;lexical_variant&quot;</span><span class="p">]]</span>
            <span class="n">annotations</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">full_path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.ann&quot;</span><span class="p">),</span>
                <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.ann&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">docs2brat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a list of spaCy documents to file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        docs:</span>
<span class="sd">            List of spaCy documents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doc2brat</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.connectors.brat.BratConnector.directory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.connectors.brat.BratConnector.n_jobs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.brat.BratConnector.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>

    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.brat.BratConnector.full_path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">full_path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">full_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.brat.BratConnector.read_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Reads a file within the BRAT directory.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td class="doc-param-details">
            <p>The path to the file within the BRAT directory.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>text</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The text content of the file.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads a file within the BRAT directory.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename:</span>
<span class="sd">        The path to the file within the BRAT directory.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    text:</span>
<span class="sd">        The text content of the file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_path</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.brat.BratConnector.read_texts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_texts</span><span class="p">()</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Reads all texts from the BRAT folder.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>texts</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>DataFrame containing all texts in the BRAT directory.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads all texts from the BRAT folder.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    texts:</span>
<span class="sd">        DataFrame containing all texts in the BRAT directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">)</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.txt&quot;</span><span class="p">)]</span>

    <span class="k">assert</span> <span class="n">filenames</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;BRAT directory </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="si">}</span><span class="s2"> is empty!&quot;</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;The BRAT directory contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span><span class="si">}</span><span class="s2"> annotated documents.&quot;</span>
    <span class="p">)</span>

    <span class="n">texts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">note_id</span><span class="o">=</span><span class="n">filenames</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span>
        <span class="n">texts</span><span class="o">.</span><span class="n">note_id</span><span class="p">,</span> <span class="n">ascii</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Text extraction&quot;</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">iterator</span><span class="p">:</span>
        <span class="n">texts</span><span class="p">[</span><span class="s2">&quot;note_text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">note_id</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">note_id</span> <span class="ow">in</span> <span class="n">iterator</span>
        <span class="p">]</span>

    <span class="k">return</span> <span class="n">texts</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.brat.BratConnector.read_brat_annotation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_brat_annotation</span><span class="p">(</span><span class="n">note_id</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Reads BRAT annotation inside the BRAT directory.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>note_id</code></td>
          <td class="doc-param-details">
            <p>Note ID within the BRAT directory.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.Union">Union</span>[str, int]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>annotations</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>DataFrame containing the annotations for the given note.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_brat_annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">note_id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads BRAT annotation inside the BRAT directory.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    note_id:</span>
<span class="sd">        Note ID within the BRAT directory.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    annotations:</span>
<span class="sd">        DataFrame containing the annotations for the given note.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note_id</span><span class="si">}</span><span class="s2">.ann&quot;</span>
    <span class="n">annotations</span> <span class="o">=</span> <span class="n">read_brat_annotation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_path</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">annotations</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.brat.BratConnector.read_annotations" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_annotations</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span>
        <span class="n">texts</span><span class="o">.</span><span class="n">note_id</span><span class="p">,</span> <span class="n">ascii</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Annotation extraction&quot;</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">iterator</span><span class="p">:</span>
        <span class="n">dfs</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)(</span>
            <span class="n">delayed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_brat_annotation</span><span class="p">)(</span><span class="n">note_id</span><span class="p">)</span> <span class="k">for</span> <span class="n">note_id</span> <span class="ow">in</span> <span class="n">iterator</span>
        <span class="p">)</span>
        <span class="c1"># for note_id in iterator:</span>
        <span class="c1">#     dfs.append(self.read_brat_annotation(note_id))</span>

    <span class="n">annotations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="n">texts</span><span class="o">.</span><span class="n">note_id</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;note_id&quot;</span><span class="p">])</span>

    <span class="n">annotations</span> <span class="o">=</span> <span class="n">annotations</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">annotations</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.brat.BratConnector.get_brat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_brat</span><span class="p">()</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Reads texts and annotations, and returns two DataFrame objects.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>texts</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A DataFrame containing two fields, <code>note_id</code> and <code>note_text</code></p>
          </td>
        </tr>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>annotations</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A DataFrame containing the annotations.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_brat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads texts and annotations, and returns two DataFrame objects.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    texts:</span>
<span class="sd">        A DataFrame containing two fields, `note_id` and `note_text`</span>
<span class="sd">    annotations:</span>
<span class="sd">        A DataFrame containing the annotations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">texts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_texts</span><span class="p">()</span>
    <span class="n">annotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_annotations</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">texts</span><span class="p">,</span> <span class="n">annotations</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.brat.BratConnector.brat2docs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">brat2docs</span><span class="p">(</span><span class="n">nlp</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Transforms a BRAT folder to a list of spaCy documents.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>A spaCy pipeline.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.Language">Language</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>docs</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of spaCy documents, with annotations in the <code>ents</code> attribute.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">brat2docs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms a BRAT folder to a list of spaCy documents.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp:</span>
<span class="sd">        A spaCy pipeline.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    docs:</span>
<span class="sd">        List of spaCy documents, with annotations in the `ents` attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">texts</span><span class="p">,</span> <span class="n">annotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_brat</span><span class="p">()</span>

    <span class="n">docs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span>
            <span class="n">texts</span><span class="o">.</span><span class="n">note_id</span><span class="p">,</span>
            <span class="n">nlp</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">texts</span><span class="o">.</span><span class="n">note_text</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n_process</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">ascii</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">ncols</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;spaCy conversion&quot;</span><span class="p">,</span>
        <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">),</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">iterator</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">note_id</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>

            <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">note_id</span> <span class="o">=</span> <span class="n">note_id</span>

            <span class="n">ann</span> <span class="o">=</span> <span class="n">annotations</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;note_id == @note_id&quot;</span><span class="p">)</span>

            <span class="n">spans</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ann</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
                <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">char_span</span><span class="p">(</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
                    <span class="n">alignment_mode</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">spans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

            <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">spans</span><span class="p">)</span>

            <span class="n">docs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">docs</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.brat.BratConnector.doc2brat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">doc2brat</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Writes a spaCy document to file in the BRAT directory.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>doc</code></td>
          <td class="doc-param-details">
            <p>spaCy Doc object. The spans in <code>ents</code> will populate the <code>note_id.ann</code> file.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="spacy.tokens.Doc">Doc</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">doc2brat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes a spaCy document to file in the BRAT directory.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    doc:</span>
<span class="sd">        spaCy Doc object. The spans in `ents` will populate the `note_id.ann` file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">note_id</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="n">annotations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="n">label</span><span class="o">=</span><span class="n">ann</span><span class="o">.</span><span class="n">label_</span><span class="p">,</span>
                <span class="n">lexical_variant</span><span class="o">=</span><span class="n">ann</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                <span class="n">start</span><span class="o">=</span><span class="n">ann</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
                <span class="n">end</span><span class="o">=</span><span class="n">ann</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ann</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">annotations</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;annot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">annotations</span><span class="o">.</span><span class="n">label</span>
            <span class="o">+</span> <span class="s2">&quot; &quot;</span>
            <span class="o">+</span> <span class="n">annotations</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot; &quot;</span>
            <span class="o">+</span> <span class="n">annotations</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;T</span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">annotations</span><span class="p">))]</span>

        <span class="n">annotations</span> <span class="o">=</span> <span class="n">annotations</span><span class="p">[[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;annot&quot;</span><span class="p">,</span> <span class="s2">&quot;lexical_variant&quot;</span><span class="p">]]</span>
        <span class="n">annotations</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">full_path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.ann&quot;</span><span class="p">),</span>
            <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">full_path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.ann&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.brat.BratConnector.docs2brat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">docs2brat</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Writes a list of spaCy documents to file.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>docs</code></td>
          <td class="doc-param-details">
            <p>List of spaCy documents.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.List">List</span>[<span title="spacy.tokens.Doc">Doc</span>]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">docs2brat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes a list of spaCy documents to file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    docs:</span>
<span class="sd">        List of spaCy documents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doc2brat</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h5 id="edsnlp.connectors.brat.read_brat_annotation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">read_brat_annotation</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Read BRAT annotation file and returns a pandas DataFrame.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>filename</code></td>
          <td class="doc-param-details">
            <p>Path to the annotation file.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>annotations</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>DataFrame containing the annotations.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/brat.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_brat_annotation</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read BRAT annotation file and returns a pandas DataFrame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename:</span>
<span class="sd">        Path to the annotation file.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    annotations:</span>
<span class="sd">        DataFrame containing the annotations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="s2">&quot;lexical_variant&quot;</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="n">annotations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;annot&quot;</span><span class="p">,</span> <span class="s2">&quot;lexical_variant&quot;</span><span class="p">])</span>

    <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotations</span><span class="o">.</span><span class="n">annot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;annot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotations</span><span class="o">.</span><span class="n">annot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotations</span><span class="o">.</span><span class="n">annot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;start&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotations</span><span class="o">.</span><span class="n">annot</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">annotations</span><span class="p">[[</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">annotations</span><span class="p">[[</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="n">annotations</span> <span class="o">=</span> <span class="n">annotations</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;annot&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">annotations</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.connectors.omop" class="doc doc-heading">
        <code>omop</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="edsnlp.connectors.omop.OmopConnector" class="doc doc-heading">
          <code>OmopConnector</code>



</h5>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code>object</code></p>


      <p>[summary]</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy language object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>start_char</code></td>
          <td class="doc-param-details">
            <p>Name of the column containing the start character index of the entity,
by default "start_char"</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str, optional</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>end_char</code></td>
          <td class="doc-param-details">
            <p>Name of the column containing the end character index of the entity,
by default "end_char"</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str, optional</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>


          <details class="quote">
            <summary>Source code in <code>edsnlp/connectors/omop.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OmopConnector</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    [summary]</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy language object.</span>
<span class="sd">    start_char : str, optional</span>
<span class="sd">        Name of the column containing the start character index of the entity,</span>
<span class="sd">        by default &quot;start_char&quot;</span>
<span class="sd">    end_char : str, optional</span>
<span class="sd">        Name of the column containing the end character index of the entity,</span>
<span class="sd">        by default &quot;end_char&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
        <span class="n">start_char</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;start_char&quot;</span><span class="p">,</span>
        <span class="n">end_char</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;end_char&quot;</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_char</span> <span class="o">=</span> <span class="n">start_char</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_char</span> <span class="o">=</span> <span class="n">end_char</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>

    <span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preprocess the input OMOP tables: modification of the column names.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        note : pd.DataFrame</span>
<span class="sd">            OMOP `note` table.</span>
<span class="sd">        note_nlp : pd.DataFrame</span>
<span class="sd">            OMOP `note_nlp` table.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        note : pd.DataFrame</span>
<span class="sd">            OMOP `note` table.</span>
<span class="sd">        note_nlp : pd.DataFrame</span>
<span class="sd">            OMOP `note_nlp` table.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">note_nlp</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_char</span><span class="p">:</span> <span class="s2">&quot;start_char&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">end_char</span><span class="p">:</span> <span class="s2">&quot;end_char&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span>

    <span class="k">def</span> <span class="nf">postprocess</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Postprocess the input OMOP tables: modification of the column names.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        note : pd.DataFrame</span>
<span class="sd">            OMOP `note` table.</span>
<span class="sd">        note_nlp : pd.DataFrame</span>
<span class="sd">            OMOP `note_nlp` table.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        note : pd.DataFrame</span>
<span class="sd">            OMOP `note` table.</span>
<span class="sd">        note_nlp : pd.DataFrame</span>
<span class="sd">            OMOP `note_nlp` table.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">note_nlp</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;start_char&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
                <span class="s2">&quot;end_char&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span>

    <span class="k">def</span> <span class="nf">omop2docs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">note_nlp</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">extensions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transforms OMOP tables to a list of spaCy documents.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        note : pd.DataFrame</span>
<span class="sd">            OMOP `note` table.</span>
<span class="sd">        note_nlp : pd.DataFrame</span>
<span class="sd">            OMOP `note_nlp` table.</span>
<span class="sd">        extensions : Optional[List[str]], optional</span>
<span class="sd">            Extensions to keep, by default None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List[Doc]</span>
<span class="sd">            List of spaCy documents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">omop2docs</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="p">,</span> <span class="n">extensions</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">docs2omop</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">docs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">],</span>
        <span class="n">extensions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transforms a list of spaCy documents to a pair of OMOP tables.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        docs : List[Doc]</span>
<span class="sd">            List of spaCy documents.</span>
<span class="sd">        extensions : Optional[List[str]], optional</span>
<span class="sd">            Extensions to keep, by default None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        note : pd.DataFrame</span>
<span class="sd">            OMOP `note` table.</span>
<span class="sd">        note_nlp : pd.DataFrame</span>
<span class="sd">            OMOP `note_nlp` table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">docs2omop</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">)</span>
        <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.connectors.omop.OmopConnector.start_char" class="doc doc-heading">
<code class="highlight language-python"><span class="n">start_char</span> <span class="o">=</span> <span class="n">start_char</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.connectors.omop.OmopConnector.end_char" class="doc doc-heading">
<code class="highlight language-python"><span class="n">end_char</span> <span class="o">=</span> <span class="n">end_char</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.connectors.omop.OmopConnector.nlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.omop.OmopConnector.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">nlp</span><span class="p">,</span> <span class="n">start_char</span><span class="o">=</span><span class="s1">&#39;start_char&#39;</span><span class="p">,</span> <span class="n">end_char</span><span class="o">=</span><span class="s1">&#39;end_char&#39;</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/omop.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">start_char</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;start_char&quot;</span><span class="p">,</span>
    <span class="n">end_char</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;end_char&quot;</span><span class="p">,</span>
<span class="p">):</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">start_char</span> <span class="o">=</span> <span class="n">start_char</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">end_char</span> <span class="o">=</span> <span class="n">end_char</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.omop.OmopConnector.preprocess" class="doc doc-heading">
<code class="highlight language-python"><span class="n">preprocess</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Preprocess the input OMOP tables: modification of the column names.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>note</code></td>
          <td class="doc-param-details">
            <p>OMOP <code>note</code> table.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>note_nlp</code></td>
          <td class="doc-param-details">
            <p>OMOP <code>note_nlp</code> table.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>note</code>
          </td>
          <td class="doc-returns-details">
            <p>OMOP <code>note</code> table.</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
              </p>
          </td>
        </tr>
        <tr>
          <td>
              <code>note_nlp</code>
          </td>
          <td class="doc-returns-details">
            <p>OMOP <code>note_nlp</code> table.</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/omop.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Preprocess the input OMOP tables: modification of the column names.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    note : pd.DataFrame</span>
<span class="sd">        OMOP `note` table.</span>
<span class="sd">    note_nlp : pd.DataFrame</span>
<span class="sd">        OMOP `note_nlp` table.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    note : pd.DataFrame</span>
<span class="sd">        OMOP `note` table.</span>
<span class="sd">    note_nlp : pd.DataFrame</span>
<span class="sd">        OMOP `note_nlp` table.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">note_nlp</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_char</span><span class="p">:</span> <span class="s2">&quot;start_char&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_char</span><span class="p">:</span> <span class="s2">&quot;end_char&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.omop.OmopConnector.postprocess" class="doc doc-heading">
<code class="highlight language-python"><span class="n">postprocess</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Postprocess the input OMOP tables: modification of the column names.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>note</code></td>
          <td class="doc-param-details">
            <p>OMOP <code>note</code> table.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>note_nlp</code></td>
          <td class="doc-param-details">
            <p>OMOP <code>note_nlp</code> table.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>note</code>
          </td>
          <td class="doc-returns-details">
            <p>OMOP <code>note</code> table.</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
              </p>
          </td>
        </tr>
        <tr>
          <td>
              <code>note_nlp</code>
          </td>
          <td class="doc-returns-details">
            <p>OMOP <code>note_nlp</code> table.</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/omop.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">postprocess</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Postprocess the input OMOP tables: modification of the column names.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    note : pd.DataFrame</span>
<span class="sd">        OMOP `note` table.</span>
<span class="sd">    note_nlp : pd.DataFrame</span>
<span class="sd">        OMOP `note_nlp` table.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    note : pd.DataFrame</span>
<span class="sd">        OMOP `note` table.</span>
<span class="sd">    note_nlp : pd.DataFrame</span>
<span class="sd">        OMOP `note_nlp` table.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">note_nlp</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;start_char&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
            <span class="s2">&quot;end_char&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.omop.OmopConnector.omop2docs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">omop2docs</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Transforms OMOP tables to a list of spaCy documents.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>note</code></td>
          <td class="doc-param-details">
            <p>OMOP <code>note</code> table.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>note_nlp</code></td>
          <td class="doc-param-details">
            <p>OMOP <code>note_nlp</code> table.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>extensions</code></td>
          <td class="doc-param-details">
            <p>Extensions to keep, by default None</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]], optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List[Doc]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of spaCy documents.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/omop.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">omop2docs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">note_nlp</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms OMOP tables to a list of spaCy documents.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    note : pd.DataFrame</span>
<span class="sd">        OMOP `note` table.</span>
<span class="sd">    note_nlp : pd.DataFrame</span>
<span class="sd">        OMOP `note_nlp` table.</span>
<span class="sd">    extensions : Optional[List[str]], optional</span>
<span class="sd">        Extensions to keep, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List[Doc]</span>
<span class="sd">        List of spaCy documents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">omop2docs</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlp</span><span class="p">,</span> <span class="n">extensions</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h6 id="edsnlp.connectors.omop.OmopConnector.docs2omop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">docs2omop</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>


    <div class="doc doc-contents ">

      <p>Transforms a list of spaCy documents to a pair of OMOP tables.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>docs</code></td>
          <td class="doc-param-details">
            <p>List of spaCy documents.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Doc]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>extensions</code></td>
          <td class="doc-param-details">
            <p>Extensions to keep, by default None</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]], optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>note</code>
          </td>
          <td class="doc-returns-details">
            <p>OMOP <code>note</code> table.</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
              </p>
          </td>
        </tr>
        <tr>
          <td>
              <code>note_nlp</code>
          </td>
          <td class="doc-returns-details">
            <p>OMOP <code>note_nlp</code> table.</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/omop.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">docs2omop</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">docs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">],</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms a list of spaCy documents to a pair of OMOP tables.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    docs : List[Doc]</span>
<span class="sd">        List of spaCy documents.</span>
<span class="sd">    extensions : Optional[List[str]], optional</span>
<span class="sd">        Extensions to keep, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    note : pd.DataFrame</span>
<span class="sd">        OMOP `note` table.</span>
<span class="sd">    note_nlp : pd.DataFrame</span>
<span class="sd">        OMOP `note_nlp` table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">docs2omop</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">)</span>
    <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postprocess</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h5 id="edsnlp.connectors.omop.omop2docs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">omop2docs</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span><span class="p">,</span> <span class="n">nlp</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Transforms an OMOP-formatted pair of dataframes into a list of documents.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>note</code></td>
          <td class="doc-param-details">
            <p>The OMOP <code>note</code> table.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>note_nlp</code></td>
          <td class="doc-param-details">
            <p>The OMOP <code>note_nlp</code> table</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>pd.DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>spaCy language object.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>extensions</code></td>
          <td class="doc-param-details">
            <p>Extensions to keep, by default None</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]], optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List[Doc] </code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of spaCy documents</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/omop.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">omop2docs</span><span class="p">(</span>
    <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">note_nlp</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms an OMOP-formatted pair of dataframes into a list of documents.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    note : pd.DataFrame</span>
<span class="sd">        The OMOP `note` table.</span>
<span class="sd">    note_nlp : pd.DataFrame</span>
<span class="sd">        The OMOP `note_nlp` table</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        spaCy language object.</span>
<span class="sd">    extensions : Optional[List[str]], optional</span>
<span class="sd">        Extensions to keep, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List[Doc] :</span>
<span class="sd">        List of spaCy documents</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">note</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">note_nlp</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">extensions</span> <span class="o">=</span> <span class="n">extensions</span> <span class="ow">or</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">row2ent</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">start_char</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
            <span class="n">end_char</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;note_nlp_source_value&quot;</span><span class="p">),</span>
            <span class="n">extensions</span><span class="o">=</span><span class="p">{</span><span class="n">ext</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">},</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">d</span>

    <span class="c1"># Create entities</span>
    <span class="n">note_nlp</span><span class="p">[</span><span class="s2">&quot;ents&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">note_nlp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">row2ent</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">note_nlp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;note_id&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;ents&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="n">note</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">note_nlp</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;note_id&quot;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

    <span class="c1"># Generate documents</span>
    <span class="n">note</span><span class="p">[</span><span class="s2">&quot;doc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">note_text</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">nlp</span><span class="p">)</span>

    <span class="c1"># Process documents</span>
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">note</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>

        <span class="n">doc</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">doc</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">note_id</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">note_id</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">note_datetime</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;note_datetime&quot;</span><span class="p">)</span>

        <span class="n">ents</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">ents</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>

            <span class="n">span</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">char_span</span><span class="p">(</span>
                <span class="n">ent</span><span class="p">[</span><span class="s2">&quot;start_char&quot;</span><span class="p">],</span>
                <span class="n">ent</span><span class="p">[</span><span class="s2">&quot;end_char&quot;</span><span class="p">],</span>
                <span class="n">ent</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">],</span>
                <span class="n">alignment_mode</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ent</span><span class="p">[</span><span class="s2">&quot;extensions&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

            <span class="n">ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
                <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">label_</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">span</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">span</span><span class="o">.</span><span class="n">label_</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

        <span class="n">ents</span><span class="p">,</span> <span class="n">discarded</span> <span class="o">=</span> <span class="n">filter_spans</span><span class="p">(</span><span class="n">ents</span><span class="p">,</span> <span class="n">return_discarded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">doc</span><span class="o">.</span><span class="n">ents</span> <span class="o">=</span> <span class="n">ents</span>

        <span class="k">if</span> <span class="s2">&quot;discarded&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">discarded</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">doc</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.connectors.omop.docs2omop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">docs2omop</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Transforms a list of spaCy docs to a pair of OMOP tables.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>docs</code></td>
          <td class="doc-param-details">
            <p>List of documents to transform.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Doc]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>extensions</code></td>
          <td class="doc-param-details">
            <p>Extensions to keep, by default None</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[List[str]], optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Tuple[pd.DataFrame, pd.DataFrame]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Pair of OMOP tables (<code>note</code> and <code>note_nlp</code>)</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/omop.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">docs2omop</span><span class="p">(</span>
    <span class="n">docs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">],</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transforms a list of spaCy docs to a pair of OMOP tables.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    docs : List[Doc]</span>
<span class="sd">        List of documents to transform.</span>
<span class="sd">    extensions : Optional[List[str]], optional</span>
<span class="sd">        Extensions to keep, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tuple[pd.DataFrame, pd.DataFrame]</span>
<span class="sd">        Pair of OMOP tables (`note` and `note_nlp`)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="n">docs</span><span class="p">))</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;note_text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">doc</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;note_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">doc</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">note_id</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;note_datetime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">doc</span><span class="p">:</span> <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">note_datetime</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">note_id</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;note_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ents&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">doc</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">))</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ents&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">df</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">doc</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="s2">&quot;discarded&quot;</span><span class="p">]))</span>

    <span class="n">note</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;note_id&quot;</span><span class="p">,</span> <span class="s2">&quot;note_text&quot;</span><span class="p">,</span> <span class="s2">&quot;note_datetime&quot;</span><span class="p">]]</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;note_id&quot;</span><span class="p">,</span> <span class="s2">&quot;ents&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&quot;ents&quot;</span><span class="p">)</span>

    <span class="n">extensions</span> <span class="o">=</span> <span class="n">extensions</span> <span class="ow">or</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">ent2dict</span><span class="p">(</span>
        <span class="n">ent</span><span class="p">:</span> <span class="n">Span</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>

        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">start_char</span><span class="o">=</span><span class="n">ent</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
            <span class="n">end_char</span><span class="o">=</span><span class="n">ent</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
            <span class="n">note_nlp_source_value</span><span class="o">=</span><span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">,</span>
            <span class="n">lexical_variant</span><span class="o">=</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
            <span class="c1"># normalized_variant=ent._.normalized.text,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">d</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;ents&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ents</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">ent2dict</span><span class="p">)</span>

    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;start_char&quot;</span><span class="p">,</span>
        <span class="s2">&quot;end_char&quot;</span><span class="p">,</span>
        <span class="s2">&quot;note_nlp_source_value&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lexical_variant&quot;</span><span class="p">,</span>
        <span class="c1"># &quot;normalized_variant&quot;,</span>
    <span class="p">]</span>
    <span class="n">columns</span> <span class="o">+=</span> <span class="n">extensions</span>

    <span class="n">df</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ents</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;term_modifiers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ext</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">extensions</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">term_modifiers</span> <span class="o">+=</span> <span class="s2">&quot;;&quot;</span>
        <span class="n">df</span><span class="o">.</span><span class="n">term_modifiers</span> <span class="o">+=</span> <span class="n">ext</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;note_nlp_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>

    <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;note_nlp_id&quot;</span><span class="p">,</span> <span class="s2">&quot;note_id&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">columns</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">note</span><span class="p">,</span> <span class="n">note_nlp</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.connectors.labeltool" class="doc doc-heading">
        <code>labeltool</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="edsnlp.connectors.labeltool.docs2labeltool" class="doc doc-heading">
<code class="highlight language-python"><span class="n">docs2labeltool</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Returns a labeltool-ready dataframe from a list of annotated document.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>docs</code></td>
          <td class="doc-param-details">
            <p>List of annotated spacy docs.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.List">List</span>[<span title="spacy.tokens.Doc">Doc</span>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>extensions</code></td>
          <td class="doc-param-details">
            <p>List of extensions to use by labeltool.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>df</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>DataFrame tailored for labeltool.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/connectors/labeltool.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">docs2labeltool</span><span class="p">(</span>
    <span class="n">docs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Doc</span><span class="p">],</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a labeltool-ready dataframe from a list of annotated document.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    docs: list of spaCy Doc</span>
<span class="sd">        List of annotated spacy docs.</span>
<span class="sd">    extensions: list of extensions</span>
<span class="sd">        List of extensions to use by labeltool.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df: pd.DataFrame</span>
<span class="sd">        DataFrame tailored for labeltool.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">extensions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">extensions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">entities</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">ascii</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">100</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">note_text</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                <span class="n">offset_begin</span><span class="o">=</span><span class="n">ent</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
                <span class="n">offset_end</span><span class="o">=</span><span class="n">ent</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
                <span class="n">label_name</span><span class="o">=</span><span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">,</span>
                <span class="n">label_value</span><span class="o">=</span><span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">d</span><span class="p">[</span><span class="s2">&quot;note_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">note_id</span> <span class="ow">or</span> <span class="n">i</span>

            <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">ext</span><span class="p">)</span>

            <span class="n">entities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">entities</span><span class="p">)</span>

    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;note_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;note_text&quot;</span><span class="p">,</span>
        <span class="s2">&quot;offset_begin&quot;</span><span class="p">,</span>
        <span class="s2">&quot;offset_end&quot;</span><span class="p">,</span>
        <span class="s2">&quot;label_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;label_value&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">columns</span> <span class="o">+</span> <span class="n">extensions</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="edsnlp.processing" class="doc doc-heading">
        <code>processing</code>



</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h4 id="edsnlp.processing.distributed" class="doc doc-heading">
        <code>distributed</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.distributed.pyspark_type_finder" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pyspark_type_finder</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Returns (when possible) the PySpark type of any python object</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/distributed.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pyspark_type_finder</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns (when possible) the PySpark type of any python object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">inferred_type</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">_infer_type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inferred type is </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">inferred_type</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inferred_type</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot infer type for this object.&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.distributed.module_checker" class="doc doc-heading">
<code class="highlight language-python"><span class="n">module_checker</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/distributed.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">module_checker</span><span class="p">(</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>

    <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="n">note</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">module</span> <span class="o">=</span> <span class="n">get_module</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="n">DataFrameModules</span><span class="o">.</span><span class="n">PYSPARK</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">module</span> <span class="o">==</span> <span class="n">DataFrameModules</span><span class="o">.</span><span class="n">KOALAS</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">databricks.koalas</span>  <span class="c1"># noqa F401</span>

        <span class="n">note_spark</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">to_spark</span><span class="p">()</span>
        <span class="n">note_nlp_spark</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">note_spark</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">note_nlp_spark</span><span class="o">.</span><span class="n">to_koalas</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.distributed.pipe" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pipe</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">nlp</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">[],</span> <span class="n">additional_spans</span><span class="o">=</span><span class="s1">&#39;discarded&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="p">[])</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Function to apply a spaCy pipe to a pyspark or koalas DataFrame note</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>note</code></td>
          <td class="doc-param-details">
            <p>A Pyspark or Koalas DataFrame with a <code>note_id</code> and <code>note_text</code> column</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>A spaCy pipe</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td class="doc-param-details">
            <p>A list of column to add to the generated SpaCy document as an extension.
For instance, if <code>context=["note_datetime"], the corresponding value found
in the</code>note_datetime<code>column will be stored in</code>doc._.note_datetime<code>,
which can be useful e.g. for the</code>dates` pipeline.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>[]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>additional_spans</code></td>
          <td class="doc-param-details">
            <p>A name (or list of names) of SpanGroup on which to apply the pipe too:
SpanGroup are available as <code>doc.spans[spangroup_name]</code> and can be generated
by some pipes. For instance, the <code>date</code> pipe populates doc.spans['dates']</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[List[str], str], by default &#34;discarded&#34;</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;discarded&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>extensions</code></td>
          <td class="doc-param-details">
            <p>Spans extensions to add to the extracted results:
FOr instance, if <code>extensions=["score_name"]</code>, the extracted result
will include, for each entity, <code>ent._.score_name</code>.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Tuple[str, T.DataType]], by default []</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>[]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A pyspark DataFrame with one line per extraction</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/distributed.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nd">@module_checker</span>
<span class="k">def</span> <span class="nf">pipe</span><span class="p">(</span>
    <span class="n">note</span><span class="p">:</span> <span class="n">DataFrames</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">additional_spans</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;discarded&quot;</span><span class="p">,</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">DataType</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to apply a spaCy pipe to a pyspark or koalas DataFrame note</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    note : DataFrame</span>
<span class="sd">        A Pyspark or Koalas DataFrame with a `note_id` and `note_text` column</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        A spaCy pipe</span>
<span class="sd">    context : List[str]</span>
<span class="sd">        A list of column to add to the generated SpaCy document as an extension.</span>
<span class="sd">        For instance, if `context=[&quot;note_datetime&quot;], the corresponding value found</span>
<span class="sd">        in the `note_datetime` column will be stored in `doc._.note_datetime`,</span>
<span class="sd">        which can be useful e.g. for the `dates` pipeline.</span>
<span class="sd">    additional_spans : Union[List[str], str], by default &quot;discarded&quot;</span>
<span class="sd">        A name (or list of names) of SpanGroup on which to apply the pipe too:</span>
<span class="sd">        SpanGroup are available as `doc.spans[spangroup_name]` and can be generated</span>
<span class="sd">        by some pipes. For instance, the `date` pipe populates doc.spans[&#39;dates&#39;]</span>
<span class="sd">    extensions : List[Tuple[str, T.DataType]], by default []</span>
<span class="sd">        Spans extensions to add to the extracted results:</span>
<span class="sd">        FOr instance, if `extensions=[&quot;score_name&quot;]`, the extracted result</span>
<span class="sd">        will include, for each entity, `ent._.score_name`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataFrame</span>
<span class="sd">        A pyspark DataFrame with one line per extraction</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">context</span><span class="p">:</span>
        <span class="n">check_spacy_version_for_context</span><span class="p">()</span>

    <span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">enableHiveSupport</span><span class="p">()</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">nlp</span><span class="o">.</span><span class="n">has_pipe</span><span class="p">(</span><span class="s2">&quot;eds.context&quot;</span><span class="p">):</span>
        <span class="n">nlp</span><span class="o">.</span><span class="n">add_pipe</span><span class="p">(</span><span class="s2">&quot;eds.context&quot;</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">))</span>

    <span class="n">nlp_bc</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">nlp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_udf_factory</span><span class="p">(</span>
        <span class="n">additional_spans</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;discarded&quot;</span><span class="p">,</span>
        <span class="n">extensions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">DataType</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(),</span>
    <span class="p">):</span>

        <span class="n">schema</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">ArrayType</span><span class="p">(</span>
            <span class="n">T</span><span class="o">.</span><span class="n">StructType</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">T</span><span class="o">.</span><span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;lexical_variant&quot;</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">StringType</span><span class="p">(),</span> <span class="kc">False</span><span class="p">),</span>
                    <span class="n">T</span><span class="o">.</span><span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">StringType</span><span class="p">(),</span> <span class="kc">False</span><span class="p">),</span>
                    <span class="n">T</span><span class="o">.</span><span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;span_type&quot;</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">StringType</span><span class="p">(),</span> <span class="kc">True</span><span class="p">),</span>
                    <span class="n">T</span><span class="o">.</span><span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">IntegerType</span><span class="p">(),</span> <span class="kc">False</span><span class="p">),</span>
                    <span class="n">T</span><span class="o">.</span><span class="n">StructField</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">IntegerType</span><span class="p">(),</span> <span class="kc">False</span><span class="p">),</span>
                    <span class="o">*</span><span class="p">[</span>
                        <span class="n">T</span><span class="o">.</span><span class="n">StructField</span><span class="p">(</span><span class="n">slugify</span><span class="p">(</span><span class="n">extension_name</span><span class="p">),</span> <span class="n">extension_type</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">extension_name</span><span class="p">,</span> <span class="n">extension_type</span> <span class="ow">in</span> <span class="n">extensions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="p">],</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span>
            <span class="n">text</span><span class="p">,</span>
            <span class="o">*</span><span class="n">context_values</span><span class="p">,</span>
            <span class="n">additional_spans</span><span class="o">=</span><span class="n">additional_spans</span><span class="p">,</span>
            <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
        <span class="p">):</span>

            <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>

            <span class="n">nlp</span> <span class="o">=</span> <span class="n">nlp_bc</span><span class="o">.</span><span class="n">value</span>

            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">pipe</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipeline</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">BaseComponent</span><span class="p">):</span>
                    <span class="n">pipe</span><span class="o">.</span><span class="n">set_extensions</span><span class="p">()</span>

            <span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">make_doc</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">context_name</span><span class="p">,</span> <span class="n">context_value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">context_values</span><span class="p">):</span>
                <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">context_name</span><span class="p">,</span> <span class="n">context_value</span><span class="p">)</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

            <span class="n">ents</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span><span class="p">:</span>
                <span class="n">parsed_extensions</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">rgetattr</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">extension</span><span class="p">)</span> <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="p">]</span>

                <span class="n">ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                        <span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">,</span>
                        <span class="s2">&quot;ents&quot;</span><span class="p">,</span>
                        <span class="n">ent</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
                        <span class="n">ent</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
                        <span class="o">*</span><span class="n">parsed_extensions</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">additional_spans</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ents</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">additional_spans</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">additional_spans</span> <span class="o">=</span> <span class="p">[</span><span class="n">additional_spans</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">spans_name</span> <span class="ow">in</span> <span class="n">additional_spans</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">spans_name</span><span class="p">,</span> <span class="p">[]):</span>

                    <span class="n">parsed_extensions</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">rgetattr</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">extension</span><span class="p">)</span> <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                    <span class="p">]</span>

                    <span class="n">ents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">(</span>
                            <span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                            <span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">,</span>
                            <span class="n">spans_name</span><span class="p">,</span>
                            <span class="n">ent</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
                            <span class="n">ent</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
                            <span class="o">*</span><span class="n">parsed_extensions</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

            <span class="k">return</span> <span class="n">ents</span>

        <span class="n">f_udf</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">udf</span><span class="p">(</span>
            <span class="n">partial</span><span class="p">(</span>
                <span class="n">f</span><span class="p">,</span>
                <span class="n">additional_spans</span><span class="o">=</span><span class="n">additional_spans</span><span class="p">,</span>
                <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">schema</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">f_udf</span>

    <span class="n">matcher</span> <span class="o">=</span> <span class="n">_udf_factory</span><span class="p">(</span>
        <span class="n">additional_spans</span><span class="o">=</span><span class="n">additional_spans</span><span class="p">,</span>
        <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span>
        <span class="s2">&quot;matches&quot;</span><span class="p">,</span> <span class="n">matcher</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;note_text&quot;</span><span class="p">),</span> <span class="o">*</span><span class="p">[</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">context</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">note_nlp</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;matches&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">note_nlp</span><span class="o">.</span><span class="n">matches</span><span class="p">))</span>

    <span class="n">note_nlp</span> <span class="o">=</span> <span class="n">note_nlp</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s2">&quot;note_id&quot;</span><span class="p">,</span> <span class="s2">&quot;matches.*&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">note_nlp</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.processing.wrapper" class="doc doc-heading">
        <code>wrapper</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.wrapper.pipe" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pipe</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">nlp</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">[],</span> <span class="n">additional_spans</span><span class="o">=</span><span class="s1">&#39;discarded&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="p">[],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Function to apply a spaCy pipe to a pandas or pyspark DataFrame</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>note</code></td>
          <td class="doc-param-details">
            <p>A pandas/pyspark/koalas DataFrame with a <code>note_id</code> and <code>note_text</code> column</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>A spaCy pipe</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td class="doc-param-details">
            <p>A list of column to add to the generated SpaCy document as an extension.
For instance, if <code>context=["note_datetime"], the corresponding value found
in the</code>note_datetime<code>column will be stored in</code>doc._.note_datetime<code>,
which can be useful e.g. for the</code>dates` pipeline.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>[]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>n_jobs</code></td>
          <td class="doc-param-details">
            <p>Only used when providing a Pandas DataFrame</p>
<ul>
<li><code>n_jobs=1</code> corresponds to <code>simple_pipe</code></li>
<li><code>n_jobs&gt;1</code> corresponds to <code>parallel_pipe</code> with <code>n_jobs</code> parallel workers</li>
<li><code>n_jobs=-1</code> corresponds to <code>parallel_pipe</code> with maximun number of workers</li>
<li><code>n_jobs=-2</code> corresponds to <code>parallel_pipe</code> with maximun number of workers -1</li>
</ul>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int, by default -2</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>-2</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>additional_spans</code></td>
          <td class="doc-param-details">
            <p>A name (or list of names) of SpanGroup on which to apply the pipe too:
SpanGroup are available as <code>doc.spans[spangroup_name]</code> and can be generated
by some pipes. For instance, the <code>date</code> pipe populates doc.spans['dates']</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[List[str], str], by default &#34;discarded&#34;</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;discarded&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>extensions</code></td>
          <td class="doc-param-details">
            <p>Spans extensions to add to the extracted results:
For instance, if <code>extensions=["score_name"]</code>, the extracted result
will include, for each entity, <code>ent._.score_name</code>.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Tuple[str, T.DataType]], by default []</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>[]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td class="doc-param-details">
            <p>Additional parameters depending on the <code>how</code> argument.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Dict[str, Any]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A DataFrame with one line per extraction</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/wrapper.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pipe</span><span class="p">(</span>
    <span class="n">note</span><span class="p">:</span> <span class="n">DataFrames</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">additional_spans</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;discarded&quot;</span><span class="p">,</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">ExtensionSchema</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataFrames</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to apply a spaCy pipe to a pandas or pyspark DataFrame</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    note : DataFrame</span>
<span class="sd">        A pandas/pyspark/koalas DataFrame with a `note_id` and `note_text` column</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        A spaCy pipe</span>
<span class="sd">    context : List[str]</span>
<span class="sd">        A list of column to add to the generated SpaCy document as an extension.</span>
<span class="sd">        For instance, if `context=[&quot;note_datetime&quot;], the corresponding value found</span>
<span class="sd">        in the `note_datetime` column will be stored in `doc._.note_datetime`,</span>
<span class="sd">        which can be useful e.g. for the `dates` pipeline.</span>
<span class="sd">    n_jobs : int, by default -2</span>
<span class="sd">        Only used when providing a Pandas DataFrame</span>

<span class="sd">        - `n_jobs=1` corresponds to `simple_pipe`</span>
<span class="sd">        - `n_jobs&gt;1` corresponds to `parallel_pipe` with `n_jobs` parallel workers</span>
<span class="sd">        - `n_jobs=-1` corresponds to `parallel_pipe` with maximun number of workers</span>
<span class="sd">        - `n_jobs=-2` corresponds to `parallel_pipe` with maximun number of workers -1</span>
<span class="sd">    additional_spans : Union[List[str], str], by default &quot;discarded&quot;</span>
<span class="sd">        A name (or list of names) of SpanGroup on which to apply the pipe too:</span>
<span class="sd">        SpanGroup are available as `doc.spans[spangroup_name]` and can be generated</span>
<span class="sd">        by some pipes. For instance, the `date` pipe populates doc.spans[&#39;dates&#39;]</span>
<span class="sd">    extensions : List[Tuple[str, T.DataType]], by default []</span>
<span class="sd">        Spans extensions to add to the extracted results:</span>
<span class="sd">        For instance, if `extensions=[&quot;score_name&quot;]`, the extracted result</span>
<span class="sd">        will include, for each entity, `ent._.score_name`.</span>
<span class="sd">    kwargs : Dict[str, Any]</span>
<span class="sd">        Additional parameters depending on the `how` argument.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataFrame</span>
<span class="sd">        A DataFrame with one line per extraction</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">module</span> <span class="o">=</span> <span class="n">get_module</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="n">DataFrameModules</span><span class="o">.</span><span class="n">PANDAS</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n_jobs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

            <span class="k">return</span> <span class="n">simple_pipe</span><span class="p">(</span>
                <span class="n">note</span><span class="o">=</span><span class="n">note</span><span class="p">,</span>
                <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
                <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
                <span class="n">additional_spans</span><span class="o">=</span><span class="n">additional_spans</span><span class="p">,</span>
                <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">return</span> <span class="n">parallel_pipe</span><span class="p">(</span>
                <span class="n">note</span><span class="o">=</span><span class="n">note</span><span class="p">,</span>
                <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
                <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
                <span class="n">additional_spans</span><span class="o">=</span><span class="n">additional_spans</span><span class="p">,</span>
                <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
                <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">extensions</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">extensions</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            When using Spark or Koalas, you should provide extension names</span>
<span class="sd">            along with the extension type (as a dictionnary):</span>
<span class="sd">            `d[extension_name] = extension_type`</span>
<span class="sd">            &quot;&quot;&quot;</span>  <span class="c1"># noqa W291</span>
        <span class="p">)</span>

    <span class="kn">from</span> <span class="nn">.distributed</span> <span class="kn">import</span> <span class="n">pipe</span> <span class="k">as</span> <span class="n">distributed_pipe</span>

    <span class="k">return</span> <span class="n">distributed_pipe</span><span class="p">(</span>
        <span class="n">note</span><span class="o">=</span><span class="n">note</span><span class="p">,</span>
        <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
        <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
        <span class="n">additional_spans</span><span class="o">=</span><span class="n">additional_spans</span><span class="p">,</span>
        <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.processing.parallel" class="doc doc-heading">
        <code>parallel</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.processing.parallel.nlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s1">&#39;eds&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.parallel._define_nlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_define_nlp</span><span class="p">(</span><span class="n">new_nlp</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Set the global nlp variable
Doing it this way saves non negligeable amount of time</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/parallel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_define_nlp</span><span class="p">(</span><span class="n">new_nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the global nlp variable</span>
<span class="sd">    Doing it this way saves non negligeable amount of time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">nlp</span>
    <span class="n">nlp</span> <span class="o">=</span> <span class="n">new_nlp</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.parallel._chunker" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_chunker</span><span class="p">(</span><span class="n">iterable</span><span class="p">,</span> <span class="n">total_length</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Takes an iterable and chunk it.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/parallel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_chunker</span><span class="p">(</span>
    <span class="n">iterable</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">total_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes an iterable and chunk it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">iterable</span><span class="p">[</span><span class="n">pos</span> <span class="p">:</span> <span class="n">pos</span> <span class="o">+</span> <span class="n">chunksize</span><span class="p">]</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_length</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.parallel._process_chunk" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_process_chunk</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="o">**</span><span class="n">pipe_kwargs</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/parallel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_process_chunk</span><span class="p">(</span><span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="o">**</span><span class="n">pipe_kwargs</span><span class="p">):</span>

    <span class="n">list_results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">_pipe_generator</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">nlp</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">pipe_kwargs</span><span class="p">):</span>
        <span class="n">list_results</span> <span class="o">+=</span> <span class="n">out</span>

    <span class="k">return</span> <span class="n">list_results</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.parallel.pipe" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pipe</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">nlp</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">[],</span> <span class="n">additional_spans</span><span class="o">=</span><span class="s1">&#39;discarded&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="p">[],</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">pipe_kwargs</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Function to apply a spaCy pipe to a pandas DataFrame note by using multiprocessing</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>note</code></td>
          <td class="doc-param-details">
            <p>A pandas DataFrame with a <code>note_id</code> and <code>note_text</code> column</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>A spaCy pipe</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td class="doc-param-details">
            <p>A list of column to add to the generated SpaCy document as an extension.
For instance, if <code>context=["note_datetime"], the corresponding value found
in the</code>note_datetime<code>column will be stored in</code>doc._.note_datetime<code>,
which can be useful e.g. for the</code>dates` pipeline.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>[]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>additional_spans</code></td>
          <td class="doc-param-details">
            <p>A name (or list of names) of SpanGroup on which to apply the pipe too:
SpanGroup are available as <code>doc.spans[spangroup_name]</code> and can be generated
by some pipes. For instance, the <code>date</code> pipe populates doc.spans['dates']</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[List[str], str], by default &#34;discarded&#34;</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;discarded&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>extensions</code></td>
          <td class="doc-param-details">
            <p>Spans extensions to add to the extracted results:
FOr instance, if <code>extensions=["score_name"]</code>, the extracted result
will include, for each entity, <code>ent._.score_name</code>.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Tuple[str, T.DataType]], by default []</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>[]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>chunksize</code></td>
          <td class="doc-param-details">
            <p>Batch size used to split tasks</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>100</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>n_jobs</code></td>
          <td class="doc-param-details">
            <p>Max number of parallel jobs.
The default value uses the maximum number of available cores.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>-2</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>progress_bar</code></td>
          <td class="doc-param-details">
            <p>Whether to display a progress bar or not</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>**pipe_kwargs</code></td>
          <td class="doc-param-details">
            <p>Arguments exposed in <code>processing.pipe_generator</code> are also available here</p>
            <p>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>{}</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A pandas DataFrame with one line per extraction</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/parallel.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pipe</span><span class="p">(</span>
    <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">additional_spans</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;discarded&quot;</span><span class="p">,</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">ExtensionSchema</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">pipe_kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to apply a spaCy pipe to a pandas DataFrame note by using multiprocessing</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    note : DataFrame</span>
<span class="sd">        A pandas DataFrame with a `note_id` and `note_text` column</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        A spaCy pipe</span>
<span class="sd">    context : List[str]</span>
<span class="sd">        A list of column to add to the generated SpaCy document as an extension.</span>
<span class="sd">        For instance, if `context=[&quot;note_datetime&quot;], the corresponding value found</span>
<span class="sd">        in the `note_datetime` column will be stored in `doc._.note_datetime`,</span>
<span class="sd">        which can be useful e.g. for the `dates` pipeline.</span>
<span class="sd">    additional_spans : Union[List[str], str], by default &quot;discarded&quot;</span>
<span class="sd">        A name (or list of names) of SpanGroup on which to apply the pipe too:</span>
<span class="sd">        SpanGroup are available as `doc.spans[spangroup_name]` and can be generated</span>
<span class="sd">        by some pipes. For instance, the `date` pipe populates doc.spans[&#39;dates&#39;]</span>
<span class="sd">    extensions : List[Tuple[str, T.DataType]], by default []</span>
<span class="sd">        Spans extensions to add to the extracted results:</span>
<span class="sd">        FOr instance, if `extensions=[&quot;score_name&quot;]`, the extracted result</span>
<span class="sd">        will include, for each entity, `ent._.score_name`.</span>
<span class="sd">    chunksize: int, by default 100</span>
<span class="sd">        Batch size used to split tasks</span>
<span class="sd">    n_jobs: int, by default -2</span>
<span class="sd">        Max number of parallel jobs.</span>
<span class="sd">        The default value uses the maximum number of available cores.</span>
<span class="sd">    progress_bar: bool, by default True</span>
<span class="sd">        Whether to display a progress bar or not</span>
<span class="sd">    **pipe_kwargs:</span>
<span class="sd">        Arguments exposed in `processing.pipe_generator` are also available here</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataFrame</span>
<span class="sd">        A pandas DataFrame with one line per extraction</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">context</span><span class="p">:</span>
        <span class="n">check_spacy_version_for_context</span><span class="p">()</span>

    <span class="c1"># Setting the nlp variable</span>
    <span class="n">_define_nlp</span><span class="p">(</span><span class="n">nlp</span><span class="p">)</span>

    <span class="n">verbose</span> <span class="o">=</span> <span class="mi">10</span> <span class="k">if</span> <span class="n">progress_bar</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="n">executor</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span>
        <span class="n">n_jobs</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;multiprocessing&quot;</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;processes&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span>
    <span class="p">)</span>
    <span class="n">executor</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Used nlp components: </span><span class="si">{</span><span class="n">nlp</span><span class="o">.</span><span class="n">component_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">pipe_kwargs</span><span class="p">[</span><span class="s2">&quot;additional_spans&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">additional_spans</span>
    <span class="n">pipe_kwargs</span><span class="p">[</span><span class="s2">&quot;extensions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">extensions</span>
    <span class="n">pipe_kwargs</span><span class="p">[</span><span class="s2">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="n">executor</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">note</span><span class="p">)</span><span class="o">/</span><span class="n">chunksize</span><span class="p">)</span><span class="si">}</span><span class="s2"> tasks to complete&quot;</span><span class="p">)</span>

    <span class="n">do</span> <span class="o">=</span> <span class="n">delayed</span><span class="p">(</span><span class="n">_process_chunk</span><span class="p">)</span>

    <span class="n">tasks</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">do</span><span class="p">(</span><span class="n">chunk</span><span class="p">,</span> <span class="o">**</span><span class="n">pipe_kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">_chunker</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">note</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">executor</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>

    <span class="n">out</span> <span class="o">=</span> <span class="n">_flatten</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.processing.simple" class="doc doc-heading">
        <code>simple</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.processing.simple.nlp" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">blank</span><span class="p">(</span><span class="s1">&#39;eds&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.processing.simple.ExtensionSchema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ExtensionSchema</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.simple._df_to_spacy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_df_to_spacy</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">nlp</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Takes a pandas DataFrame and return a generator that can be used in
<code>nlp.pipe()</code>.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>note</code></td>
          <td class="doc-param-details">
            <p>A pandas DataFrame with at least <code>note_text</code> and <code>note_id</code> columns.
A <code>Doc</code> object will be created for each line.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="pandas">pd</span>.<span title="pandas.DataFrame">DataFrame</span></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>generator</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A generator which items are of the form (text, context), with <code>text</code>
being a string and <code>context</code> a dictionnary</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/simple.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_df_to_spacy</span><span class="p">(</span>
    <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes a pandas DataFrame and return a generator that can be used in</span>
<span class="sd">    `nlp.pipe()`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    note: pd.DataFrame</span>
<span class="sd">        A pandas DataFrame with at least `note_text` and `note_id` columns.</span>
<span class="sd">        A `Doc` object will be created for each line.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    generator:</span>
<span class="sd">        A generator which items are of the form (text, context), with `text`</span>
<span class="sd">        being a string and `context` a dictionnary</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">context</span><span class="p">:</span>
        <span class="n">check_spacy_version_for_context</span><span class="p">()</span>

    <span class="n">kept_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;note_text&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">context</span>

    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">kept_cols</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">note</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No column named </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="si">}</span><span class="s2"> found in df&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_context</span><span class="p">(</span><span class="n">context_values</span><span class="p">):</span>
        <span class="n">note_text</span> <span class="o">=</span> <span class="n">context_values</span><span class="o">.</span><span class="n">note_text</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">make_doc</span><span class="p">(</span><span class="n">note_text</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
            <span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">slugify</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="n">rgetattr</span><span class="p">(</span><span class="n">context_values</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">doc</span>

    <span class="k">yield from</span> <span class="nb">map</span><span class="p">(</span>
        <span class="n">add_context</span><span class="p">,</span>
        <span class="n">note</span><span class="p">[</span><span class="n">kept_cols</span><span class="p">]</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(),</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.simple._flatten" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_flatten</span><span class="p">(</span><span class="n">list_of_lists</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Flatten a list of lists to a combined list.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/simple.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_flatten</span><span class="p">(</span><span class="n">list_of_lists</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Flatten a list of lists to a combined list.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">list_of_lists</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.simple._pipe_generator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_pipe_generator</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">nlp</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">[],</span> <span class="n">additional_spans</span><span class="o">=</span><span class="s1">&#39;discarded&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="p">[],</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/simple.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_pipe_generator</span><span class="p">(</span>
    <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">additional_spans</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;discarded&quot;</span><span class="p">,</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">ExtensionSchema</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">extensions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span><span class="n">extensions</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">extensions</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">extensions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">extensions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">additional_spans</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">additional_spans</span> <span class="o">=</span> <span class="p">[</span><span class="n">additional_spans</span><span class="p">]</span>

    <span class="k">if</span> <span class="s2">&quot;note_id&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
        <span class="n">context</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;note_id&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">nlp</span><span class="o">.</span><span class="n">has_pipe</span><span class="p">(</span><span class="s2">&quot;eds.context&quot;</span><span class="p">):</span>
        <span class="n">nlp</span><span class="o">.</span><span class="n">add_pipe</span><span class="p">(</span><span class="s2">&quot;eds.context&quot;</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">))</span>

    <span class="n">gen</span> <span class="o">=</span> <span class="n">_df_to_spacy</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">nlp</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
    <span class="n">n_docs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">gen</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="n">n_docs</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="n">progress_bar</span><span class="p">):</span>

        <span class="k">yield</span> <span class="n">_full_schema</span><span class="p">(</span>
            <span class="n">doc</span><span class="p">,</span>
            <span class="n">additional_spans</span><span class="o">=</span><span class="n">additional_spans</span><span class="p">,</span>
            <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.simple._single_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_single_schema</span><span class="p">(</span><span class="n">ent</span><span class="p">,</span> <span class="n">span_type</span><span class="o">=</span><span class="s1">&#39;ents&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="p">[])</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/simple.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_single_schema</span><span class="p">(</span>
    <span class="n">ent</span><span class="p">:</span> <span class="n">Span</span><span class="p">,</span>
    <span class="n">span_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ents&quot;</span><span class="p">,</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">):</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;note_id&quot;</span><span class="p">:</span> <span class="n">ent</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">note_id</span><span class="p">,</span>
        <span class="s2">&quot;lexical_variant&quot;</span><span class="p">:</span> <span class="n">ent</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">ent</span><span class="o">.</span><span class="n">label_</span><span class="p">,</span>
        <span class="s2">&quot;span_type&quot;</span><span class="p">:</span> <span class="n">span_type</span><span class="p">,</span>
        <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">ent</span><span class="o">.</span><span class="n">start_char</span><span class="p">,</span>
        <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">ent</span><span class="o">.</span><span class="n">end_char</span><span class="p">,</span>
        <span class="o">**</span><span class="p">{</span><span class="n">slugify</span><span class="p">(</span><span class="n">extension</span><span class="p">):</span> <span class="n">rgetattr</span><span class="p">(</span><span class="n">ent</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">extension</span><span class="p">)</span> <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">extensions</span><span class="p">},</span>
    <span class="p">}</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.simple._full_schema" class="doc doc-heading">
<code class="highlight language-python"><span class="n">_full_schema</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">additional_spans</span><span class="o">=</span><span class="p">[],</span> <span class="n">extensions</span><span class="o">=</span><span class="p">[])</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Function used when Parallelising tasks via joblib.
Takes a Doc as input, and returns a list of serializable objects</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parallelisation needs for output objects to be <strong>serializable</strong>:
after splitting the task into separate jobs, intermediate results
are saved on memory before being aggregated, thus the need to be
serializable. For instance, spaCy's spans aren't serializable since
they are merely a <em>view</em> of the parent document.</p>
<p>Check the source code of this function for an example.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/simple.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">_full_schema</span><span class="p">(</span>
    <span class="n">doc</span><span class="p">:</span> <span class="n">Doc</span><span class="p">,</span>
    <span class="n">additional_spans</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function used when Parallelising tasks via joblib.</span>
<span class="sd">    Takes a Doc as input, and returns a list of serializable objects</span>

<span class="sd">    !!! note</span>

<span class="sd">        The parallelisation needs for output objects to be **serializable**:</span>
<span class="sd">        after splitting the task into separate jobs, intermediate results</span>
<span class="sd">        are saved on memory before being aggregated, thus the need to be</span>
<span class="sd">        serializable. For instance, spaCy&#39;s spans aren&#39;t serializable since</span>
<span class="sd">        they are merely a *view* of the parent document.</span>

<span class="sd">        Check the source code of this function for an example.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">_single_schema</span><span class="p">(</span>
                <span class="n">ent</span><span class="p">,</span>
                <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span>
            <span class="k">if</span> <span class="n">doc</span><span class="o">.</span><span class="n">ents</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">span_type</span> <span class="ow">in</span> <span class="n">additional_spans</span><span class="p">:</span>
        <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">_single_schema</span><span class="p">(</span>
                    <span class="n">ent</span><span class="p">,</span>
                    <span class="n">span_type</span><span class="o">=</span><span class="n">span_type</span><span class="p">,</span>
                    <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">span_type</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">doc</span><span class="o">.</span><span class="n">spans</span><span class="p">[</span><span class="n">span_type</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.simple.pipe" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pipe</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">nlp</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">[],</span> <span class="n">additional_spans</span><span class="o">=</span><span class="s1">&#39;discarded&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="p">[],</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Function to apply a spaCy pipe to a pandas DataFrame note
For a large DataFrame, prefer the parallel version.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>note</code></td>
          <td class="doc-param-details">
            <p>A pandas DataFrame with a <code>note_id</code> and <code>note_text</code> column</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>DataFrame</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>nlp</code></td>
          <td class="doc-param-details">
            <p>A spaCy pipe</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Language</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td class="doc-param-details">
            <p>A list of column to add to the generated SpaCy document as an extension.
For instance, if <code>context=["note_datetime"], the corresponding value found
in the</code>note_datetime<code>column will be stored in</code>doc._.note_datetime<code>,
which can be useful e.g. for the</code>dates` pipeline.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>[]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>additional_spans</code></td>
          <td class="doc-param-details">
            <p>A name (or list of names) of SpanGroup on which to apply the pipe too:
SpanGroup are available as <code>doc.spans[spangroup_name]</code> and can be generated
by some pipes. For instance, the <code>date</code> pipe populates doc.spans['dates']</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[List[str], str], by default &#34;discarded&#34;</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;discarded&#39;</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>extensions</code></td>
          <td class="doc-param-details">
            <p>Spans extensions to add to the extracted results:
For instance, if <code>extensions=["score_name"]</code>, the extracted result
will include, for each entity, <code>ent._.score_name</code>.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Tuple[str, T.DataType]], by default []</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>[]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>batch_size</code></td>
          <td class="doc-param-details">
            <p>Batch size used by spaCy's pipe</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int, by default 1000</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>1000</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>progress_bar</code></td>
          <td class="doc-param-details">
            <p>Whether to display a progress bar or not</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A pandas DataFrame with one line per extraction</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/simple.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">pipe</span><span class="p">(</span>
    <span class="n">note</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">nlp</span><span class="p">:</span> <span class="n">Language</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">additional_spans</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;discarded&quot;</span><span class="p">,</span>
    <span class="n">extensions</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">progress_bar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to apply a spaCy pipe to a pandas DataFrame note</span>
<span class="sd">    For a large DataFrame, prefer the parallel version.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    note : DataFrame</span>
<span class="sd">        A pandas DataFrame with a `note_id` and `note_text` column</span>
<span class="sd">    nlp : Language</span>
<span class="sd">        A spaCy pipe</span>
<span class="sd">    context : List[str]</span>
<span class="sd">        A list of column to add to the generated SpaCy document as an extension.</span>
<span class="sd">        For instance, if `context=[&quot;note_datetime&quot;], the corresponding value found</span>
<span class="sd">        in the `note_datetime` column will be stored in `doc._.note_datetime`,</span>
<span class="sd">        which can be useful e.g. for the `dates` pipeline.</span>
<span class="sd">    additional_spans : Union[List[str], str], by default &quot;discarded&quot;</span>
<span class="sd">        A name (or list of names) of SpanGroup on which to apply the pipe too:</span>
<span class="sd">        SpanGroup are available as `doc.spans[spangroup_name]` and can be generated</span>
<span class="sd">        by some pipes. For instance, the `date` pipe populates doc.spans[&#39;dates&#39;]</span>
<span class="sd">    extensions : List[Tuple[str, T.DataType]], by default []</span>
<span class="sd">        Spans extensions to add to the extracted results:</span>
<span class="sd">        For instance, if `extensions=[&quot;score_name&quot;]`, the extracted result</span>
<span class="sd">        will include, for each entity, `ent._.score_name`.</span>
<span class="sd">    batch_size : int, by default 1000</span>
<span class="sd">        Batch size used by spaCy&#39;s pipe</span>
<span class="sd">    progress_bar: bool, by default True</span>
<span class="sd">        Whether to display a progress bar or not</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DataFrame</span>
<span class="sd">        A pandas DataFrame with one line per extraction</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">_flatten</span><span class="p">(</span>
            <span class="n">_pipe_generator</span><span class="p">(</span>
                <span class="n">note</span><span class="o">=</span><span class="n">note</span><span class="p">,</span>
                <span class="n">nlp</span><span class="o">=</span><span class="n">nlp</span><span class="p">,</span>
                <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
                <span class="n">additional_spans</span><span class="o">=</span><span class="n">additional_spans</span><span class="p">,</span>
                <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
                <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                <span class="n">progress_bar</span><span class="o">=</span><span class="n">progress_bar</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.processing.helpers" class="doc doc-heading">
        <code>helpers</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.processing.helpers.DataFrames" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DataFrames</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.processing.helpers.spec" class="doc doc-heading">
<code class="highlight language-python"><span class="n">spec</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_spec</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h5 id="edsnlp.processing.helpers.DataFrameModules" class="doc doc-heading">
          <code>DataFrameModules</code>



</h5>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="enum.Enum">Enum</span></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/processing/helpers.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">DataFrameModules</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">PANDAS</span> <span class="o">=</span> <span class="s2">&quot;pandas&quot;</span>
    <span class="n">PYSPARK</span> <span class="o">=</span> <span class="s2">&quot;pyspark.sql&quot;</span>
    <span class="n">KOALAS</span> <span class="o">=</span> <span class="s2">&quot;databricks.koalas&quot;</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.processing.helpers.DataFrameModules.PANDAS" class="doc doc-heading">
<code class="highlight language-python"><span class="n">PANDAS</span> <span class="o">=</span> <span class="s1">&#39;pandas&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.processing.helpers.DataFrameModules.PYSPARK" class="doc doc-heading">
<code class="highlight language-python"><span class="n">PYSPARK</span> <span class="o">=</span> <span class="s1">&#39;pyspark.sql&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.processing.helpers.DataFrameModules.KOALAS" class="doc doc-heading">
<code class="highlight language-python"><span class="n">KOALAS</span> <span class="o">=</span> <span class="s1">&#39;databricks.koalas&#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.helpers.get_module" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_module</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/helpers.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_module</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">DataFrames</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">DataFrameModules</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__module__</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">module</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.helpers.check_spacy_version_for_context" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_spacy_version_for_context</span><span class="p">()</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/helpers.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_spacy_version_for_context</span><span class="p">():</span>  <span class="c1"># pragma: no cover</span>
    <span class="kn">import</span> <span class="nn">spacy</span>

    <span class="n">spacy_version</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">spacy</span><span class="p">,</span> <span class="s2">&quot;__version__&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">LooseVersion</span><span class="p">(</span><span class="n">spacy_version</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">LooseVersion</span><span class="p">(</span><span class="s2">&quot;3.2&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">VersionConflict</span><span class="p">(</span>
            <span class="s2">&quot;You provided a `context` argument, which only work with spacy&gt;=3.2.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;However, we found SpaCy version </span><span class="si">{</span><span class="n">spacy_version</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Please upgrade SpaCy ;)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.helpers.rgetattr" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rgetattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Recursively getting attribute</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj</code></td>
          <td class="doc-param-details">
            <p>An object</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Any</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>attr</code></td>
          <td class="doc-param-details">
            <p>The name of the attriute to get. Can contain dots.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/helpers.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rgetattr</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Recursively getting attribute</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj : Any</span>
<span class="sd">        An object</span>
<span class="sd">    attr : str</span>
<span class="sd">        The name of the attriute to get. Can contain dots.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">_getattr</span><span class="p">,</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">+</span> <span class="n">attr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.processing.helpers.slugify" class="doc doc-heading">
<code class="highlight language-python"><span class="n">slugify</span><span class="p">(</span><span class="n">chained_attr</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Slugify a chained attribute name</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>chained_attr</code></td>
          <td class="doc-param-details">
            <p>The string to slugify (replace dots by _)</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>str</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>The slugified string</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/processing/helpers.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">slugify</span><span class="p">(</span><span class="n">chained_attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Slugify a chained attribute name</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    chained_attr : str</span>
<span class="sd">        The string to slugify (replace dots by _)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        The slugified string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">chained_attr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="edsnlp.utils" class="doc doc-heading">
        <code>utils</code>



</h3>

    <div class="doc doc-contents ">




  <div class="doc doc-children">









  <div class="doc doc-object doc-module">



<h4 id="edsnlp.utils.examples" class="doc doc-heading">
        <code>examples</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.utils.examples.entity_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">entity_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;(&lt;ent[^&lt;&gt;]*&gt;[^&lt;&gt;]+&lt;/ent&gt;)&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.utils.examples.text_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">text_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;&lt;ent.*&gt;(.+)&lt;/ent&gt;&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.utils.examples.modifiers_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">modifiers_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;&lt;ent</span><span class="se">\\</span><span class="s1">s?(.*)&gt;.+&lt;/ent&gt;&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h5 id="edsnlp.utils.examples.Match" class="doc doc-heading">
          <code>Match</code>



</h5>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/utils/examples.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Match</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">start_char</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">end_char</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">modifiers</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.utils.examples.Match.start_char" class="doc doc-heading">
<code class="highlight language-python"><span class="n">start_char</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.utils.examples.Match.end_char" class="doc doc-heading">
<code class="highlight language-python"><span class="n">end_char</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.utils.examples.Match.text" class="doc doc-heading">
<code class="highlight language-python"><span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.utils.examples.Match.modifiers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">modifiers</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="edsnlp.utils.examples.Modifier" class="doc doc-heading">
          <code>Modifier</code>



</h5>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/utils/examples.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Modifier</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.utils.examples.Modifier.key" class="doc doc-heading">
<code class="highlight language-python"><span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.utils.examples.Modifier.value" class="doc doc-heading">
<code class="highlight language-python"><span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="edsnlp.utils.examples.Entity" class="doc doc-heading">
          <code>Entity</code>



</h5>


    <div class="doc doc-contents ">
        <p class="doc doc-class-bases">
          Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>




          <details class="quote">
            <summary>Source code in <code>edsnlp/utils/examples.py</code></summary>
            <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Entity</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">start_char</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">end_char</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">modifiers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Modifier</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
          </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.utils.examples.Entity.start_char" class="doc doc-heading">
<code class="highlight language-python"><span class="n">start_char</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.utils.examples.Entity.end_char" class="doc doc-heading">
<code class="highlight language-python"><span class="n">end_char</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="edsnlp.utils.examples.Entity.modifiers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">modifiers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Modifier</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

    </div>

  </div>







  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.examples.find_matches" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_matches</span><span class="p">(</span><span class="n">example</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Finds entities within the example.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>example</code></td>
          <td class="doc-param-details">
            <p>Example to process.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List[re.Match]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>List of matches for entities.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/examples.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_matches</span><span class="p">(</span><span class="n">example</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">Match</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds entities within the example.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    example : str</span>
<span class="sd">        Example to process.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List[re.Match]</span>
<span class="sd">        List of matches for entities.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">entity_pattern</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">example</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.examples.parse_match" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse_match</span><span class="p">(</span><span class="n">match</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Parse a regex match representing an entity.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>match</code></td>
          <td class="doc-param-details">
            <p>Match for an entity.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>re.Match</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Match</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Usable representation for the entity match.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/examples.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_match</span><span class="p">(</span><span class="n">match</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">Match</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Match</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse a regex match representing an entity.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    match : re.Match</span>
<span class="sd">        Match for an entity.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Match</span>
<span class="sd">        Usable representation for the entity match.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lexical_variant</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
    <span class="n">start_char</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">end_char</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>

    <span class="n">text</span> <span class="o">=</span> <span class="n">text_pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">lexical_variant</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">modifiers</span> <span class="o">=</span> <span class="n">modifiers_pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">lexical_variant</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">Match</span><span class="p">(</span><span class="n">start_char</span><span class="o">=</span><span class="n">start_char</span><span class="p">,</span> <span class="n">end_char</span><span class="o">=</span><span class="n">end_char</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">modifiers</span><span class="o">=</span><span class="n">modifiers</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.examples.parse_example" class="doc doc-heading">
<code class="highlight language-python"><span class="n">parse_example</span><span class="p">(</span><span class="n">example</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Parses an example : finds examples and removes the tags.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>example</code></td>
          <td class="doc-param-details">
            <p>Example to process.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Tuple[str, List[Entity]]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Cleaned text and extracted entities.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/examples.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">parse_example</span><span class="p">(</span><span class="n">example</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Entity</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses an example : finds examples and removes the tags.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    example : str</span>
<span class="sd">        Example to process.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Tuple[str, List[Entity]]</span>
<span class="sd">        Cleaned text and extracted entities.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">parse_match</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">find_matches</span><span class="p">(</span><span class="n">example</span><span class="o">=</span><span class="n">example</span><span class="p">)]</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">entities</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">cursor</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>

        <span class="n">text</span> <span class="o">+=</span> <span class="n">example</span><span class="p">[</span><span class="n">cursor</span> <span class="p">:</span> <span class="n">match</span><span class="o">.</span><span class="n">start_char</span><span class="p">]</span>
        <span class="n">start_char</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="n">match</span><span class="o">.</span><span class="n">text</span>
        <span class="n">end_char</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">modifiers</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">match</span><span class="o">.</span><span class="n">modifiers</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>

        <span class="n">cursor</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">end_char</span>

        <span class="n">entity</span> <span class="o">=</span> <span class="n">Entity</span><span class="p">(</span>
            <span class="n">start_char</span><span class="o">=</span><span class="n">start_char</span><span class="p">,</span>
            <span class="n">end_char</span><span class="o">=</span><span class="n">end_char</span><span class="p">,</span>
            <span class="n">modifiers</span><span class="o">=</span><span class="p">[</span><span class="n">Modifier</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">modifiers</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">entities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>

    <span class="n">text</span> <span class="o">+=</span> <span class="n">example</span><span class="p">[</span><span class="n">cursor</span><span class="p">:]</span>

    <span class="k">return</span> <span class="n">text</span><span class="p">,</span> <span class="n">entities</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.utils.blocs" class="doc doc-heading">
        <code>blocs</code>



</h4>

    <div class="doc doc-contents ">

      <p>Utility that extracts code blocs and runs them.</p>
<p>Largely inspired by https://github.com/koaning/mktestdocs</p>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.utils.blocs.BLOCK_PATTERN" class="doc doc-heading">
<code class="highlight language-python"><span class="n">BLOCK_PATTERN</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;((?P&lt;skip&gt;&lt;!-- no-check --&gt;)</span><span class="se">\\</span><span class="s1">s+)?(?P&lt;indent&gt; *)```(?P&lt;title&gt;.*?)</span><span class="se">\\</span><span class="s1">n(?P&lt;code&gt;.+?)```&#39;</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.utils.blocs.OUTPUT_PATTERN" class="doc doc-heading">
<code class="highlight language-python"><span class="n">OUTPUT_PATTERN</span> <span class="o">=</span> <span class="s1">&#39;# Out: &#39;</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.blocs.check_outputs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_outputs</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Looks for output patterns, and modifies the bloc:</p>
<ol>
<li>The preceding line becomes <code class="highlight"><span class="n">v</span> <span class="o">=</span> <span class="n">expr</span></code></li>
<li>The output line becomes an <code class="highlight"><span class="k">assert</span></code> statement</li>
</ol>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>code</code></td>
          <td class="doc-param-details">
            <p>Code block</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>str</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Modified code bloc with assert statements</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/blocs.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_outputs</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Looks for output patterns, and modifies the bloc:</span>

<span class="sd">    1. The preceding line becomes `#!python v = expr`</span>
<span class="sd">    2. The output line becomes an `#!python assert` statement</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    code : str</span>
<span class="sd">        Code block</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Modified code bloc with assert statements</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">code</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">skip</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">code</span>

    <span class="k">for</span> <span class="n">expression</span><span class="p">,</span> <span class="n">output</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">if</span> <span class="n">skip</span><span class="p">:</span>
            <span class="n">skip</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">skip</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">OUTPUT_PATTERN</span><span class="p">):</span>
            <span class="n">expression</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;v = </span><span class="si">{</span><span class="n">expression</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">OUTPUT_PATTERN</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;assert repr(v) == &quot;</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s1">&quot; or str(v) == &quot;</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

            <span class="n">code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
            <span class="n">code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

            <span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">skip</span><span class="p">:</span>
        <span class="n">code</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.blocs.remove_indentation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_indentation</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Remove indentation from a code bloc.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>code</code></td>
          <td class="doc-param-details">
            <p>Code bloc</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>indent</code></td>
          <td class="doc-param-details">
            <p>Level of indentation</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>str</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Modified code bloc</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/blocs.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">remove_indentation</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove indentation from a code bloc.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    code : str</span>
<span class="sd">        Code bloc</span>
<span class="sd">    indent : int</span>
<span class="sd">        Level of indentation</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Modified code bloc</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">indent</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">code</span>

    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">indent</span><span class="p">:])</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.blocs.grab_code_blocks" class="doc doc-heading">
<code class="highlight language-python"><span class="n">grab_code_blocks</span><span class="p">(</span><span class="n">docstring</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Given a docstring, grab all the markdown codeblocks found in docstring.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>docstring</code></td>
          <td class="doc-param-details">
            <p>Full text.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>lang</code></td>
          <td class="doc-param-details">
            <p>Language to execute, by default "python"</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>&#39;python&#39;</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List[str]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Extracted code blocks</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/blocs.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">grab_code_blocks</span><span class="p">(</span><span class="n">docstring</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a docstring, grab all the markdown codeblocks found in docstring.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    docstring : str</span>
<span class="sd">        Full text.</span>
<span class="sd">    lang : str, optional</span>
<span class="sd">        Language to execute, by default &quot;python&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List[str]</span>
<span class="sd">        Extracted code blocks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">codeblocks</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">BLOCK_PATTERN</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">docstring</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;skip&quot;</span><span class="p">]:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">lang</span> <span class="ow">in</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">remove_indentation</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;indent&quot;</span><span class="p">]))</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">check_outputs</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
            <span class="n">codeblocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">codeblocks</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.blocs.printer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">printer</span><span class="p">(</span><span class="n">code</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Prints a code bloc with lines for easier debugging.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>code</code></td>
          <td class="doc-param-details">
            <p>Code bloc.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/blocs.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">printer</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints a code bloc with lines for easier debugging.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    code : str</span>
<span class="sd">        Code bloc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">code</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)):</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.blocs.check_docstring" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_docstring</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Given a function, test the contents of the docstring.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/blocs.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_docstring</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a function, test the contents of the docstring.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">grab_code_blocks</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="n">lang</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">exec</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;__MODULE__&quot;</span><span class="p">:</span> <span class="s2">&quot;__main__&quot;</span><span class="p">})</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error Encountered in `</span><span class="si">{</span><span class="n">obj</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">`. Caused by:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">printer</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.blocs.check_raw_string" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_raw_string</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Given a raw string, test the contents.</p>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/blocs.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_raw_string</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a raw string, test the contents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">grab_code_blocks</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="n">lang</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">exec</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;__MODULE__&quot;</span><span class="p">:</span> <span class="s2">&quot;__main__&quot;</span><span class="p">})</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">printer</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.blocs.check_raw_file_full" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_raw_file_full</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/blocs.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_raw_file_full</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">):</span>
    <span class="n">all_code</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">grab_code_blocks</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="n">lang</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">exec</span><span class="p">(</span><span class="n">all_code</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;__MODULE__&quot;</span><span class="p">:</span> <span class="s2">&quot;__main__&quot;</span><span class="p">})</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">printer</span><span class="p">(</span><span class="n">all_code</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.blocs.check_md_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_md_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Given a markdown file, parse the contents for Python code blocs
and check that each independant bloc does not cause an error.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td class="doc-param-details">
            <p>Path to the markdown file to execute.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Path</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>memory</code></td>
          <td class="doc-param-details">
            <p>Whether to keep results from one bloc to the next, by default <code class="highlight"><span class="kc">False</span></code></p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/blocs.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_md_file</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">memory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a markdown file, parse the contents for Python code blocs</span>
<span class="sd">    and check that each independant bloc does not cause an error.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : Path</span>
<span class="sd">        Path to the markdown file to execute.</span>
<span class="sd">    memory : bool, optional</span>
<span class="sd">        Whether to keep results from one bloc to the next, by default `#!python False`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">memory</span><span class="p">:</span>
        <span class="n">check_raw_file_full</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">check_raw_string</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;python&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.utils.colors" class="doc doc-heading">
        <code>colors</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h5 id="edsnlp.utils.colors.CATEGORY20" class="doc doc-heading">
<code class="highlight language-python"><span class="n">CATEGORY20</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#1f77b4&#39;</span><span class="p">,</span> <span class="s1">&#39;#aec7e8&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff7f0e&#39;</span><span class="p">,</span> <span class="s1">&#39;#ffbb78&#39;</span><span class="p">,</span> <span class="s1">&#39;#2ca02c&#39;</span><span class="p">,</span> <span class="s1">&#39;#98df8a&#39;</span><span class="p">,</span> <span class="s1">&#39;#d62728&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff9896&#39;</span><span class="p">,</span> <span class="s1">&#39;#9467bd&#39;</span><span class="p">,</span> <span class="s1">&#39;#c5b0d5&#39;</span><span class="p">,</span> <span class="s1">&#39;#8c564b&#39;</span><span class="p">,</span> <span class="s1">&#39;#c49c94&#39;</span><span class="p">,</span> <span class="s1">&#39;#e377c2&#39;</span><span class="p">,</span> <span class="s1">&#39;#f7b6d2&#39;</span><span class="p">,</span> <span class="s1">&#39;#7f7f7f&#39;</span><span class="p">,</span> <span class="s1">&#39;#c7c7c7&#39;</span><span class="p">,</span> <span class="s1">&#39;#bcbd22&#39;</span><span class="p">,</span> <span class="s1">&#39;#dbdb8d&#39;</span><span class="p">,</span> <span class="s1">&#39;#17becf&#39;</span><span class="p">,</span> <span class="s1">&#39;#9edae5&#39;</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

    </div>

  </div>





  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.colors.create_colors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_colors</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Assign a colour for each label, using category20 palette.
The method loops over the colour palette in case there are too many labels.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>labels</code></td>
          <td class="doc-param-details">
            <p>List of labels to colorise in displacy.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Dict[str, str]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>A displacy-compatible colour assignment.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/colors.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_colors</span><span class="p">(</span><span class="n">labels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assign a colour for each label, using category20 palette.</span>
<span class="sd">    The method loops over the colour palette in case there are too many labels.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labels : List[str]</span>
<span class="sd">        List of labels to colorise in displacy.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Dict[str, str]</span>
<span class="sd">        A displacy-compatible colour assignment.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="n">label</span><span class="p">:</span> <span class="n">cat</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">cat</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">cycle</span><span class="p">(</span><span class="n">CATEGORY20</span><span class="p">))}</span>

    <span class="k">return</span> <span class="n">colors</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.utils.filter" class="doc doc-heading">
        <code>filter</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.filter.default_sort_key" class="doc doc-heading">
<code class="highlight language-python"><span class="n">default_sort_key</span><span class="p">(</span><span class="n">span</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Returns the sort key for filtering spans.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>span</code></td>
          <td class="doc-param-details">
            <p>Span to sort.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Span</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>key</code>
          </td>
          <td class="doc-returns-details">
            <p>Sort key.</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>Tuple(int, int)</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/filter.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">default_sort_key</span><span class="p">(</span><span class="n">span</span><span class="p">:</span> <span class="n">Span</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the sort key for filtering spans.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    span : Span</span>
<span class="sd">        Span to sort.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    key : Tuple(int, int)</span>
<span class="sd">        Sort key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">span</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">span</span> <span class="o">=</span> <span class="n">span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="o">-</span><span class="n">span</span><span class="o">.</span><span class="n">start</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.filter.start_sort_key" class="doc doc-heading">
<code class="highlight language-python"><span class="n">start_sort_key</span><span class="p">(</span><span class="n">span</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Returns the sort key for filtering spans by start order.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>span</code></td>
          <td class="doc-param-details">
            <p>Span to sort.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Span</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>key</code>
          </td>
          <td class="doc-returns-details">
            <p>Sort key.</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>Tuple(int, int)</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/filter.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">start_sort_key</span><span class="p">(</span><span class="n">span</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the sort key for filtering spans by start order.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    span : Span</span>
<span class="sd">        Span to sort.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    key : Tuple(int, int)</span>
<span class="sd">        Sort key.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">span</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">span</span> <span class="o">=</span> <span class="n">span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.filter.filter_spans" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_spans</span><span class="p">(</span><span class="n">spans</span><span class="p">,</span> <span class="n">label_to_remove</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_discarded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sort_key</span><span class="o">=</span><span class="n">default_sort_key</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Re-definition of spacy's filtering function, that returns discarded spans
as well as filtered ones.</p>
<p>Can also accept a <code>label_to_remove</code> argument, useful for filtering out
pseudo cues. If set, <code>results</code> can contain overlapping spans: only
spans overlapping with excluded labels are removed. The main expected
use case is for pseudo-cues.</p>
<p>It can handle an iterable of tuples instead of an iterable of <code>Span</code>s.
The primary use-case is the use with the <code>RegexMatcher</code>'s capacity to
return the span's <code>groupdict</code>.</p>
<div class="admonition note">
<p>The <strong>spaCy documentation states</strong>:</p>
<blockquote>
<p>Filter a sequence of spans and remove duplicates or overlaps.
Useful for creating named entities (where one token can only
be part of one entity) or when merging spans with
<code>Retokenizer.merge</code>. When spans overlap, the (first)
longest span is preferred over shorter spans.</p>
</blockquote>
</div>
<div class="admonition danger">
<p class="admonition-title">Filtering out spans</p>
<p>If the <code>label_to_remove</code> argument is supplied, it might be tempting to
filter overlapping spans that are not part of a label to remove.</p>
<p>The reason we keep all other possibly overlapping labels is that in qualifier
pipelines, the same cue can precede <strong>and</strong> follow a marked entity.
Hence we need to keep every example.</p>
</div>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>spans</code></td>
          <td class="doc-param-details">
            <p>Spans to filter.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Iterable[Union[&#34;Span&#34;, Tuple[&#34;Span&#34;, Any]]]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>return_discarded</code></td>
          <td class="doc-param-details">
            <p>Whether to return discarded spans.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>label_to_remove</code></td>
          <td class="doc-param-details">
            <p>Label to remove. If set, results can contain overlapping spans.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>sort_key</code></td>
          <td class="doc-param-details">
            <p>Key to sorting spans before applying overlap conflict resolution.
A span with a higher key will have precedence over another span.
By default, the largest, leftmost spans are selected first.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Callable[Span, Any], optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>default_sort_key</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>results</code>
          </td>
          <td class="doc-returns-details">
            <p>Filtered spans</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>List[Union[Span, Tuple[Span, Any]]]</code>
                </span>
              </p>
          </td>
        </tr>
        <tr>
          <td>
              <code>discarded</code>
          </td>
          <td class="doc-returns-details">
            <p>Discarded spans</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>List[Union[Span, Tuple[Span, Any]]], optional</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/filter.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_spans</span><span class="p">(</span>
    <span class="n">spans</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="s2">&quot;Span&quot;</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span>
    <span class="n">label_to_remove</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">return_discarded</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sort_key</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Span</span><span class="p">],</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_sort_key</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span>
    <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span>
    <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]],</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Span</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]],</span>
<span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Re-definition of spacy&#39;s filtering function, that returns discarded spans</span>
<span class="sd">    as well as filtered ones.</span>

<span class="sd">    Can also accept a `label_to_remove` argument, useful for filtering out</span>
<span class="sd">    pseudo cues. If set, `results` can contain overlapping spans: only</span>
<span class="sd">    spans overlapping with excluded labels are removed. The main expected</span>
<span class="sd">    use case is for pseudo-cues.</span>

<span class="sd">    It can handle an iterable of tuples instead of an iterable of `Span`s.</span>
<span class="sd">    The primary use-case is the use with the `RegexMatcher`&#39;s capacity to</span>
<span class="sd">    return the span&#39;s `groupdict`.</span>

<span class="sd">    !!! note &quot;&quot;</span>

<span class="sd">        The **spaCy documentation states**:</span>

<span class="sd">        &gt; Filter a sequence of spans and remove duplicates or overlaps.</span>
<span class="sd">        &gt; Useful for creating named entities (where one token can only</span>
<span class="sd">        &gt; be part of one entity) or when merging spans with</span>
<span class="sd">        &gt; `Retokenizer.merge`. When spans overlap, the (first)</span>
<span class="sd">        &gt; longest span is preferred over shorter spans.</span>

<span class="sd">    !!! danger &quot;Filtering out spans&quot;</span>

<span class="sd">        If the `label_to_remove` argument is supplied, it might be tempting to</span>
<span class="sd">        filter overlapping spans that are not part of a label to remove.</span>

<span class="sd">        The reason we keep all other possibly overlapping labels is that in qualifier</span>
<span class="sd">        pipelines, the same cue can precede **and** follow a marked entity.</span>
<span class="sd">        Hence we need to keep every example.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    spans : Iterable[Union[&quot;Span&quot;, Tuple[&quot;Span&quot;, Any]]]</span>
<span class="sd">        Spans to filter.</span>
<span class="sd">    return_discarded : bool</span>
<span class="sd">        Whether to return discarded spans.</span>
<span class="sd">    label_to_remove : str, optional</span>
<span class="sd">        Label to remove. If set, results can contain overlapping spans.</span>
<span class="sd">    sort_key : Callable[Span, Any], optional</span>
<span class="sd">        Key to sorting spans before applying overlap conflict resolution.</span>
<span class="sd">        A span with a higher key will have precedence over another span.</span>
<span class="sd">        By default, the largest, leftmost spans are selected first.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    results : List[Union[Span, Tuple[Span, Any]]]</span>
<span class="sd">        Filtered spans</span>
<span class="sd">    discarded : List[Union[Span, Tuple[Span, Any]]], optional</span>
<span class="sd">        Discarded spans</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sorted_spans</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">spans</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">sort_key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">discarded</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">seen_tokens</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">sorted_spans</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">span</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">span</span><span class="p">,</span> <span class="n">Span</span><span class="p">)</span> <span class="k">else</span> <span class="n">span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Check for end - 1 here because boundaries are inclusive</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">start</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen_tokens</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">seen_tokens</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label_to_remove</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">label_</span> <span class="o">!=</span> <span class="n">label_to_remove</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">label_to_remove</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="n">label_to_remove</span><span class="p">:</span>
                <span class="n">seen_tokens</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">end</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">label_to_remove</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">label_</span> <span class="o">!=</span> <span class="n">label_to_remove</span><span class="p">:</span>
            <span class="n">discarded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">span</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">start_sort_key</span><span class="p">)</span>
    <span class="n">discarded</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">discarded</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">start_sort_key</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_discarded</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">discarded</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.filter.consume_spans" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume_spans</span><span class="p">(</span><span class="n">spans</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">second_chance</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Consume a list of span, according to a filter.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method makes the hard hypothesis that:</p>
<ol>
<li>Spans are sorted.</li>
<li>Spans are consumed in sequence and only once.</li>
</ol>
<p>The second item is problematic for the way we treat long entities,
hence the <code>second_chance</code> parameter, which lets entities be seen
more than once.</p>
</div>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>spans</code></td>
          <td class="doc-param-details">
            <p>List of spans to filter</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List of spans</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>filter</code></td>
          <td class="doc-param-details">
            <p>Filtering function. Should return True when the item is to be included.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Callable</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>second_chance</code></td>
          <td class="doc-param-details">
            <p>Optional list of spans to include again (useful for long entities),
by default None</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List of spans, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <code>matches</code>
          </td>
          <td class="doc-returns-details">
            <p>List of spans consumed by the filter.</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>List of spans</code>
                </span>
              </p>
          </td>
        </tr>
        <tr>
          <td>
              <code>remainder</code>
          </td>
          <td class="doc-returns-details">
            <p>List of remaining spans in the original <code>spans</code> parameter.</p>
              <p>
                <span class="doc-returns-annotation">
                  <b>TYPE:</b>
                    <code>List of spans</code>
                </span>
              </p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/filter.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">consume_spans</span><span class="p">(</span>
    <span class="n">spans</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">],</span>
    <span class="nb">filter</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">second_chance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Consume a list of span, according to a filter.</span>

<span class="sd">    !!! warning</span>
<span class="sd">        This method makes the hard hypothesis that:</span>

<span class="sd">        1. Spans are sorted.</span>
<span class="sd">        2. Spans are consumed in sequence and only once.</span>

<span class="sd">        The second item is problematic for the way we treat long entities,</span>
<span class="sd">        hence the `second_chance` parameter, which lets entities be seen</span>
<span class="sd">        more than once.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    spans : List of spans</span>
<span class="sd">        List of spans to filter</span>
<span class="sd">    filter : Callable</span>
<span class="sd">        Filtering function. Should return True when the item is to be included.</span>
<span class="sd">    second_chance : List of spans, optional</span>
<span class="sd">        Optional list of spans to include again (useful for long entities),</span>
<span class="sd">        by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    matches : List of spans</span>
<span class="sd">        List of spans consumed by the filter.</span>
<span class="sd">    remainder : List of spans</span>
<span class="sd">        List of remaining spans in the original `spans` parameter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">second_chance</span><span class="p">:</span>
        <span class="n">second_chance</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">second_chance</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">second_chance</span> <span class="k">if</span> <span class="nb">filter</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">spans</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">second_chance</span><span class="p">,</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">span</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">spans</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">filter</span><span class="p">(</span><span class="n">span</span><span class="p">):</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">matches</span> <span class="o">=</span> <span class="n">spans</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
    <span class="n">remainder</span> <span class="o">=</span> <span class="n">spans</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>

    <span class="n">matches</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">second_chance</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">matches</span><span class="p">,</span> <span class="n">remainder</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.filter.get_spans" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_spans</span><span class="p">(</span><span class="n">spans</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Extracts spans with a given label.
Prefer using hash label for performance reasons.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>spans</code></td>
          <td class="doc-param-details">
            <p>List of spans to filter.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[Span]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>label</code></td>
          <td class="doc-param-details">
            <p>Label to filter on.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Union[int, str]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>List[Span]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Filtered spans.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/filter.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_spans</span><span class="p">(</span><span class="n">spans</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">],</span> <span class="n">label</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts spans with a given label.</span>
<span class="sd">    Prefer using hash label for performance reasons.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    spans : List[Span]</span>
<span class="sd">        List of spans to filter.</span>
<span class="sd">    label : Union[int, str]</span>
<span class="sd">        Label to filter on.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    List[Span]</span>
<span class="sd">        Filtered spans.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">span</span> <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">spans</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">span</span> <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="n">spans</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">label_</span> <span class="o">==</span> <span class="n">label</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.utils.regex" class="doc doc-heading">
        <code>regex</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.regex.make_pattern" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_pattern</span><span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="n">with_breaks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Create OR pattern from a list of patterns.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>patterns</code></td>
          <td class="doc-param-details">
            <p>List of patterns to merge.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>with_breaks</code></td>
          <td class="doc-param-details">
            <p>Whether to add breaks (<code>\b</code>) on each side, by default False</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td class="doc-param-details">
            <p>Name of the group, using regex <code>?P&lt;&gt;</code> directive.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><span title="typing.Optional">Optional</span>[str]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>str</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Merged pattern.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_pattern</span><span class="p">(</span>
    <span class="n">patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">with_breaks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create OR pattern from a list of patterns.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    patterns : List[str]</span>
<span class="sd">        List of patterns to merge.</span>
<span class="sd">    with_breaks : bool, optional</span>
<span class="sd">        Whether to add breaks (`\b`) on each side, by default False</span>
<span class="sd">    name: str, optional</span>
<span class="sd">        Name of the group, using regex `?P&lt;&gt;` directive.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        Merged pattern.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(?P&lt;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&gt;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;(&quot;</span>

    <span class="c1"># Sorting by length might be more efficient</span>
    <span class="n">patterns</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">pattern</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">patterns</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

    <span class="k">if</span> <span class="n">with_breaks</span><span class="p">:</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\b&quot;</span> <span class="o">+</span> <span class="n">pattern</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;\b&quot;</span>

    <span class="k">return</span> <span class="n">pattern</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.regex.compile_regex" class="doc doc-heading">
<code class="highlight language-python"><span class="n">compile_regex</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>This function tries to compile <code>reg</code>  using the <code>re</code> module, and
fallbacks to the <code>regex</code> module that is more permissive.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>reg</code></td>
          <td class="doc-param-details">
            
            <p>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Union[re.Pattern, regex.Pattern]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/regex.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">compile_regex</span><span class="p">(</span><span class="n">reg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function tries to compile `reg`  using the `re` module, and</span>
<span class="sd">    fallbacks to the `regex` module that is more permissive.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    reg: str</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[re.Pattern, regex.Pattern]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">re</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">regex</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">regex</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not compile: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">reg</span><span class="p">)))</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.utils.inclusion" class="doc doc-heading">
        <code>inclusion</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.inclusion.check_inclusion" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_inclusion</span><span class="p">(</span><span class="n">span</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Checks whether the span overlaps the boundaries.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>span</code></td>
          <td class="doc-param-details">
            <p>Span to check.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Span</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>start</code></td>
          <td class="doc-param-details">
            <p>Start of the boundary</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>end</code></td>
          <td class="doc-param-details">
            <p>End of the boundary</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>int</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>bool</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>Whether the span overlaps the boundaries.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/inclusion.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_inclusion</span><span class="p">(</span><span class="n">span</span><span class="p">:</span> <span class="n">Span</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether the span overlaps the boundaries.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    span : Span</span>
<span class="sd">        Span to check.</span>
<span class="sd">    start : int</span>
<span class="sd">        Start of the boundary</span>
<span class="sd">    end : int</span>
<span class="sd">        End of the boundary</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        Whether the span overlaps the boundaries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="n">end</span> <span class="ow">or</span> <span class="n">span</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;=</span> <span class="n">start</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.utils.resources" class="doc doc-heading">
        <code>resources</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.resources.get_verbs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_verbs</span><span class="p">(</span><span class="n">verbs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_contains</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Extract verbs from the resources, as a pandas dataframe.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>verbs</code></td>
          <td class="doc-param-details">
            <p>List of verbs to keep. Returns all verbs by default.</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>List[str], optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>check_contains</code></td>
          <td class="doc-param-details">
            <p>Whether to check that no verb is missing if a list of verbs was provided.
By default True</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>bool, optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>pd.DataFrame</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <p>DataFrame containing conjugated verbs.</p>
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/resources.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_verbs</span><span class="p">(</span>
    <span class="n">verbs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">check_contains</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract verbs from the resources, as a pandas dataframe.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    verbs : List[str], optional</span>
<span class="sd">        List of verbs to keep. Returns all verbs by default.</span>
<span class="sd">    check_contains : bool, optional</span>
<span class="sd">        Whether to check that no verb is missing if a list of verbs was provided.</span>
<span class="sd">        By default True</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        DataFrame containing conjugated verbs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">conjugated_verbs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">BASE_DIR</span> <span class="o">/</span> <span class="s2">&quot;resources&quot;</span> <span class="o">/</span> <span class="s2">&quot;verbs.csv&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">verbs</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">conjugated_verbs</span>

    <span class="n">verbs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">verbs</span><span class="p">)</span>

    <span class="n">selected_verbs</span> <span class="o">=</span> <span class="n">conjugated_verbs</span><span class="p">[</span><span class="n">conjugated_verbs</span><span class="o">.</span><span class="n">verb</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">verbs</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">check_contains</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">verbs</span><span class="p">)</span> <span class="o">==</span> <span class="n">selected_verbs</span><span class="o">.</span><span class="n">verb</span><span class="o">.</span><span class="n">nunique</span><span class="p">(),</span> <span class="s2">&quot;Some verbs are missing !&quot;</span>

    <span class="k">return</span> <span class="n">selected_verbs</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="edsnlp.utils.deprecation" class="doc doc-heading">
        <code>deprecation</code>



</h4>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.deprecation.deprecated_extension" class="doc doc-heading">
<code class="highlight language-python"><span class="n">deprecated_extension</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/deprecation.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">deprecated_extension</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;The extension &quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; is deprecated and will be &#39;</span>
        <span class="s2">&quot;removed in a future version. &quot;</span>
        <span class="sa">f</span><span class="s1">&#39;Please use &quot;</span><span class="si">{</span><span class="n">new_name</span><span class="si">}</span><span class="s1">&quot; instead.&#39;</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.deprecation.deprecated_getter_factory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">deprecated_getter_factory</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/deprecation.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">deprecated_getter_factory</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">getter</span><span class="p">(</span><span class="n">toklike</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Token</span><span class="p">,</span> <span class="n">Span</span><span class="p">,</span> <span class="n">Doc</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>

        <span class="n">n</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">toklike</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">._.</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">nn</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">toklike</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">._.</span><span class="si">{</span><span class="n">new_name</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">deprecated_extension</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nn</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">toklike</span><span class="o">.</span><span class="n">_</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">getter</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.deprecation.deprecation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">deprecation</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/deprecation.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">deprecation</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

    <span class="n">new_name</span> <span class="o">=</span> <span class="n">new_name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;eds.</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;Calling &quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; directly is deprecated and &#39;</span>
        <span class="s2">&quot;will be removed in a future version. &quot;</span>
        <span class="sa">f</span><span class="s1">&#39;Please use &quot;</span><span class="si">{</span><span class="n">new_name</span><span class="si">}</span><span class="s1">&quot; instead.&#39;</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="edsnlp.utils.deprecation.deprecated_factory" class="doc doc-heading">
<code class="highlight language-python"><span class="n">deprecated_factory</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">new_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h5>


    <div class="doc doc-contents ">

      <p>Execute the Language.factory method on a modified factory function.
The modification adds a deprecation warning.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td class="doc-param-details">
            <p>The deprecated name for the pipeline</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>str</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>new_name</code></td>
          <td class="doc-param-details">
            <p>The new name for the pipeline, which should be used, by default None</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[str], optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>default_config</code></td>
          <td class="doc-param-details">
            <p>The configuration that should be passed to Language.factory, by default None</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Dict[str, Any]], optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>func</code></td>
          <td class="doc-param-details">
            <p>The function to decorate, by default None</p>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code>Optional[Callable], optional</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code>Callable</code>
              </span>
          </td>
          <td class="doc-returns-details">
            
          </td>
        </tr>
    </tbody>
  </table>

        <details class="quote">
          <summary>Source code in <code>edsnlp/utils/deprecation.py</code></summary>
          <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">deprecated_factory</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">new_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Execute the Language.factory method on a modified factory function.</span>
<span class="sd">    The modification adds a deprecation warning.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The deprecated name for the pipeline</span>
<span class="sd">    new_name : Optional[str], optional</span>
<span class="sd">        The new name for the pipeline, which should be used, by default None</span>
<span class="sd">    default_config : Optional[Dict[str, Any]], optional</span>
<span class="sd">        The configuration that should be passed to Language.factory, by default None</span>
<span class="sd">    func : Optional[Callable], optional</span>
<span class="sd">        The function to decorate, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Callable</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">default_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">default_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">wrapper</span> <span class="o">=</span> <span class="n">Language</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default_config</span><span class="o">=</span><span class="n">default_config</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">wrap</span><span class="p">(</span><span class="n">factory</span><span class="p">):</span>

        <span class="c1"># Define decorator</span>
        <span class="c1"># We use micheles&#39; decorator package to keep the same signature</span>
        <span class="c1"># See https://github.com/micheles/decorator/</span>
        <span class="nd">@decorator</span>
        <span class="k">def</span> <span class="nf">decorate</span><span class="p">(</span>
            <span class="n">f</span><span class="p">,</span>
            <span class="o">*</span><span class="n">args</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="n">deprecation</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">f</span><span class="p">(</span>
                <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">decorated</span> <span class="o">=</span> <span class="n">decorate</span><span class="p">(</span><span class="n">factory</span><span class="p">)</span>

        <span class="n">wrapper</span><span class="p">(</span><span class="n">decorated</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">factory</span>

    <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">wrap</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrap</span>
</code></pre></div>
</td></tr></table>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../utilities/matchers/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Matchers" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Matchers
            </div>
          </div>
        </a>
      
      
        
        <a href="components/" class="md-footer__link md-footer__link--next" aria-label="Next: components" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              components
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.instant", "navigation.indexes", "navigation.top", "content.code.annotate"], "search": "../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.748e2769.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
      
        <script src="../assets/termynal/termynal.js"></script>
      
    
  </body>
</html>